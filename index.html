<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Municipality Complaint Management System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --info: #17a2b8;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: var(--dark);
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: var(--primary);
            color: white;
            padding: 20px 0;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo i {
            font-size: 2.5rem;
            color: var(--secondary);
        }
        
        .logo h1 {
            font-size: 1.8rem;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 5px;
            transition: all 0.3s;
        }
        
        nav a:hover, nav a.active {
            background: var(--secondary);
            transform: translateY(-2px);
        }
        
        .user-actions {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn-secondary {
            background: var(--accent);
            color: white;
        }
        
        .btn-secondary:hover {
            background: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background: #27ae60;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn-warning {
            background: var(--warning);
            color: white;
        }
        
        .btn-warning:hover {
            background: #e67e22;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn-info {
            background: var(--info);
            color: white;
        }
        
        .btn-info:hover {
            background: #138496;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn-danger {
            background: var(--accent);
            color: white;
        }
        
        .btn-danger:hover {
            background: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            display: none;
            position: relative;
            overflow: hidden;
        }
        
        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-title {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light);
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .complaint-categories, .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .category-card, .service-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
            cursor: pointer;
            border-left: 4px solid var(--secondary);
            position: relative;
            overflow: hidden;
        }
        
        .category-card:hover, .service-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }
        
        .category-icon, .service-icon {
            font-size: 2.5rem;
            color: var(--secondary);
            margin-bottom: 15px;
            transition: all 0.3s;
        }
        
        .category-card:hover .category-icon, .service-card:hover .service-icon {
            transform: scale(1.2) rotate(5deg);
            color: var(--accent);
        }
        
        .service-details {
            margin-top: 15px;
            text-align: left;
            font-size: 0.9rem;
            color: #666;
            display: none;
        }
        
        .service-card.active .service-details {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        .service-features {
            list-style: none;
            margin-top: 10px;
        }
        
        .service-features li {
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }
        
        .service-features li:last-child {
            border-bottom: none;
        }
        
        .service-action {
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
        }
        
        .complaint-form {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        input, select, textarea {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
            outline: none;
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .complaint-list {
            display: grid;
            gap: 15px;
        }
        
        .complaint-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .complaint-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .complaint-info h3 {
            margin-bottom: 5px;
        }
        
        .complaint-meta {
            display: flex;
            gap: 15px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-in-progress {
            background: #cce7ff;
            color: #004085;
        }
        
        .status-resolved {
            background: #d4edda;
            color: #155724;
        }
        
        .admin-panel {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
        }
        
        .admin-sidebar {
            background: var(--primary);
            color: white;
            border-radius: 10px;
            padding: 20px;
        }
        
        .admin-sidebar ul {
            list-style: none;
        }
        
        .admin-sidebar li {
            margin-bottom: 10px;
        }
        
        .admin-sidebar a {
            color: white;
            text-decoration: none;
            display: block;
            padding: 10px;
            border-radius: 5px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .admin-sidebar a:hover, .admin-sidebar a.active {
            background: var(--secondary);
            transform: translateX(5px);
        }
        
        .admin-content {
            background: white;
            border-radius: 10px;
            padding: 20px;
        }
        
        .admin-tab {
            display: none;
        }
        
        .admin-tab.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .admin-stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            border-top: 4px solid var(--secondary);
            transition: all 0.3s;
        }
        
        .admin-stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }
        
        .admin-stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .admin-stat-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background: #f8f9fa;
            font-weight: 600;
        }
        
        tr {
            transition: all 0.3s;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        
        .action-btn {
            padding: 5px 10px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s;
        }
        
        .edit-btn {
            background: var(--warning);
            color: white;
        }
        
        .edit-btn:hover {
            background: #e67e22;
            transform: scale(1.05);
        }
        
        .delete-btn {
            background: var(--accent);
            color: white;
        }
        
        .delete-btn:hover {
            background: #c0392b;
            transform: scale(1.05);
        }
        
        .view-btn {
            background: var(--info);
            color: white;
        }
        
        .view-btn:hover {
            background: #138496;
            transform: scale(1.05);
        }
        
        .resolve-btn {
            background: var(--success);
            color: white;
        }
        
        .resolve-btn:hover {
            background: #27ae60;
            transform: scale(1.05);
        }
        
        .chatbot-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .chatbot-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--secondary);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .chatbot-toggle:hover {
            transform: scale(1.1) rotate(10deg);
            background: var(--accent);
        }
        
        .chatbot-window {
            position: absolute;
            bottom: 70px;
            right: 0;
            width: 400px;
            height: 500px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
            display: none;
            flex-direction: column;
            overflow: hidden;
            animation: slideUp 0.3s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .chatbot-header {
            background: var(--primary);
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chatbot-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .message {
            padding: 10px 15px;
            border-radius: 18px;
            max-width: 80%;
            line-height: 1.4;
            animation: messageAppear 0.3s ease;
        }
        
        @keyframes messageAppear {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .bot-message {
            background: #f1f1f1;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }
        
        .user-message {
            background: var(--secondary);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }
        
        .quick-replies {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .quick-reply {
            background: #e0e0e0;
            border: none;
            border-radius: 15px;
            padding: 5px 10px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .quick-reply:hover {
            background: #d0d0d0;
        }
        
        .chatbot-input {
            display: flex;
            padding: 10px;
            border-top: 1px solid #eee;
        }
        
        .chatbot-input input {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 10px 15px;
            margin-right: 10px;
        }
        
        .chatbot-input button {
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .chatbot-input button:hover {
            background: var(--accent);
            transform: rotate(15deg);
        }
        
        .canvas-container {
            width: 100%;
            height: 200px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
            position: relative;
        }
        
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            border-top: 4px solid var(--secondary);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .stat-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .floating-animation {
            position: absolute;
            width: 50px;
            height: 50px;
            background: rgba(52, 152, 219, 0.1);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
            100% { transform: translateY(0) rotate(360deg); }
        }
        
        .floating-animation:nth-child(2) {
            width: 30px;
            height: 30px;
            background: rgba(231, 76, 60, 0.1);
            animation-delay: 1s;
            top: 20%;
            left: 10%;
        }
        
        .floating-animation:nth-child(3) {
            width: 40px;
            height: 40px;
            background: rgba(46, 204, 113, 0.1);
            animation-delay: 2s;
            top: 60%;
            left: 80%;
        }
        
        .floating-animation:nth-child(4) {
            width: 25px;
            height: 25px;
            background: rgba(243, 156, 18, 0.1);
            animation-delay: 3s;
            top: 80%;
            left: 20%;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            color: #7f8c8d;
            border-top: 1px solid #eee;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 5px;
            color: white;
            z-index: 3000;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            animation: slideInRight 0.3s ease;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .notification-success {
            background: var(--success);
        }
        
        .notification-error {
            background: var(--accent);
        }
        
        .notification-info {
            background: var(--info);
        }
        
        .service-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .service-modal-content {
            background: white;
            border-radius: 10px;
            padding: 25px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            animation: modalAppear 0.3s ease;
        }
        
        @keyframes modalAppear {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .service-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #7f8c8d;
        }
        
        .service-form {
            display: grid;
            gap: 15px;
        }
        
        .admin-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            nav ul {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .chatbot-window {
                width: 300px;
                height: 400px;
            }
            
            .complaint-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .complaint-categories, .services-grid {
                grid-template-columns: 1fr;
            }
            
            .service-action {
                flex-direction: column;
                gap: 10px;
            }
            
            .user-actions {
                flex-direction: column;
                width: 100%;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .admin-panel {
                grid-template-columns: 1fr;
            }
            
            .admin-sidebar {
                order: 2;
            }
            
            .admin-content {
                order: 1;
            }
            
            table {
                display: block;
                overflow-x: auto;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            .section {
                padding: 15px;
            }
            
            .chatbot-window {
                width: 280px;
                right: 10px;
            }
            
            .complaint-meta {
                flex-direction: column;
                gap: 5px;
            }
            
            .stats-cards, .admin-stats {
                grid-template-columns: 1fr;
            }
            
            .admin-controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="floating-animation"></div>
            <div class="floating-animation"></div>
            <div class="floating-animation"></div>
            <div class="floating-animation"></div>
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-city"></i>
                    <h1>Municipality Services</h1>
                </div>
                <nav>
                    <ul>
                        <li><a href="#" class="nav-link active" data-section="home"><i class="fas fa-home"></i> Home</a></li>
                        <li><a href="#" class="nav-link" data-section="complaints"><i class="fas fa-exclamation-circle"></i> File Complaint</a></li>
                        <li><a href="#" class="nav-link" data-section="track-complaints"><i class="fas fa-search"></i> Track Complaints</a></li>
                        <li><a href="#" class="nav-link" data-section="services"><i class="fas fa-concierge-bell"></i> Services</a></li>
                        <li><a href="#" class="nav-link" data-section="admin"><i class="fas fa-user-shield"></i> Admin</a></li>
                    </ul>
                </nav>
                <div class="user-actions">
                    <button class="btn btn-primary" id="loginBtn"><i class="fas fa-sign-in-alt"></i> Login</button>
                </div>
            </div>
        </header>

        <!-- Home Section -->
        <section id="home" class="section active">
            <h2 class="section-title"><i class="fas fa-home"></i> Welcome to Municipality Services</h2>
            <div class="canvas-container" id="animation-container"></div>
            <div class="stats-cards">
                <div class="stat-card">
                    <i class="fas fa-exclamation-circle stat-icon"></i>
                    <div class="stat-number" id="total-complaints">0</div>
                    <div class="stat-label">Total Complaints</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-check-circle stat-icon"></i>
                    <div class="stat-number" id="resolved-complaints">0</div>
                    <div class="stat-label">Resolved Complaints</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-users stat-icon"></i>
                    <div class="stat-number" id="active-users">0</div>
                    <div class="stat-label">Active Users</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-clock stat-icon"></i>
                    <div class="stat-number" id="avg-resolution">0</div>
                    <div class="stat-label">Avg. Resolution (Days)</div>
                </div>
            </div>
            <div class="complaint-categories">
                <div class="category-card" data-category="garbage">
                    <i class="fas fa-trash-alt category-icon"></i>
                    <h3>Garbage Dumping</h3>
                    <p>Report issues with garbage collection and dumping</p>
                </div>
                <div class="category-card" data-category="electricity">
                    <i class="fas fa-bolt category-icon"></i>
                    <h3>Electricity Bills</h3>
                    <p>Complaints regarding electricity billing and supply</p>
                </div>
                <div class="category-card" data-category="road">
                    <i class="fas fa-road category-icon"></i>
                    <h3>Road Construction</h3>
                    <p>Report road damage and construction issues</p>
                </div>
                <div class="category-card" data-category="water">
                    <i class="fas fa-tint category-icon"></i>
                    <h3>Water Supply</h3>
                    <p>Issues with water supply and quality</p>
                </div>
                <div class="category-card" data-category="sanitation">
                    <i class="fas fa-pump-soap category-icon"></i>
                    <h3>Sanitation</h3>
                    <p>Public sanitation and cleanliness issues</p>
                </div>
                <div class="category-card" data-category="other">
                    <i class="fas fa-question-circle category-icon"></i>
                    <h3>Other Issues</h3>
                    <p>Other municipality related complaints</p>
                </div>
            </div>
        </section>

        <!-- File Complaint Section -->
        <section id="complaints" class="section">
            <h2 class="section-title"><i class="fas fa-exclamation-circle"></i> File a Complaint</h2>
            <form id="complaintForm" class="complaint-form">
                <div class="form-group">
                    <label for="category"><i class="fas fa-tag"></i> Complaint Category</label>
                    <select id="category" required>
                        <option value="">Select a category</option>
                        <option value="garbage">Garbage Dumping</option>
                        <option value="electricity">Electricity Bills</option>
                        <option value="road">Road Construction</option>
                        <option value="water">Water Supply</option>
                        <option value="sanitation">Sanitation</option>
                        <option value="other">Other Issues</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="title"><i class="fas fa-heading"></i> Complaint Title</label>
                    <input type="text" id="title" placeholder="Brief title of your complaint" required>
                </div>
                <div class="form-group">
                    <label for="description"><i class="fas fa-align-left"></i> Complaint Description</label>
                    <textarea id="description" placeholder="Please describe your issue in detail..." required></textarea>
                </div>
                <div class="form-group">
                    <label for="location"><i class="fas fa-map-marker-alt"></i> Location</label>
                    <input type="text" id="location" placeholder="Where is the issue located?" required>
                </div>
                <div class="form-group">
                    <label for="priority"><i class="fas fa-exclamation-triangle"></i> Priority</label>
                    <select id="priority" required>
                        <option value="low">Low</option>
                        <option value="medium" selected>Medium</option>
                        <option value="high">High</option>
                        <option value="urgent">Urgent</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary"><i class="fas fa-paper-plane"></i> Submit Complaint</button>
            </form>
        </section>

        <!-- Track Complaints Section -->
        <section id="track-complaints" class="section">
            <h2 class="section-title"><i class="fas fa-search"></i> Track Your Complaints</h2>
            <div class="complaint-list" id="complaintList">
                <!-- Complaint items will be dynamically added here -->
            </div>
        </section>

        <!-- Services Section -->
        <section id="services" class="section">
            <h2 class="section-title"><i class="fas fa-concierge-bell"></i> Municipality Services</h2>
            <div class="services-grid">
                <div class="service-card" data-service="birth-certificate">
                    <i class="fas fa-id-card service-icon"></i>
                    <h3>Birth Certificate</h3>
                    <p>Apply for birth certificate registration and copies</p>
                    <div class="service-details">
                        <p>Required documents:</p>
                        <ul class="service-features">
                            <li>Hospital birth record</li>
                            <li>Parent's ID proof</li>
                            <li>Address proof</li>
                            <li>Application form</li>
                        </ul>
                        <p>Processing time: 3-5 business days</p>
                        <div class="service-action">
                            <button class="btn btn-info btn-apply" data-service="Birth Certificate">Apply Now</button>
                            <button class="btn btn-primary btn-info" data-service="Birth Certificate">More Info</button>
                        </div>
                    </div>
                </div>
                <div class="service-card" data-service="death-certificate">
                    <i class="fas fa-file-medical service-icon"></i>
                    <h3>Death Certificate</h3>
                    <p>Register death and obtain death certificate</p>
                    <div class="service-details">
                        <p>Required documents:</p>
                        <ul class="service-features">
                            <li>Medical certificate of cause of death</li>
                            <li>Deceased's ID proof</li>
                            <li>Applicant's ID proof</li>
                            <li>Death registration form</li>
                        </ul>
                        <p>Processing time: 2-4 business days</p>
                        <div class="service-action">
                            <button class="btn btn-info btn-apply" data-service="Death Certificate">Apply Now</button>
                            <button class="btn btn-primary btn-info" data-service="Death Certificate">More Info</button>
                        </div>
                    </div>
                </div>
                <div class="service-card" data-service="property-tax">
                    <i class="fas fa-home service-icon"></i>
                    <h3>Property Tax</h3>
                    <p>Pay property tax online or offline</p>
                    <div class="service-details">
                        <p>Payment methods:</p>
                        <ul class="service-features">
                            <li>Online payment (Credit/Debit/Net Banking)</li>
                            <li>Municipality office counter</li>
                            <li>Authorized bank branches</li>
                            <li>Mobile payment apps</li>
                        </ul>
                        <p>Due date: 31st March each year</p>
                        <div class="service-action">
                            <button class="btn btn-info btn-apply" data-service="Property Tax">Pay Now</button>
                            <button class="btn btn-primary btn-info" data-service="Property Tax">More Info</button>
                        </div>
                    </div>
                </div>
                <div class="service-card" data-service="vehicle-registration">
                    <i class="fas fa-car service-icon"></i>
                    <h3>Vehicle Registration</h3>
                    <p>New vehicle registration and transfers</p>
                    <div class="service-details">
                        <p>Required documents:</p>
                        <ul class="service-features">
                            <li>Address proof</li>
                            <li>ID proof</li>
                            <li>Vehicle invoice</li>
                            <li>Insurance certificate</li>
                            <li>Pollution under control certificate</li>
                        </ul>
                        <p>Processing time: 1-2 business days</p>
                        <div class="service-action">
                            <button class="btn btn-info btn-apply" data-service="Vehicle Registration">Apply Now</button>
                            <button class="btn btn-primary btn-info" data-service="Vehicle Registration">More Info</button>
                        </div>
                    </div>
                </div>
                <div class="service-card" data-service="building-permit">
                    <i class="fas fa-hard-hat service-icon"></i>
                    <h3>Building Permit</h3>
                    <p>Apply for construction and renovation permits</p>
                    <div class="service-details">
                        <p>Required documents:</p>
                        <ul class="service-features">
                            <li>Land ownership documents</li>
                            <li>Building plans</li>
                            <li>Structural stability certificate</li>
                            <li>NOC from fire department</li>
                            <li>Application form</li>
                        </ul>
                        <p>Processing time: 15-30 business days</p>
                        <div class="service-action">
                            <button class="btn btn-info btn-apply" data-service="Building Permit">Apply Now</button>
                            <button class="btn btn-primary btn-info" data-service="Building Permit">More Info</button>
                        </div>
                    </div>
                </div>
                <div class="service-card" data-service="trade-license">
                    <i class="fas fa-store service-icon"></i>
                    <h3>Trade License</h3>
                    <p>Obtain license for business operations</p>
                    <div class="service-details">
                        <p>Required documents:</p>
                        <ul class="service-features">
                            <li>Address proof of business</li>
                            <li>ID proof of applicant</li>
                            <li>Property tax receipt</li>
                            <li>NOC from landlord (if rented)</li>
                            <li>Business incorporation documents</li>
                        </ul>
                        <p>Processing time: 7-10 business days</p>
                        <div class="service-action">
                            <button class="btn btn-info btn-apply" data-service="Trade License">Apply Now</button>
                            <button class="btn btn-primary btn-info" data-service="Trade License">More Info</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Admin Panel Section -->
        <section id="admin" class="section">
            <h2 class="section-title"><i class="fas fa-user-shield"></i> Admin Control Panel</h2>
            <div class="admin-panel">
                <div class="admin-sidebar">
                    <ul>
                        <li><a href="#" class="admin-nav active" data-tab="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                        <li><a href="#" class="admin-nav" data-tab="complaints"><i class="fas fa-list-alt"></i> Manage Complaints</a></li>
                        <li><a href="#" class="admin-nav" data-tab="users"><i class="fas fa-users"></i> User Management</a></li>
                        <li><a href="#" class="admin-nav" data-tab="services"><i class="fas fa-concierge-bell"></i> Service Management</a></li>
                        <li><a href="#" class="admin-nav" data-tab="reports"><i class="fas fa-chart-bar"></i> Reports & Analytics</a></li>
                        <li><a href="#" class="admin-nav" data-tab="settings"><i class="fas fa-cogs"></i> System Settings</a></li>
                    </ul>
                </div>
                <div class="admin-content">
                    <!-- Admin Dashboard -->
                    <div id="admin-dashboard" class="admin-tab active">
                        <h3>Admin Dashboard</h3>
                        <div class="admin-stats">
                            <div class="admin-stat-card">
                                <i class="fas fa-exclamation-circle"></i>
                                <div class="admin-stat-number" id="admin-total-complaints">0</div>
                                <div class="admin-stat-label">Total Complaints</div>
                            </div>
                            <div class="admin-stat-card">
                                <i class="fas fa-check-circle"></i>
                                <div class="admin-stat-number" id="admin-resolved-complaints">0</div>
                                <div class="admin-stat-label">Resolved Complaints</div>
                            </div>
                            <div class="admin-stat-card">
                                <i class="fas fa-clock"></i>
                                <div class="admin-stat-number" id="admin-pending-complaints">0</div>
                                <div class="admin-stat-label">Pending Complaints</div>
                            </div>
                            <div class="admin-stat-card">
                                <i class="fas fa-users"></i>
                                <div class="admin-stat-number" id="admin-total-users">0</div>
                                <div class="admin-stat-label">Registered Users</div>
                            </div>
                            <div class="admin-stat-card">
                                <i class="fas fa-concierge-bell"></i>
                                <div class="admin-stat-number" id="admin-total-services">0</div>
                                <div class="admin-stat-label">Service Applications</div>
                            </div>
                            <div class="admin-stat-card">
                                <i class="fas fa-chart-line"></i>
                                <div class="admin-stat-number" id="admin-resolution-rate">0%</div>
                                <div class="admin-stat-label">Resolution Rate</div>
                            </div>
                        </div>
                        <div class="canvas-container" id="admin-chart-container"></div>
                    </div>

                    <!-- Manage Complaints -->
                    <div id="admin-complaints" class="admin-tab">
                        <h3>Manage Complaints</h3>
                        <div class="admin-controls">
                            <button class="btn btn-primary" id="refreshComplaints"><i class="fas fa-sync-alt"></i> Refresh</button>
                            <button class="btn btn-success" id="exportComplaints"><i class="fas fa-file-export"></i> Export</button>
                            <button class="btn btn-info" id="filterComplaints"><i class="fas fa-filter"></i> Filter</button>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Complaint ID</th>
                                    <th>User</th>
                                    <th>Category</th>
                                    <th>Title</th>
                                    <th>Date</th>
                                    <th>Priority</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminComplaintsTable">
                                <!-- Complaints will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- User Management -->
                    <div id="admin-users" class="admin-tab">
                        <h3>User Management</h3>
                        <div class="admin-controls">
                            <button class="btn btn-primary" id="refreshUsers"><i class="fas fa-sync-alt"></i> Refresh</button>
                            <button class="btn btn-success" id="addUser"><i class="fas fa-user-plus"></i> Add User</button>
                            <button class="btn btn-info" id="exportUsers"><i class="fas fa-file-export"></i> Export</button>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>User ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Role</th>
                                    <th>Status</th>
                                    <th>Complaints</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminUsersTable">
                                <!-- Users will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Service Management -->
                    <div id="admin-services" class="admin-tab">
                        <h3>Service Management</h3>
                        <div class="admin-controls">
                            <button class="btn btn-primary" id="refreshServices"><i class="fas fa-sync-alt"></i> Refresh</button>
                            <button class="btn btn-success" id="addService"><i class="fas fa-plus"></i> Add Service</button>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Application ID</th>
                                    <th>Service</th>
                                    <th>Applicant</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminServicesTable">
                                <!-- Service applications will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Reports & Analytics -->
                    <div id="admin-reports" class="admin-tab">
                        <h3>Reports & Analytics</h3>
                        <div class="admin-controls">
                            <button class="btn btn-primary" id="generateReport"><i class="fas fa-chart-pie"></i> Generate Report</button>
                            <button class="btn btn-success" id="downloadReport"><i class="fas fa-download"></i> Download Report</button>
                        </div>
                        <div class="canvas-container" id="reports-chart-container"></div>
                        <div class="admin-stats" style="margin-top: 20px;">
                            <div class="admin-stat-card">
                                <i class="fas fa-chart-bar"></i>
                                <div class="admin-stat-number" id="report-complaints-by-category">0</div>
                                <div class="admin-stat-label">Categories</div>
                            </div>
                            <div class="admin-stat-card">
                                <i class="fas fa-calendar"></i>
                                <div class="admin-stat-number" id="report-this-month">0</div>
                                <div class="admin-stat-label">This Month</div>
                            </div>
                            <div class="admin-stat-card">
                                <i class="fas fa-tachometer-alt"></i>
                                <div class="admin-stat-number" id="report-avg-resolution">0</div>
                                <div class="admin-stat-label">Avg. Resolution Days</div>
                            </div>
                        </div>
                    </div>

                    <!-- System Settings -->
                    <div id="admin-settings" class="admin-tab">
                        <h3>System Settings</h3>
                        <form id="adminSettingsForm" class="complaint-form">
                            <div class="form-group">
                                <label for="systemName"><i class="fas fa-cog"></i> System Name</label>
                                <input type="text" id="systemName" value="Municipality Services" required>
                            </div>
                            <div class="form-group">
                                <label for="adminEmail"><i class="fas fa-envelope"></i> Admin Email</label>
                                <input type="email" id="adminEmail" value="admin@municipality.gov" required>
                            </div>
                            <div class="form-group">
                                <label for="helpline"><i class="fas fa-phone"></i> Helpline Number</label>
                                <input type="text" id="helpline" value="1800-123-4567" required>
                            </div>
                            <div class="form-group">
                                <label for="autoResponse"><i class="fas fa-robot"></i> Auto-Response Message</label>
                                <textarea id="autoResponse" required>Thank you for contacting Municipality Services. We have received your complaint and will address it shortly.</textarea>
                            </div>
                            <div class="form-group">
                                <label for="complaintTimeout"><i class="fas fa-clock"></i> Complaint Resolution Time (Days)</label>
                                <input type="number" id="complaintTimeout" value="7" min="1" max="30" required>
                            </div>
                            <button type="submit" class="btn btn-primary" id="saveSettings"><i class="fas fa-save"></i> Save Settings</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- Service Application Modal -->
        <div class="service-modal" id="serviceModal">
            <div class="service-modal-content">
                <div class="service-modal-header">
                    <h3 id="modalServiceTitle">Apply for Service</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <form id="serviceApplicationForm" class="service-form">
                    <div class="form-group">
                        <label for="applicantName">Full Name</label>
                        <input type="text" id="applicantName" required>
                    </div>
                    <div class="form-group">
                        <label for="applicantEmail">Email</label>
                        <input type="email" id="applicantEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="applicantPhone">Phone Number</label>
                        <input type="tel" id="applicantPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="applicantAddress">Address</label>
                        <textarea id="applicantAddress" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="serviceDetails">Additional Details</label>
                        <textarea id="serviceDetails" placeholder="Any additional information..."></textarea>
                    </div>
                    <button type="submit" class="btn btn-success">Submit Application</button>
                </form>
            </div>
        </div>

        <!-- Chatbot -->
        <div class="chatbot-container">
            <div class="chatbot-toggle" id="chatbotToggle">
                <i class="fas fa-comments"></i>
            </div>
            <div class="chatbot-window" id="chatbotWindow">
                <div class="chatbot-header">
                    <h3>Municipality Assistant</h3>
                    <button id="closeChatbot"><i class="fas fa-times"></i></button>
                </div>
                <div class="chatbot-messages" id="chatbotMessages">
                    <div class="message bot-message">
                        Hello! I'm your municipality assistant. How can I help you today?
                        <div class="quick-replies">
                            <button class="quick-reply" data-query="file complaint">File Complaint</button>
                            <button class="quick-reply" data-query="track complaint">Track Complaint</button>
                            <button class="quick-reply" data-query="services">Services Info</button>
                            <button class="quick-reply" data-query="contact">Contact Info</button>
                        </div>
                    </div>
                </div>
                <div class="chatbot-input">
                    <input type="text" id="chatbotInput" placeholder="Type your message...">
                    <button id="sendMessage"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>

        <footer>
            <p>&copy; 2023 Municipality Services. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Sample data for the application
        let complaints = JSON.parse(localStorage.getItem('complaints')) || [];
        let users = JSON.parse(localStorage.getItem('users')) || [
            { id: 1, name: "John Doe", email: "john@example.com", phone: "1234567890", password: "password123", status: "active", complaints: 2, role: "user" },
            { id: 2, name: "Admin User", email: "admin@municipality.gov", phone: "1122334455", password: "admin123", status: "active", complaints: 0, role: "admin" }
        ];
        let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
        let complaintIdCounter = parseInt(localStorage.getItem('complaintIdCounter')) || 1001;
        let serviceApplications = JSON.parse(localStorage.getItem('serviceApplications')) || [];
        let settings = JSON.parse(localStorage.getItem('settings')) || {
            systemName: "Municipality Services",
            adminEmail: "admin@municipality.gov",
            helpline: "1800-123-4567",
            autoResponse: "Thank you for contacting Municipality Services. We have received your complaint and will address it shortly.",
            complaintTimeout: 7
        };

        // Enhanced chatbot knowledge base
        const chatbotKnowledge = {
            "greeting": [
                "Hello! How can I assist you with municipality services today?",
                "Hi there! I'm here to help with any municipality-related queries.",
                "Welcome! How can I help you with our municipality services?"
            ],
            "file complaint": [
                "To file a complaint, go to the 'File Complaint' section. Select a category like Garbage, Electricity, Road, Water, Sanitation, or Other. Fill in the details including title, description, location, and priority level.",
                "You can file complaints by navigating to the File Complaint tab. Choose the appropriate category for your issue and provide as much detail as possible.",
                "For filing complaints: 1) Click on 'File Complaint' in the menu 2) Select complaint category 3) Fill in all required details 4) Submit the form. You'll receive a complaint ID for tracking."
            ],
            "track complaint": [
                "To track your complaints, go to the 'Track Complaints' section. You'll see all your submitted complaints with their current status (Pending, In Progress, or Resolved).",
                "Check your complaint status in the Track Complaints section. Each complaint shows its ID, category, submission date, and current status.",
                "You can monitor your complaint progress in the Track Complaints tab. If you need updates on a specific complaint, provide the complaint ID and I can check its status."
            ],
            "services": [
                "Our municipality services include: Birth/Death Certificates, Property Tax payments, Vehicle Registration, Building Permits, Trade Licenses, and various public utilities.",
                "You can access multiple services through our portal: Certificate applications, tax payments, permit requests, and license applications are all available online.",
                "Service hours: Monday-Friday 9AM-5PM, Saturday 9AM-1PM. Online services available 24/7. Visit the Services section for detailed information on each service."
            ],
            "contact": [
                "Main Helpline: 1800-123-4567 (24/7)<br>Emergency: 911<br>Email: contact@municipality.gov<br>Office Hours: Mon-Fri 9AM-5PM",
                "Department Contacts:<br>Sanitation: Ext. 101<br>Electricity: Ext. 102<br>Water: Ext. 103<br>Roads: Ext. 104<br>General Inquiries: Ext. 100",
                "Visit our office at: 123 Civic Center, Main City. You can also reach us through our website or mobile app for faster service."
            ],
            "default": [
                "I'm here to help with municipality services. You can ask me about filing complaints, tracking status, service information, or contact details.",
                "I specialize in municipality services. How can I assist you with complaints, services, or general information?",
                "I can help you with complaint filing, status tracking, service information, or contact details. What do you need help with?"
            ]
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize 3D animation
            init3DAnimation();
            initAdminChart();
            initReportsChart();
            
            // Navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    const sectionId = this.getAttribute('data-section');
                    document.getElementById(sectionId).classList.add('active');
                    
                    // Update admin stats when admin section is opened
                    if (sectionId === 'admin') {
                        updateAdminStats();
                        updateAdminComplaintsTable();
                        updateAdminUsersTable();
                        updateAdminServicesTable();
                    }
                });
            });

            // Admin navigation
            document.querySelectorAll('.admin-nav').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('.admin-nav').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.admin-tab').forEach(tab => {
                        tab.classList.remove('active');
                    });
                    
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(`admin-${tabId}`).classList.add('active');
                });
            });

            // Category cards
            document.querySelectorAll('.category-card').forEach(card => {
                card.addEventListener('click', function() {
                    const category = this.getAttribute('data-category');
                    if (category) {
                        // Switch to complaints section and set category
                        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                        document.querySelector('[data-section="complaints"]').classList.add('active');
                        
                        document.querySelectorAll('.section').forEach(section => {
                            section.classList.remove('active');
                        });
                        document.getElementById('complaints').classList.add('active');
                        
                        document.getElementById('category').value = category;
                    }
                });
            });

            // Service cards functionality
            document.querySelectorAll('.service-card').forEach(card => {
                card.addEventListener('click', function(e) {
                    // Toggle service details
                    if (!e.target.classList.contains('btn-apply') && !e.target.classList.contains('btn-info')) {
                        this.classList.toggle('active');
                    }
                });
            });

            // Service application buttons
            document.querySelectorAll('.btn-apply').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const service = this.getAttribute('data-service');
                    openServiceModal(service);
                });
            });

            // Service info buttons
            document.querySelectorAll('.btn-info').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const service = this.getAttribute('data-service');
                    showNotification(`More information about ${service} is available in the service details.`, 'info');
                });
            });

            // Service modal functionality
            document.querySelector('.close-modal').addEventListener('click', function() {
                document.getElementById('serviceModal').style.display = 'none';
            });

            // Service application form
            document.getElementById('serviceApplicationForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                if (!currentUser) {
                    showNotification('Please login to apply for services.', 'error');
                    return;
                }
                
                const service = document.getElementById('modalServiceTitle').textContent.replace('Apply for ', '');
                const application = {
                    id: serviceApplications.length + 1,
                    service: service,
                    applicantName: document.getElementById('applicantName').value,
                    applicantEmail: document.getElementById('applicantEmail').value,
                    applicantPhone: document.getElementById('applicantPhone').value,
                    applicantAddress: document.getElementById('applicantAddress').value,
                    additionalDetails: document.getElementById('serviceDetails').value,
                    date: new Date().toISOString().split('T')[0],
                    status: 'submitted',
                    userId: currentUser.id
                };
                
                serviceApplications.push(application);
                localStorage.setItem('serviceApplications', JSON.stringify(serviceApplications));
                
                document.getElementById('serviceModal').style.display = 'none';
                showNotification(`Application for ${service} submitted successfully!`, 'success');
                this.reset();
                
                // Update admin stats
                updateAdminStats();
                updateAdminServicesTable();
            });

            // Complaint form submission
            document.getElementById('complaintForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                if (!currentUser) {
                    showNotification('Please login to submit a complaint.', 'error');
                    return;
                }
                
                const complaint = {
                    id: complaintIdCounter++,
                    userId: currentUser.id,
                    category: document.getElementById('category').value,
                    title: document.getElementById('title').value,
                    description: document.getElementById('description').value,
                    location: document.getElementById('location').value,
                    priority: document.getElementById('priority').value,
                    status: 'pending',
                    date: new Date().toISOString().split('T')[0],
                    userName: currentUser.name,
                    userEmail: currentUser.email,
                    userPhone: currentUser.phone
                };
                
                complaints.push(complaint);
                saveData();
                
                // Update user complaint count
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex].complaints = (users[userIndex].complaints || 0) + 1;
                }
                
                showNotification(`Complaint submitted successfully! Your complaint ID is: ${complaint.id}`, 'success');
                this.reset();
                
                // Update complaint lists
                updateComplaintList();
                updateStats();
                updateAdminStats();
                updateAdminComplaintsTable();
            });

            // Admin functionality
            document.getElementById('refreshComplaints').addEventListener('click', function() {
                updateAdminComplaintsTable();
                showNotification('Complaints list refreshed.', 'info');
            });

            document.getElementById('exportComplaints').addEventListener('click', function() {
                showNotification('Complaints data exported successfully.', 'success');
            });

            document.getElementById('filterComplaints').addEventListener('click', function() {
                showNotification('Filter options will be displayed here.', 'info');
            });

            document.getElementById('refreshUsers').addEventListener('click', function() {
                updateAdminUsersTable();
                showNotification('Users list refreshed.', 'info');
            });

            document.getElementById('addUser').addEventListener('click', function() {
                const name = prompt('Enter user full name:');
                const email = prompt('Enter user email:');
                const phone = prompt('Enter user phone:');
                const role = prompt('Enter user role (user/admin):', 'user');
                
                if (name && email && phone && role) {
                    const newUser = {
                        id: users.length + 1,
                        name: name,
                        email: email,
                        phone: phone,
                        password: 'default123',
                        status: 'active',
                        complaints: 0,
                        role: role
                    };
                    
                    users.push(newUser);
                    saveData();
                    updateAdminUsersTable();
                    updateAdminStats();
                    showNotification(`User ${name} added successfully.`, 'success');
                }
            });

            document.getElementById('exportUsers').addEventListener('click', function() {
                showNotification('Users data exported successfully.', 'success');
            });

            document.getElementById('refreshServices').addEventListener('click', function() {
                updateAdminServicesTable();
                showNotification('Services list refreshed.', 'info');
            });

            document.getElementById('addService').addEventListener('click', function() {
                showNotification('Add new service functionality will be implemented here.', 'info');
            });

            document.getElementById('generateReport').addEventListener('click', function() {
                showNotification('Report generated successfully.', 'success');
            });

            document.getElementById('downloadReport').addEventListener('click', function() {
                showNotification('Report downloaded successfully.', 'success');
            });

            // Admin settings form
            document.getElementById('adminSettingsForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                settings.systemName = document.getElementById('systemName').value;
                settings.adminEmail = document.getElementById('adminEmail').value;
                settings.helpline = document.getElementById('helpline').value;
                settings.autoResponse = document.getElementById('autoResponse').value;
                settings.complaintTimeout = document.getElementById('complaintTimeout').value;
                
                localStorage.setItem('settings', JSON.stringify(settings));
                showNotification('Settings saved successfully.', 'success');
            });

            // Load settings
            document.getElementById('systemName').value = settings.systemName;
            document.getElementById('adminEmail').value = settings.adminEmail;
            document.getElementById('helpline').value = settings.helpline;
            document.getElementById('autoResponse').value = settings.autoResponse;
            document.getElementById('complaintTimeout').value = settings.complaintTimeout;

            // Chatbot functionality
            document.getElementById('chatbotToggle').addEventListener('click', function() {
                document.getElementById('chatbotWindow').style.display = 'flex';
            });

            document.getElementById('closeChatbot').addEventListener('click', function() {
                document.getElementById('chatbotWindow').style.display = 'none';
            });

            document.getElementById('sendMessage').addEventListener('click', sendMessage);
            document.getElementById('chatbotInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            // Quick reply buttons
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('quick-reply')) {
                    const query = e.target.getAttribute('data-query');
                    document.getElementById('chatbotInput').value = query;
                    sendMessage();
                }
            });

            function sendMessage() {
                const input = document.getElementById('chatbotInput');
                const message = input.value.trim();
                
                if (message) {
                    // Add user message
                    addMessage(message, 'user');
                    input.value = '';
                    
                    // Generate bot response
                    setTimeout(() => {
                        const response = generateBotResponse(message);
                        addMessage(response, 'bot');
                    }, 500);
                }
            }

            function addMessage(text, sender) {
                const messagesContainer = document.getElementById('chatbotMessages');
                const messageElement = document.createElement('div');
                messageElement.classList.add('message', `${sender}-message`);
                
                if (sender === 'bot' && text.includes('<br>')) {
                    // For bot messages with line breaks
                    messageElement.innerHTML = text;
                    
                    // Add quick replies for certain responses
                    if (text.includes('How can I assist you') || text.includes('What do you need help with')) {
                        const quickReplies = document.createElement('div');
                        quickReplies.className = 'quick-replies';
                        quickReplies.innerHTML = `
                            <button class="quick-reply" data-query="file complaint">File Complaint</button>
                            <button class="quick-reply" data-query="track complaint">Track Complaint</button>
                            <button class="quick-reply" data-query="services">Services Info</button>
                            <button class="quick-reply" data-query="contact">Contact Info</button>
                        `;
                        messageElement.appendChild(quickReplies);
                    }
                } else {
                    messageElement.textContent = text;
                }
                
                messagesContainer.appendChild(messageElement);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }

            function generateBotResponse(message) {
                const lowerMessage = message.toLowerCase();
                
                // Check for specific categories and keywords
                if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
                    return getRandomResponse('greeting');
                } else if (lowerMessage.includes('file') && lowerMessage.includes('complaint')) {
                    return getRandomResponse('file complaint');
                } else if (lowerMessage.includes('track') && lowerMessage.includes('complaint')) {
                    return getRandomResponse('track complaint');
                } else if (lowerMessage.includes('service')) {
                    return getRandomResponse('services');
                } else if (lowerMessage.includes('contact') || lowerMessage.includes('number') || lowerMessage.includes('phone') || lowerMessage.includes('email')) {
                    return getRandomResponse('contact');
                } else {
                    return getRandomResponse('default');
                }
            }

            function getRandomResponse(category) {
                const responses = chatbotKnowledge[category];
                return responses[Math.floor(Math.random() * responses.length)];
            }

            function openServiceModal(service) {
                document.getElementById('modalServiceTitle').textContent = `Apply for ${service}`;
                document.getElementById('serviceModal').style.display = 'flex';
                
                // Pre-fill form if user is logged in
                if (currentUser) {
                    document.getElementById('applicantName').value = currentUser.name;
                    document.getElementById('applicantEmail').value = currentUser.email;
                    document.getElementById('applicantPhone').value = currentUser.phone;
                }
            }

            // Login functionality
            document.getElementById('loginBtn').addEventListener('click', function() {
                if (currentUser) {
                    // Logout
                    currentUser = null;
                    localStorage.removeItem('currentUser');
                    this.innerHTML = '<i class="fas fa-sign-in-alt"></i> Login';
                    updateComplaintList();
                    showNotification('You have been logged out.', 'info');
                } else {
                    // Simple login for demo - in real app, this would be more secure
                    const email = prompt('Enter your email:');
                    if (email) {
                        let user = users.find(u => u.email === email);
                        if (user) {
                            const password = prompt('Enter your password:');
                            if (password === user.password) {
                                currentUser = user;
                                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                                this.innerHTML = '<i class="fas fa-sign-out-alt"></i> Logout';
                                showNotification(`Welcome back, ${user.name}!`, 'success');
                                updateComplaintList();
                                updateUIForUser();
                            } else {
                                showNotification('Invalid password.', 'error');
                            }
                        } else {
                            // Auto-register if user doesn't exist
                            const name = prompt('New user detected. Enter your full name:');
                            const phone = prompt('Enter your phone number:');
                            const password = prompt('Create a password:');
                            
                            if (name && phone && password) {
                                const newUser = {
                                    id: users.length + 1,
                                    name: name,
                                    email: email,
                                    phone: phone,
                                    password: password,
                                    status: 'active',
                                    complaints: 0,
                                    role: 'user'
                                };
                                
                                users.push(newUser);
                                currentUser = newUser;
                                saveData();
                                
                                this.innerHTML = '<i class="fas fa-sign-out-alt"></i> Logout';
                                showNotification(`Registration successful! Welcome, ${name}.`, 'success');
                                updateComplaintList();
                                updateUIForUser();
                            }
                        }
                    }
                }
            });

            // Initialize UI
            updateComplaintList();
            updateStats();
            updateUIForUser();
            updateAdminStats();
            updateAdminComplaintsTable();
            updateAdminUsersTable();
            updateAdminServicesTable();

            // Set up periodic updates for demo purposes
            setInterval(updateStats, 5000);
        });

        // Data management functions
        function saveData() {
            localStorage.setItem('complaints', JSON.stringify(complaints));
            localStorage.setItem('users', JSON.stringify(users));
            localStorage.setItem('complaintIdCounter', complaintIdCounter.toString());
            localStorage.setItem('serviceApplications', JSON.stringify(serviceApplications));
            localStorage.setItem('settings', JSON.stringify(settings));
            if (currentUser) {
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
            }
        }

        function updateComplaintList() {
            const complaintList = document.getElementById('complaintList');
            complaintList.innerHTML = '';
            
            let userComplaints = complaints;
            if (currentUser && currentUser.role === 'user') {
                userComplaints = complaints.filter(c => c.userId === currentUser.id);
            }
            
            if (userComplaints.length === 0) {
                complaintList.innerHTML = '<p>No complaints found. ' + (currentUser ? '<a href="#" class="nav-link" data-section="complaints">File a complaint</a>' : 'Please login to view complaints.') + '</p>';
                return;
            }
            
            userComplaints.forEach(complaint => {
                const complaintItem = document.createElement('div');
                complaintItem.className = 'complaint-item';
                
                const statusClass = `status-${complaint.status.replace(' ', '-')}`;
                
                complaintItem.innerHTML = `
                    <div class="complaint-info">
                        <h3>${complaint.title} (ID: ${complaint.id})</h3>
                        <p>${complaint.description}</p>
                        <div class="complaint-meta">
                            <span><i class="fas fa-calendar"></i> ${complaint.date}</span>
                            <span><i class="fas fa-map-marker-alt"></i> ${complaint.location}</span>
                            <span><i class="fas fa-tag"></i> ${complaint.category}</span>
                            <span><i class="fas fa-flag"></i> ${complaint.priority}</span>
                        </div>
                    </div>
                    <div class="complaint-status">
                        <span class="status ${statusClass}">${complaint.status}</span>
                    </div>
                `;
                
                complaintList.appendChild(complaintItem);
            });
        }

        function updateStats() {
            document.getElementById('total-complaints').textContent = complaints.length;
            document.getElementById('resolved-complaints').textContent = complaints.filter(c => c.status === 'resolved').length;
            document.getElementById('active-users').textContent = users.filter(u => u.status === 'active').length;
            document.getElementById('avg-resolution').textContent = '2.5';
        }

        function updateAdminStats() {
            document.getElementById('admin-total-complaints').textContent = complaints.length;
            document.getElementById('admin-resolved-complaints').textContent = complaints.filter(c => c.status === 'resolved').length;
            document.getElementById('admin-pending-complaints').textContent = complaints.filter(c => c.status === 'pending').length;
            document.getElementById('admin-total-users').textContent = users.length;
            document.getElementById('admin-total-services').textContent = serviceApplications.length;
            
            const resolutionRate = complaints.length > 0 ? 
                Math.round((complaints.filter(c => c.status === 'resolved').length / complaints.length) * 100) : 0;
            document.getElementById('admin-resolution-rate').textContent = `${resolutionRate}%`;
            
            // Update report stats
            document.getElementById('report-complaints-by-category').textContent = new Set(complaints.map(c => c.category)).size;
            document.getElementById('report-this-month').textContent = complaints.filter(c => {
                const complaintDate = new Date(c.date);
                const now = new Date();
                return complaintDate.getMonth() === now.getMonth() && complaintDate.getFullYear() === now.getFullYear();
            }).length;
            document.getElementById('report-avg-resolution').textContent = '2.5';
        }

        function updateAdminComplaintsTable() {
            const tableBody = document.getElementById('adminComplaintsTable');
            tableBody.innerHTML = '';
            
            if (complaints.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="8" style="text-align: center;">No complaints found.</td></tr>';
                return;
            }
            
            complaints.forEach(complaint => {
                const row = document.createElement('tr');
                
                const statusClass = `status-${complaint.status.replace(' ', '-')}`;
                
                row.innerHTML = `
                    <td>${complaint.id}</td>
                    <td>${complaint.userName}</td>
                    <td>${complaint.category}</td>
                    <td>${complaint.title}</td>
                    <td>${complaint.date}</td>
                    <td>${complaint.priority}</td>
                    <td><span class="status ${statusClass}">${complaint.status}</span></td>
                    <td class="action-buttons">
                        <button class="action-btn view-btn" data-id="${complaint.id}"><i class="fas fa-eye"></i></button>
                        <button class="action-btn edit-btn" data-id="${complaint.id}"><i class="fas fa-edit"></i></button>
                        <button class="action-btn resolve-btn" data-id="${complaint.id}"><i class="fas fa-check"></i></button>
                        <button class="action-btn delete-btn" data-id="${complaint.id}"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners for action buttons
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    viewComplaint(id);
                });
            });
            
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    editComplaint(id);
                });
            });
            
            document.querySelectorAll('.resolve-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    resolveComplaint(id);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    deleteComplaint(id);
                });
            });
        }

        function updateAdminUsersTable() {
            const tableBody = document.getElementById('adminUsersTable');
            tableBody.innerHTML = '';
            
            users.forEach(user => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${user.id}</td>
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td>${user.phone}</td>
                    <td>${user.role}</td>
                    <td><span class="status status-${user.status}">${user.status}</span></td>
                    <td>${user.complaints || 0}</td>
                    <td class="action-buttons">
                        <button class="action-btn view-btn" data-id="${user.id}"><i class="fas fa-eye"></i></button>
                        <button class="action-btn edit-btn" data-id="${user.id}"><i class="fas fa-edit"></i></button>
                        <button class="action-btn delete-btn" data-id="${user.id}"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners for action buttons
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    viewUser(id);
                });
            });
            
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    editUser(id);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    deleteUser(id);
                });
            });
        }

        function updateAdminServicesTable() {
            const tableBody = document.getElementById('adminServicesTable');
            tableBody.innerHTML = '';
            
            if (serviceApplications.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="6" style="text-align: center;">No service applications found.</td></tr>';
                return;
            }
            
            serviceApplications.forEach(application => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${application.id}</td>
                    <td>${application.service}</td>
                    <td>${application.applicantName}</td>
                    <td>${application.date}</td>
                    <td><span class="status status-${application.status}">${application.status}</span></td>
                    <td class="action-buttons">
                        <button class="action-btn view-btn" data-id="${application.id}"><i class="fas fa-eye"></i></button>
                        <button class="action-btn edit-btn" data-id="${application.id}"><i class="fas fa-edit"></i></button>
                        <button class="action-btn delete-btn" data-id="${application.id}"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        function updateUIForUser() {
            if (currentUser) {
                document.getElementById('loginBtn').innerHTML = '<i class="fas fa-sign-out-alt"></i> Logout';
                
                // Show admin panel only for admin users
                if (currentUser.role === 'admin') {
                    document.querySelector('[data-section="admin"]').style.display = 'list-item';
                } else {
                    document.querySelector('[data-section="admin"]').style.display = 'none';
                }
            } else {
                document.getElementById('loginBtn').innerHTML = '<i class="fas fa-sign-in-alt"></i> Login';
                document.querySelector('[data-section="admin"]').style.display = 'none';
            }
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        // Admin complaint management functions
        function viewComplaint(id) {
            const complaint = complaints.find(c => c.id === id);
            if (complaint) {
                showNotification(`Viewing complaint: ${complaint.title} (ID: ${complaint.id})`, 'info');
            }
        }

        function editComplaint(id) {
            const complaint = complaints.find(c => c.id === id);
            if (complaint) {
                const newStatus = prompt('Enter new status (pending, in progress, resolved):', complaint.status);
                if (newStatus && ['pending', 'in progress', 'resolved'].includes(newStatus.toLowerCase())) {
                    complaint.status = newStatus.toLowerCase();
                    saveData();
                    updateComplaintList();
                    updateAdminComplaintsTable();
                    updateStats();
                    updateAdminStats();
                    showNotification('Complaint status updated successfully!', 'success');
                }
            }
        }

        function resolveComplaint(id) {
            const complaint = complaints.find(c => c.id === id);
            if (complaint) {
                complaint.status = 'resolved';
                saveData();
                updateComplaintList();
                updateAdminComplaintsTable();
                updateStats();
                updateAdminStats();
                showNotification('Complaint marked as resolved!', 'success');
            }
        }

        function deleteComplaint(id) {
            if (confirm('Are you sure you want to delete this complaint?')) {
                complaints = complaints.filter(c => c.id !== id);
                saveData();
                updateComplaintList();
                updateAdminComplaintsTable();
                updateStats();
                updateAdminStats();
                showNotification('Complaint deleted successfully!', 'success');
            }
        }

        function viewUser(id) {
            const user = users.find(u => u.id === id);
            if (user) {
                showNotification(`Viewing user: ${user.name} (ID: ${user.id})`, 'info');
            }
        }

        function editUser(id) {
            const user = users.find(u => u.id === id);
            if (user) {
                const newStatus = prompt('Enter new status (active, inactive):', user.status);
                if (newStatus && ['active', 'inactive'].includes(newStatus.toLowerCase())) {
                    user.status = newStatus.toLowerCase();
                    saveData();
                    updateAdminUsersTable();
                    updateAdminStats();
                    showNotification('User status updated successfully!', 'success');
                }
            }
        }

        function deleteUser(id) {
            if (id === currentUser.id) {
                showNotification('You cannot delete your own account.', 'error');
                return;
            }
            
            if (confirm('Are you sure you want to delete this user?')) {
                users = users.filter(u => u.id !== id);
                saveData();
                updateAdminUsersTable();
                updateAdminStats();
                showNotification('User deleted successfully!', 'success');
            }
        }

        // Enhanced 3D Animation using Three.js
        function init3DAnimation() {
            const container = document.getElementById('animation-container');
            if (!container) return;
            
            // Create scene
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0xf5f7fa);
            const camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);
            
            // Add lights
            const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(1, 1, 1);
            scene.add(directionalLight);
            
            // Create city buildings
            const buildings = [];
            const buildingColors = [0x3498db, 0x2ecc71, 0xe74c3c, 0xf39c12, 0x9b59b6];
            
            for (let i = 0; i < 15; i++) {
                const width = Math.random() * 2 + 1;
                const height = Math.random() * 3 + 2;
                const depth = Math.random() * 2 + 1;
                
                const geometry = new THREE.BoxGeometry(width, height, depth);
                const color = buildingColors[Math.floor(Math.random() * buildingColors.length)];
                const material = new THREE.MeshPhongMaterial({ color: color });
                const building = new THREE.Mesh(geometry, material);
                
                building.position.x = (Math.random() - 0.5) * 20;
                building.position.z = (Math.random() - 0.5) * 20;
                building.position.y = height / 2;
                
                scene.add(building);
                buildings.push(building);
            }
            
            // Add ground
            const groundGeometry = new THREE.PlaneGeometry(30, 30);
            const groundMaterial = new THREE.MeshPhongMaterial({ color: 0x95a5a6, side: THREE.DoubleSide });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = Math.PI / 2;
            ground.position.y = -1;
            scene.add(ground);
            
            // Position camera
            camera.position.z = 15;
            camera.position.y = 5;
            
            // Add orbit controls for interactive viewing
            const controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            
            // Animation loop
            function animate() {
                requestAnimationFrame(animate);
                
                // Rotate buildings slightly for dynamic effect
                buildings.forEach(building => {
                    building.rotation.y += 0.005;
                });
                
                controls.update();
                renderer.render(scene, camera);
            }
            
            animate();
            
            // Handle window resize
            window.addEventListener('resize', function() {
                camera.aspect = container.clientWidth / container.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.clientWidth, container.clientHeight);
            });
        }

        function initAdminChart() {
            const container = document.getElementById('admin-chart-container');
            if (!container) return;
            
            // Create a simple 3D chart for admin dashboard
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0xf8f9fa);
            const camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);
            
            // Add lights
            const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(1, 1, 1);
            scene.add(directionalLight);
            
            // Create chart bars
            const bars = [];
            const barColors = [0x3498db, 0x2ecc71, 0xe74c3c, 0xf39c12];
            const barHeights = [3, 5, 2, 4];
            
            for (let i = 0; i < 4; i++) {
                const geometry = new THREE.BoxGeometry(1.5, barHeights[i], 1.5);
                const material = new THREE.MeshPhongMaterial({ color: barColors[i] });
                const bar = new THREE.Mesh(geometry, material);
                
                bar.position.x = (i - 1.5) * 2.5;
                bar.position.y = barHeights[i] / 2;
                
                scene.add(bar);
                bars.push(bar);
            }
            
            // Position camera
            camera.position.z = 10;
            camera.position.y = 3;
            
            // Animation loop
            function animate() {
                requestAnimationFrame(animate);
                
                // Animate bars
                bars.forEach((bar, index) => {
                    bar.rotation.y += 0.01;
                    bar.position.y = (barHeights[index] / 2) + Math.sin(Date.now() * 0.001 + index) * 0.1;
                });
                
                renderer.render(scene, camera);
            }
            
            animate();
            
            // Handle window resize
            window.addEventListener('resize', function() {
                camera.aspect = container.clientWidth / container.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.clientWidth, container.clientHeight);
            });
        }

        function initReportsChart() {
            const container = document.getElementById('reports-chart-container');
            if (!container) return;
            
            // Create a 3D pie chart for reports
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0xf8f9fa);
            const camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);
            
            // Add lights
            const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(1, 1, 1);
            scene.add(directionalLight);
            
            // Create pie chart segments
            const segments = [];
            const segmentColors = [0x3498db, 0x2ecc71, 0xe74c3c, 0xf39c12, 0x9b59b6];
            const segmentValues = [30, 25, 20, 15, 10]; // percentages
            
            let startAngle = 0;
            const radius = 3;
            const height = 1;
            
            segmentValues.forEach((value, index) => {
                const angle = (value / 100) * Math.PI * 2;
                const geometry = new THREE.CylinderGeometry(radius, radius, height, 32, 1, false, startAngle, angle);
                const material = new THREE.MeshPhongMaterial({ 
                    color: segmentColors[index],
                    side: THREE.DoubleSide
                });
                const segment = new THREE.Mesh(geometry, material);
                
                segment.rotation.x = Math.PI / 2;
                segment.rotation.z = startAngle;
                
                scene.add(segment);
                segments.push(segment);
                
                startAngle += angle;
            });
            
            // Position camera
            camera.position.z = 8;
            
            // Animation loop
            function animate() {
                requestAnimationFrame(animate);
                
                // Rotate pie chart
                segments.forEach(segment => {
                    segment.rotation.y += 0.005;
                });
                
                renderer.render(scene, camera);
            }
            
            animate();
            
            // Handle window resize
            window.addEventListener('resize', function() {
                camera.aspect = container.clientWidth / container.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.clientWidth, container.clientHeight);
            });
        }
    </script>
</body>
</html>
