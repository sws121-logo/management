<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Municipality Services System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --info: #17a2b8;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: var(--dark);
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: var(--primary);
            color: white;
            padding: 20px 0;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo i {
            font-size: 2.5rem;
            color: var(--secondary);
        }
        
        .logo h1 {
            font-size: 1.8rem;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 5px;
            transition: all 0.3s;
        }
        
        nav a:hover, nav a.active {
            background: var(--secondary);
            transform: translateY(-2px);
        }
        
        .user-actions {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background: #27ae60;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn-warning {
            background: var(--warning);
            color: white;
        }
        
        .btn-warning:hover {
            background: #e67e22;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn-info {
            background: var(--info);
            color: white;
        }
        
        .btn-info:hover {
            background: #138496;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn-danger {
            background: var(--accent);
            color: white;
        }
        
        .btn-danger:hover {
            background: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            display: none;
            position: relative;
            overflow: hidden;
        }
        
        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-title {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light);
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .service-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
            cursor: pointer;
            border-left: 4px solid var(--secondary);
            position: relative;
            overflow: hidden;
        }
        
        .service-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }
        
        .service-icon {
            font-size: 2.5rem;
            color: var(--secondary);
            margin-bottom: 15px;
            transition: all 0.3s;
        }
        
        .service-card:hover .service-icon {
            transform: scale(1.2) rotate(5deg);
            color: var(--accent);
        }
        
        .service-details {
            margin-top: 15px;
            text-align: left;
            font-size: 0.9rem;
            color: #666;
            display: none;
        }
        
        .service-card.active .service-details {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        .service-features {
            list-style: none;
            margin-top: 10px;
        }
        
        .service-features li {
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }
        
        .service-features li:last-child {
            border-bottom: none;
        }
        
        .service-action {
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            margin-bottom: 15px;
        }
        
        label {
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        input, select, textarea {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
            outline: none;
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .file-upload {
            border: 2px dashed #ddd;
            border-radius: 5px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-upload:hover {
            border-color: var(--secondary);
            background: #f8f9fa;
        }
        
        .file-upload i {
            font-size: 2rem;
            color: var(--secondary);
            margin-bottom: 10px;
        }
        
        .uploaded-files {
            margin-top: 15px;
        }
        
        .uploaded-file {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
            margin-bottom: 5px;
        }
        
        .file-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .file-preview {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 5px;
        }
        
        .payment-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .payment-methods {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .payment-method {
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .payment-method:hover, .payment-method.selected {
            border-color: var(--secondary);
            background: white;
        }
        
        .payment-method i {
            font-size: 2rem;
            color: var(--secondary);
            margin-bottom: 10px;
        }
        
        .admin-panel {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
        }
        
        .admin-sidebar {
            background: var(--primary);
            color: white;
            border-radius: 10px;
            padding: 20px;
        }
        
        .admin-sidebar ul {
            list-style: none;
        }
        
        .admin-sidebar li {
            margin-bottom: 10px;
        }
        
        .admin-sidebar a {
            color: white;
            text-decoration: none;
            display: block;
            padding: 10px;
            border-radius: 5px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .admin-sidebar a:hover, .admin-sidebar a.active {
            background: var(--secondary);
            transform: translateX(5px);
        }
        
        .admin-content {
            background: white;
            border-radius: 10px;
            padding: 20px;
        }
        
        .admin-tab {
            display: none;
        }
        
        .admin-tab.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .admin-stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            border-top: 4px solid var(--secondary);
            transition: all 0.3s;
        }
        
        .admin-stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }
        
        .admin-stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .admin-stat-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background: #f8f9fa;
            font-weight: 600;
        }
        
        tr {
            transition: all 0.3s;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        
        .action-btn {
            padding: 5px 10px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s;
        }
        
        .edit-btn {
            background: var(--warning);
            color: white;
        }
        
        .edit-btn:hover {
            background: #e67e22;
            transform: scale(1.05);
        }
        
        .delete-btn {
            background: var(--accent);
            color: white;
        }
        
        .delete-btn:hover {
            background: #c0392b;
            transform: scale(1.05);
        }
        
        .view-btn {
            background: var(--info);
            color: white;
        }
        
        .view-btn:hover {
            background: #138496;
            transform: scale(1.05);
        }
        
        .resolve-btn {
            background: var(--success);
            color: white;
        }
        
        .resolve-btn:hover {
            background: #27ae60;
            transform: scale(1.05);
        }
        
        .chatbot-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .chatbot-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--secondary);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .chatbot-toggle:hover {
            transform: scale(1.1) rotate(10deg);
            background: var(--accent);
        }
        
        .chatbot-window {
            position: absolute;
            bottom: 70px;
            right: 0;
            width: 400px;
            height: 500px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
            display: none;
            flex-direction: column;
            overflow: hidden;
            animation: slideUp 0.3s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .chatbot-header {
            background: var(--primary);
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chatbot-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .message {
            padding: 10px 15px;
            border-radius: 18px;
            max-width: 80%;
            line-height: 1.4;
            animation: messageAppear 0.3s ease;
        }
        
        @keyframes messageAppear {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .bot-message {
            background: #f1f1f1;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }
        
        .user-message {
            background: var(--secondary);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }
        
        .quick-replies {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .quick-reply {
            background: #e0e0e0;
            border: none;
            border-radius: 15px;
            padding: 5px 10px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .quick-reply:hover {
            background: #d0d0d0;
        }
        
        .chatbot-input {
            display: flex;
            padding: 10px;
            border-top: 1px solid #eee;
        }
        
        .chatbot-input input {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 10px 15px;
            margin-right: 10px;
        }
        
        .chatbot-input button {
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .chatbot-input button:hover {
            background: var(--accent);
            transform: rotate(15deg);
        }
        
        .floating-animation {
            position: absolute;
            width: 50px;
            height: 50px;
            background: rgba(52, 152, 219, 0.1);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
            100% { transform: translateY(0) rotate(360deg); }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 5px;
            color: white;
            z-index: 3000;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            animation: slideInRight 0.3s ease;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .notification-success {
            background: var(--success);
        }
        
        .notification-error {
            background: var(--accent);
        }
        
        .notification-info {
            background: var(--info);
        }
        
        .service-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .service-modal-content {
            background: white;
            border-radius: 10px;
            padding: 25px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            animation: modalAppear 0.3s ease;
        }
        
        @keyframes modalAppear {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .service-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #7f8c8d;
        }
        
        .service-form {
            display: grid;
            gap: 15px;
        }
        
        .admin-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .application-details {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .document-list {
            list-style: none;
            margin: 10px 0;
        }
        
        .document-list li {
            padding: 5px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .document-list li i {
            color: var(--success);
        }
        
        .complaint-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .complaint-meta {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }
        
        .complaint-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            color: #666;
        }
        
        .status {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-approved {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .status-completed {
            background: #d4edda;
            color: #155724;
        }
        
        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }
        
        .small {
            font-size: 0.8rem;
            color: #666;
        }
        
        .btn-sm {
            padding: 5px 10px;
            font-size: 0.8rem;
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            nav ul {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .chatbot-window {
                width: 300px;
                height: 400px;
            }
            
            .services-grid {
                grid-template-columns: 1fr;
            }
            
            .service-action {
                flex-direction: column;
                gap: 10px;
            }
            
            .user-actions {
                flex-direction: column;
                width: 100%;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .admin-panel {
                grid-template-columns: 1fr;
            }
            
            .admin-sidebar {
                order: 2;
            }
            
            .admin-content {
                order: 1;
            }
            
            table {
                display: block;
                overflow-x: auto;
            }
            
            .payment-methods {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="floating-animation" style="top: 10%; left: 5%;"></div>
            <div class="floating-animation" style="top: 20%; right: 10%;"></div>
            <div class="floating-animation" style="bottom: 15%; left: 15%;"></div>
            <div class="floating-animation" style="bottom: 25%; right: 5%;"></div>
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-city"></i>
                    <h1>Municipality Services</h1>
                </div>
                <nav>
                    <ul>
                        <li><a href="#" class="nav-link active" data-section="home"><i class="fas fa-home"></i> Home</a></li>
                        <li><a href="#" class="nav-link" data-section="services"><i class="fas fa-concierge-bell"></i> Services</a></li>
                        <li><a href="#" class="nav-link" data-section="applications"><i class="fas fa-file-alt"></i> My Applications</a></li>
                        <li><a href="#" class="nav-link" data-section="admin"><i class="fas fa-user-shield"></i> Admin</a></li>
                    </ul>
                </nav>
                <div class="user-actions">
                    <button class="btn btn-primary" id="loginBtn"><i class="fas fa-sign-in-alt"></i> Login</button>
                </div>
            </div>
        </header>

        <!-- Home Section -->
        <section id="home" class="section active">
            <h2 class="section-title"><i class="fas fa-home"></i> Welcome to Municipality Services</h2>
            <div class="services-grid">
                <div class="service-card" data-service="birth-certificate">
                    <i class="fas fa-id-card service-icon"></i>
                    <h3>Birth Certificate</h3>
                    <p>Apply for birth certificate registration and copies</p>
                    <div class="service-details">
                        <p><strong>Required Documents:</strong></p>
                        <ul class="service-features">
                            <li>Hospital birth record</li>
                            <li>Parent's ID proof (Aadhar Card)</li>
                            <li>Address proof</li>
                            <li>Parent's marriage certificate</li>
                        </ul>
                        <p><strong>Processing Time:</strong> 3-5 business days</p>
                        <p><strong>Fee:</strong> ₹50 for first copy, ₹20 for additional copies</p>
                        <div class="service-action">
                            <button class="btn btn-info btn-apply" data-service="Birth Certificate">Apply Now</button>
                            <button class="btn btn-primary btn-info" data-service="Birth Certificate">More Info</button>
                        </div>
                    </div>
                </div>
                <div class="service-card" data-service="death-certificate">
                    <i class="fas fa-file-medical service-icon"></i>
                    <h3>Death Certificate</h3>
                    <p>Register death and obtain death certificate</p>
                    <div class="service-details">
                        <p><strong>Required Documents:</strong></p>
                        <ul class="service-features">
                            <li>Medical certificate of cause of death</li>
                            <li>Deceased's ID proof (Aadhar Card)</li>
                            <li>Applicant's ID proof</li>
                            <li>Proof of relationship</li>
                        </ul>
                        <p><strong>Processing Time:</strong> 2-4 business days</p>
                        <p><strong>Fee:</strong> ₹30</p>
                        <div class="service-action">
                            <button class="btn btn-info btn-apply" data-service="Death Certificate">Apply Now</button>
                            <button class="btn btn-primary btn-info" data-service="Death Certificate">More Info</button>
                        </div>
                    </div>
                </div>
                <div class="service-card" data-service="property-tax">
                    <i class="fas fa-home service-icon"></i>
                    <h3>Property Tax</h3>
                    <p>Pay property tax online or offline</p>
                    <div class="service-details">
                        <p><strong>Required Documents:</strong></p>
                        <ul class="service-features">
                            <li>Property ID number</li>
                            <li>Previous tax receipt</li>
                            <li>Owner's ID proof</li>
                        </ul>
                        <p><strong>Payment Methods:</strong></p>
                        <ul class="service-features">
                            <li>Credit/Debit Card</li>
                            <li>Net Banking</li>
                            <li>UPI</li>
                            <li>Cash at municipality office</li>
                        </ul>
                        <p><strong>Due Date:</strong> 31st March each year</p>
                        <div class="service-action">
                            <button class="btn btn-info btn-apply" data-service="Property Tax">Pay Now</button>
                            <button class="btn btn-primary btn-info" data-service="Property Tax">More Info</button>
                        </div>
                    </div>
                </div>
                <div class="service-card" data-service="vehicle-registration">
                    <i class="fas fa-car service-icon"></i>
                    <h3>Vehicle Registration</h3>
                    <p>New vehicle registration and transfers</p>
                    <div class="service-details">
                        <p><strong>Required Documents:</strong></p>
                        <ul class="service-features">
                            <li>Address proof (Aadhar Card)</li>
                            <li>ID proof (Aadhar Card)</li>
                            <li>Vehicle invoice</li>
                            <li>Insurance certificate</li>
                            <li>Pollution under control certificate</li>
                        </ul>
                        <p><strong>Processing Time:</strong> 1-2 business days</p>
                        <p><strong>Fee:</strong> ₹300-₹1000 (based on vehicle type)</p>
                        <div class="service-action">
                            <button class="btn btn-info btn-apply" data-service="Vehicle Registration">Apply Now</button>
                            <button class="btn btn-primary btn-info" data-service="Vehicle Registration">More Info</button>
                        </div>
                    </div>
                </div>
                <div class="service-card" data-service="building-permit">
                    <i class="fas fa-hard-hat service-icon"></i>
                    <h3>Building Permit</h3>
                    <p>Apply for construction and renovation permits</p>
                    <div class="service-details">
                        <p><strong>Required Documents:</strong></p>
                        <ul class="service-features">
                            <li>Land ownership documents</li>
                            <li>Building plans (architect approved)</li>
                            <li>Structural stability certificate</li>
                            <li>NOC from fire department</li>
                            <li>Owner's ID proof (Aadhar Card)</li>
                        </ul>
                        <p><strong>Processing Time:</strong> 15-30 business days</p>
                        <p><strong>Fee:</strong> Based on construction area</p>
                        <div class="service-action">
                            <button class="btn btn-info btn-apply" data-service="Building Permit">Apply Now</button>
                            <button class="btn btn-primary btn-info" data-service="Building Permit">More Info</button>
                        </div>
                    </div>
                </div>
                <div class="service-card" data-service="trade-license">
                    <i class="fas fa-store service-icon"></i>
                    <h3>Trade License</h3>
                    <p>Obtain license for business operations</p>
                    <div class="service-details">
                        <p><strong>Required Documents:</strong></p>
                        <ul class="service-features">
                            <li>Address proof of business</li>
                            <li>ID proof of applicant (Aadhar Card)</li>
                            <li>Property tax receipt</li>
                            <li>NOC from landlord (if rented)</li>
                            <li>Business incorporation documents</li>
                        </ul>
                        <p><strong>Processing Time:</strong> 7-10 business days</p>
                        <p><strong>Fee:</strong> ₹500-₹5000 (based on business type)</p>
                        <div class="service-action">
                            <button class="btn btn-info btn-apply" data-service="Trade License">Apply Now</button>
                            <button class="btn btn-primary btn-info" data-service="Trade License">More Info</button>
                        </div>
                    </div>
                </div>
                <div class="service-card" data-service="license-renewal">
                    <i class="fas fa-sync-alt service-icon"></i>
                    <h3>License Renewal</h3>
                    <p>Renew existing licenses and permits</p>
                    <div class="service-details">
                        <p><strong>Required Documents:</strong></p>
                        <ul class="service-features">
                            <li>Existing license copy</li>
                            <li>ID proof (Aadhar Card)</li>
                            <li>Address proof</li>
                            <li>Recent photograph</li>
                        </ul>
                        <p><strong>Processing Time:</strong> 3-5 business days</p>
                        <p><strong>Fee:</strong> Same as original license fee</p>
                        <div class="service-action">
                            <button class="btn btn-info btn-apply" data-service="License Renewal">Renew Now</button>
                            <button class="btn btn-primary btn-info" data-service="License Renewal">More Info</button>
                        </div>
                    </div>
                </div>
                <div class="service-card" data-service="water-connection">
                    <i class="fas fa-tint service-icon"></i>
                    <h3>Water Connection</h3>
                    <p>Apply for new water connection</p>
                    <div class="service-details">
                        <p><strong>Required Documents:</strong></p>
                        <ul class="service-features">
                            <li>Address proof (Aadhar Card)</li>
                            <li>ID proof (Aadhar Card)</li>
                            <li>Property ownership proof</li>
                            <li>Building plan approval</li>
                        </ul>
                        <p><strong>Processing Time:</strong> 7-10 business days</p>
                        <p><strong>Fee:</strong> ₹2000 connection charge</p>
                        <div class="service-action">
                            <button class="btn btn-info btn-apply" data-service="Water Connection">Apply Now</button>
                            <button class="btn btn-primary btn-info" data-service="Water Connection">More Info</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Services Section -->
        <section id="services" class="section">
            <h2 class="section-title"><i class="fas fa-concierge-bell"></i> All Services</h2>
            <p>This section contains detailed information about all available services. Please select a service from the home page to apply.</p>
        </section>

        <!-- My Applications Section -->
        <section id="applications" class="section">
            <h2 class="section-title"><i class="fas fa-file-alt"></i> My Applications</h2>
            <div id="userApplicationsList">
                <!-- User applications will be dynamically added here -->
            </div>
        </section>

        <!-- Admin Panel Section -->
        <section id="admin" class="section">
            <h2 class="section-title"><i class="fas fa-user-shield"></i> Admin Control Panel</h2>
            <div class="admin-panel">
                <div class="admin-sidebar">
                    <ul>
                        <li><a href="#" class="admin-nav active" data-tab="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                        <li><a href="#" class="admin-nav" data-tab="applications"><i class="fas fa-list-alt"></i> Manage Applications</a></li>
                        <li><a href="#" class="admin-nav" data-tab="users"><i class="fas fa-users"></i> User Management</a></li>
                        <li><a href="#" class="admin-nav" data-tab="settings"><i class="fas fa-cogs"></i> System Settings</a></li>
                    </ul>
                </div>
                <div class="admin-content">
                    <!-- Admin Dashboard -->
                    <div id="admin-dashboard" class="admin-tab active">
                        <h3>Admin Dashboard</h3>
                        <div class="admin-stats">
                            <div class="admin-stat-card">
                                <i class="fas fa-file-alt"></i>
                                <div class="admin-stat-number" id="admin-total-applications">0</div>
                                <div class="admin-stat-label">Total Applications</div>
                            </div>
                            <div class="admin-stat-card">
                                <i class="fas fa-check-circle"></i>
                                <div class="admin-stat-number" id="admin-approved-applications">0</div>
                                <div class="admin-stat-label">Approved Applications</div>
                            </div>
                            <div class="admin-stat-card">
                                <i class="fas fa-clock"></i>
                                <div class="admin-stat-number" id="admin-pending-applications">0</div>
                                <div class="admin-stat-label">Pending Applications</div>
                            </div>
                            <div class="admin-stat-card">
                                <i class="fas fa-users"></i>
                                <div class="admin-stat-number" id="admin-total-users">0</div>
                                <div class="admin-stat-label">Registered Users</div>
                            </div>
                            <div class="admin-stat-card">
                                <i class="fas fa-rupee-sign"></i>
                                <div class="admin-stat-number" id="admin-total-revenue">₹0</div>
                                <div class="admin-stat-label">Total Revenue</div>
                            </div>
                            <div class="admin-stat-card">
                                <i class="fas fa-chart-line"></i>
                                <div class="admin-stat-number" id="admin-approval-rate">0%</div>
                                <div class="admin-stat-label">Approval Rate</div>
                            </div>
                        </div>
                    </div>

                    <!-- Manage Applications -->
                    <div id="admin-applications" class="admin-tab">
                        <h3>Manage Applications</h3>
                        <div class="admin-controls">
                            <button class="btn btn-primary" id="refreshApplications"><i class="fas fa-sync-alt"></i> Refresh</button>
                            <button class="btn btn-success" id="exportApplications"><i class="fas fa-file-export"></i> Export</button>
                            <button class="btn btn-info" id="filterApplications"><i class="fas fa-filter"></i> Filter</button>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>App ID</th>
                                    <th>Service</th>
                                    <th>Applicant</th>
                                    <th>Date</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminApplicationsTable">
                                <!-- Applications will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- User Management -->
                    <div id="admin-users" class="admin-tab">
                        <h3>User Management</h3>
                        <div class="admin-controls">
                            <button class="btn btn-primary" id="refreshUsers"><i class="fas fa-sync-alt"></i> Refresh</button>
                            <button class="btn btn-success" id="addUser"><i class="fas fa-user-plus"></i> Add User</button>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>User ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Applications</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminUsersTable">
                                <!-- Users will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- System Settings -->
                    <div id="admin-settings" class="admin-tab">
                        <h3>System Settings</h3>
                        <form id="adminSettingsForm" class="service-form">
                            <div class="form-group">
                                <label for="systemName"><i class="fas fa-cog"></i> System Name</label>
                                <input type="text" id="systemName" value="Municipality Services" required>
                            </div>
                            <div class="form-group">
                                <label for="adminEmail"><i class="fas fa-envelope"></i> Admin Email</label>
                                <input type="email" id="adminEmail" value="admin@municipality.gov" required>
                            </div>
                            <div class="form-group">
                                <label for="helpline"><i class="fas fa-phone"></i> Helpline Number</label>
                                <input type="text" id="helpline" value="1800-123-4567" required>
                            </div>
                            <button type="submit" class="btn btn-primary" id="saveSettings"><i class="fas fa-save"></i> Save Settings</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- Service Application Modal -->
        <div class="service-modal" id="serviceModal">
            <div class="service-modal-content">
                <div class="service-modal-header">
                    <h3 id="modalServiceTitle">Apply for Service</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <form id="serviceApplicationForm" class="service-form">
                    <div id="formFields">
                        <!-- Dynamic form fields will be added here -->
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-upload"></i> Upload Required Documents</label>
                        <div class="file-upload" id="documentUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload documents or drag and drop</p>
                            <p class="small">Supported formats: JPG, PNG, PDF (Max: 5MB each)</p>
                            <input type="file" id="fileInput" multiple style="display: none;" accept=".jpg,.jpeg,.png,.pdf">
                        </div>
                        <div class="uploaded-files" id="uploadedFiles">
                            <!-- Uploaded files will be displayed here -->
                        </div>
                    </div>
                    <div id="paymentSection" class="payment-section" style="display: none;">
                        <h4><i class="fas fa-credit-card"></i> Payment</h4>
                        <div class="form-group">
                            <label>Select Payment Method</label>
                            <div class="payment-methods">
                                <div class="payment-method" data-method="card">
                                    <i class="fas fa-credit-card"></i>
                                    <p>Credit/Debit Card</p>
                                </div>
                                <div class="payment-method" data-method="netbanking">
                                    <i class="fas fa-university"></i>
                                    <p>Net Banking</p>
                                </div>
                                <div class="payment-method" data-method="upi">
                                    <i class="fas fa-mobile-alt"></i>
                                    <p>UPI</p>
                                </div>
                            </div>
                        </div>
                        <div id="cardDetails" style="display: none;">
                            <div class="form-group">
                                <label>Card Number</label>
                                <input type="text" placeholder="1234 5678 9012 3456">
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                <div class="form-group">
                                    <label>Expiry Date</label>
                                    <input type="text" placeholder="MM/YY">
                                </div>
                                <div class="form-group">
                                    <label>CVV</label>
                                    <input type="text" placeholder="123">
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success" id="submitApplication"><i class="fas fa-paper-plane"></i> Submit Application</button>
                </form>
            </div>
        </div>

        <!-- Chatbot -->
        <div class="chatbot-container">
            <div class="chatbot-toggle" id="chatbotToggle">
                <i class="fas fa-comments"></i>
            </div>
            <div class="chatbot-window" id="chatbotWindow">
                <div class="chatbot-header">
                    <h3>Municipality Assistant</h3>
                    <button id="closeChatbot"><i class="fas fa-times"></i></button>
                </div>
                <div class="chatbot-messages" id="chatbotMessages">
                    <div class="message bot-message">
                        Hello! I'm your municipality assistant. I can help you with:
                        <div class="quick-replies">
                            <button class="quick-reply" data-query="birth certificate documents">Birth Certificate</button>
                            <button class="quick-reply" data-query="death certificate documents">Death Certificate</button>
                            <button class="quick-reply" data-query="property tax payment">Property Tax</button>
                            <button class="quick-reply" data-query="vehicle registration documents">Vehicle Registration</button>
                            <button class="quick-reply" data-query="building permit documents">Building Permit</button>
                            <button class="quick-reply" data-query="trade license documents">Trade License</button>
                        </div>
                    </div>
                </div>
                <div class="chatbot-input">
                    <input type="text" id="chatbotInput" placeholder="Ask about document requirements...">
                    <button id="sendMessage"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>

        <footer style="text-align: center; padding: 20px; color: #666;">
            <p>&copy; 2023 Municipality Services. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Enhanced data structure for the application
        let serviceApplications = JSON.parse(localStorage.getItem('serviceApplications')) || [];
        let users = JSON.parse(localStorage.getItem('users')) || [
            { 
                id: 1, 
                name: "Admin User", 
                email: "admin@municipality.gov", 
                phone: "1122334455", 
                password: "admin123", 
                status: "active", 
                role: "admin" 
            },
            { 
                id: 2, 
                name: "John Doe", 
                email: "john@example.com", 
                phone: "1234567890", 
                password: "password123", 
                status: "active", 
                role: "user" 
            }
        ];
        let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
        let applicationIdCounter = parseInt(localStorage.getItem('applicationIdCounter')) || 1001;
        let settings = JSON.parse(localStorage.getItem('settings')) || {
            systemName: "Municipality Services",
            adminEmail: "admin@municipality.gov",
            helpline: "1800-123-4567"
        };

        // Service configurations with detailed document requirements
        const serviceConfigs = {
            "Birth Certificate": {
                fields: [
                    { name: "childName", label: "Child's Full Name", type: "text", required: true },
                    { name: "dateOfBirth", label: "Date of Birth", type: "date", required: true },
                    { name: "placeOfBirth", label: "Place of Birth", type: "text", required: true },
                    { name: "fatherName", label: "Father's Name", type: "text", required: true },
                    { name: "motherName", label: "Mother's Name", type: "text", required: true },
                    { name: "parentAddress", label: "Parent's Address", type: "textarea", required: true }
                ],
                documents: [
                    "Hospital birth record",
                    "Parent's Aadhar Card (Front & Back)",
                    "Parent's marriage certificate",
                    "Address proof",
                    "Parent's photograph"
                ],
                fee: 50,
                processingTime: "3-5 business days"
            },
            "Death Certificate": {
                fields: [
                    { name: "deceasedName", label: "Deceased Person's Name", type: "text", required: true },
                    { name: "dateOfDeath", label: "Date of Death", type: "date", required: true },
                    { name: "placeOfDeath", label: "Place of Death", type: "text", required: true },
                    { name: "causeOfDeath", label: "Cause of Death", type: "text", required: true },
                    { name: "applicantName", label: "Applicant's Name", type: "text", required: true },
                    { name: "relationship", label: "Relationship to Deceased", type: "text", required: true }
                ],
                documents: [
                    "Medical certificate of cause of death",
                    "Deceased's Aadhar Card (Front & Back)",
                    "Applicant's Aadhar Card (Front & Back)",
                    "Proof of relationship",
                    "Address proof of deceased"
                ],
                fee: 30,
                processingTime: "2-4 business days"
            },
            "Property Tax": {
                fields: [
                    { name: "propertyId", label: "Property ID Number", type: "text", required: true },
                    { name: "ownerName", label: "Property Owner Name", type: "text", required: true },
                    { name: "propertyAddress", label: "Property Address", type: "textarea", required: true },
                    { name: "assessmentYear", label: "Assessment Year", type: "text", required: true },
                    { name: "taxAmount", label: "Tax Amount (₹)", type: "number", required: true }
                ],
                documents: [
                    "Property ID card",
                    "Owner's Aadhar Card (Front & Back)",
                    "Previous tax receipt",
                    "Property ownership proof"
                ],
                fee: 0, // Will be calculated based on property
                processingTime: "Immediate (Online Payment)"
            },
            "Vehicle Registration": {
                fields: [
                    { name: "vehicleType", label: "Vehicle Type", type: "select", options: ["Two Wheeler", "Four Wheeler", "Commercial Vehicle"], required: true },
                    { name: "vehicleModel", label: "Vehicle Model", type: "text", required: true },
                    { name: "chassisNumber", label: "Chassis Number", type: "text", required: true },
                    { name: "engineNumber", label: "Engine Number", type: "text", required: true },
                    { name: "ownerName", label: "Owner's Name", type: "text", required: true },
                    { name: "purchaseDate", label: "Purchase Date", type: "date", required: true }
                ],
                documents: [
                    "Owner's Aadhar Card (Front & Back)",
                    "Address proof",
                    "Vehicle invoice",
                    "Insurance certificate",
                    "Pollution under control certificate",
                    "Vehicle photograph"
                ],
                fee: 500,
                processingTime: "1-2 business days"
            },
            "Building Permit": {
                fields: [
                    { name: "projectName", label: "Project Name", type: "text", required: true },
                    { name: "constructionType", label: "Type of Construction", type: "select", options: ["Residential", "Commercial", "Industrial"], required: true },
                    { name: "totalArea", label: "Total Construction Area (sq ft)", type: "number", required: true },
                    { name: "ownerName", label: "Property Owner Name", type: "text", required: true },
                    { name: "architectName", label: "Architect Name", type: "text", required: true },
                    { name: "estimatedCost", label: "Estimated Construction Cost (₹)", type: "number", required: true }
                ],
                documents: [
                    "Land ownership documents",
                    "Building plans (signed by architect)",
                    "Structural stability certificate",
                    "NOC from fire department",
                    "Owner's Aadhar Card (Front & Back)",
                    "Architect's license copy"
                ],
                fee: 2000,
                processingTime: "15-30 business days"
            },
            "Trade License": {
                fields: [
                    { name: "businessName", label: "Business Name", type: "text", required: true },
                    { name: "businessType", label: "Type of Business", type: "select", options: ["Retail", "Wholesale", "Service", "Manufacturing"], required: true },
                    { name: "ownerName", label: "Business Owner Name", type: "text", required: true },
                    { name: "businessAddress", label: "Business Address", type: "textarea", required: true },
                    { name: "annualTurnover", label: "Estimated Annual Turnover (₹)", type: "number", required: true }
                ],
                documents: [
                    "Business address proof",
                    "Owner's Aadhar Card (Front & Back)",
                    "Property tax receipt",
                    "NOC from landlord (if rented)",
                    "Business incorporation documents",
                    "GST registration (if applicable)"
                ],
                fee: 1000,
                processingTime: "7-10 business days"
            },
            "License Renewal": {
                fields: [
                    { name: "licenseNumber", label: "Existing License Number", type: "text", required: true },
                    { name: "licenseType", label: "License Type", type: "select", options: ["Trade License", "Building Permit", "Vehicle Registration"], required: true },
                    { name: "expiryDate", label: "Current Expiry Date", type: "date", required: true },
                    { name: "applicantName", label: "Applicant Name", type: "text", required: true }
                ],
                documents: [
                    "Existing license copy",
                    "Aadhar Card (Front & Back)",
                    "Address proof",
                    "Recent photograph",
                    "Updated business documents (if any changes)"
                ],
                fee: 500,
                processingTime: "3-5 business days"
            },
            "Water Connection": {
                fields: [
                    { name: "applicantName", label: "Applicant Name", type: "text", required: true },
                    { name: "propertyAddress", label: "Property Address", type: "textarea", required: true },
                    { name: "connectionType", label: "Type of Connection", type: "select", options: ["Domestic", "Commercial", "Industrial"], required: true },
                    { name: "requiredCapacity", label: "Required Water Capacity", type: "select", options: ["15mm", "20mm", "25mm"], required: true }
                ],
                documents: [
                    "Aadhar Card (Front & Back)",
                    "Property ownership proof",
                    "Building plan approval",
                    "Address proof",
                    "No objection certificate from society (if applicable)"
                ],
                fee: 2000,
                processingTime: "7-10 business days"
            }
        };

        // Enhanced chatbot knowledge base
        const chatbotKnowledge = {
            "birth certificate documents": "For Birth Certificate, you need: 1) Hospital birth record, 2) Parent's Aadhar Card (both sides), 3) Parent's marriage certificate, 4) Address proof, 5) Parent's photograph. Processing time is 3-5 days with ₹50 fee.",
            "death certificate documents": "For Death Certificate, you need: 1) Medical certificate of cause of death, 2) Deceased's Aadhar Card (both sides), 3) Applicant's Aadhar Card (both sides), 4) Proof of relationship, 5) Address proof of deceased. Processing time is 2-4 days with ₹30 fee.",
            "property tax payment": "For Property Tax payment, you need: 1) Property ID number, 2) Owner's Aadhar Card (both sides), 3) Previous tax receipt. Payment can be made online via card, net banking, or UPI. Due date is 31st March each year.",
            "vehicle registration documents": "For Vehicle Registration, you need: 1) Owner's Aadhar Card (both sides), 2) Address proof, 3) Vehicle invoice, 4) Insurance certificate, 5) PUC certificate, 6) Vehicle photograph. Fee ranges from ₹300-₹1000 based on vehicle type.",
            "building permit documents": "For Building Permit, you need: 1) Land ownership documents, 2) Architect-approved building plans, 3) Structural stability certificate, 4) Fire department NOC, 5) Owner's Aadhar Card (both sides), 6) Architect's license copy. Processing takes 15-30 days.",
            "trade license documents": "For Trade License, you need: 1) Business address proof, 2) Owner's Aadhar Card (both sides), 3) Property tax receipt, 4) Landlord NOC (if rented), 5) Business incorporation documents. Fee is ₹500-₹5000 based on business type.",
            "license renewal documents": "For License Renewal, you need: 1) Existing license copy, 2) Aadhar Card (both sides), 3) Address proof, 4) Recent photograph, 5) Updated business documents (if any changes). Processing time is 3-5 days.",
            "water connection documents": "For Water Connection, you need: 1) Aadhar Card (both sides), 2) Property ownership proof, 3) Building plan approval, 4) Address proof, 5) Society NOC (if applicable). Connection charge is ₹2000.",
            "default": "I can help you with document requirements for: Birth Certificate, Death Certificate, Property Tax, Vehicle Registration, Building Permit, Trade License, License Renewal, and Water Connection. What service are you interested in?"
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    const sectionId = this.getAttribute('data-section');
                    document.getElementById(sectionId).classList.add('active');
                    
                    // Update applications list when applications section is opened
                    if (sectionId === 'applications') {
                        updateUserApplicationsList();
                    }
                    
                    // Update admin stats when admin section is opened
                    if (sectionId === 'admin') {
                        updateAdminStats();
                        updateAdminApplicationsTable();
                        updateAdminUsersTable();
                    }
                });
            });

            // Admin navigation
            document.querySelectorAll('.admin-nav').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('.admin-nav').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.admin-tab').forEach(tab => {
                        tab.classList.remove('active');
                    });
                    
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(`admin-${tabId}`).classList.add('active');
                });
            });

            // Service cards functionality
            document.querySelectorAll('.service-card').forEach(card => {
                card.addEventListener('click', function(e) {
                    // Toggle service details
                    if (!e.target.classList.contains('btn-apply') && !e.target.classList.contains('btn-info')) {
                        this.classList.toggle('active');
                    }
                });
            });

            // Service application buttons
            document.querySelectorAll('.btn-apply').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const service = this.getAttribute('data-service');
                    openServiceModal(service);
                });
            });

            // Service info buttons
            document.querySelectorAll('.btn-info').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const service = this.getAttribute('data-service');
                    showNotification(`Document requirements for ${service}: ${chatbotKnowledge[service.toLowerCase() + ' documents'] || 'Please check the service details for document requirements.'}`, 'info');
                });
            });

            // Service modal functionality
            document.querySelector('.close-modal').addEventListener('click', function() {
                document.getElementById('serviceModal').style.display = 'none';
            });

            // File upload functionality
            document.getElementById('documentUpload').addEventListener('click', function() {
                document.getElementById('fileInput').click();
            });

            document.getElementById('fileInput').addEventListener('change', function(e) {
                handleFileUpload(e.target.files);
            });

            // Drag and drop functionality
            document.getElementById('documentUpload').addEventListener('dragover', function(e) {
                e.preventDefault();
                this.style.borderColor = '#3498db';
                this.style.background = '#f0f8ff';
            });

            document.getElementById('documentUpload').addEventListener('dragleave', function(e) {
                e.preventDefault();
                this.style.borderColor = '#ddd';
                this.style.background = '#f8f9fa';
            });

            document.getElementById('documentUpload').addEventListener('drop', function(e) {
                e.preventDefault();
                this.style.borderColor = '#ddd';
                this.style.background = '#f8f9fa';
                handleFileUpload(e.dataTransfer.files);
            });

            // Payment method selection
            document.querySelectorAll('.payment-method').forEach(method => {
                method.addEventListener('click', function() {
                    document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    // Show card details if card payment selected
                    if (this.dataset.method === 'card') {
                        document.getElementById('cardDetails').style.display = 'block';
                    } else {
                        document.getElementById('cardDetails').style.display = 'none';
                    }
                });
            });

            // Service application form
            document.getElementById('serviceApplicationForm').addEventListener('submit', function(e) {
                e.preventDefault();
                submitServiceApplication();
            });

            // Admin functionality
            document.getElementById('refreshApplications').addEventListener('click', function() {
                updateAdminApplicationsTable();
                showNotification('Applications list refreshed.', 'info');
            });

            document.getElementById('addUser').addEventListener('click', function() {
                const name = prompt('Enter user full name:');
                const email = prompt('Enter user email:');
                const phone = prompt('Enter user phone:');
                const role = 'user';
                
                if (name && email && phone) {
                    const newUser = {
                        id: users.length + 1,
                        name: name,
                        email: email,
                        phone: phone,
                        password: 'default123',
                        status: 'active',
                        role: role
                    };
                    
                    users.push(newUser);
                    saveData();
                    updateAdminUsersTable();
                    updateAdminStats();
                    showNotification(`User ${name} added successfully.`, 'success');
                }
            });

            // Admin settings form
            document.getElementById('adminSettingsForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                settings.systemName = document.getElementById('systemName').value;
                settings.adminEmail = document.getElementById('adminEmail').value;
                settings.helpline = document.getElementById('helpline').value;
                
                localStorage.setItem('settings', JSON.stringify(settings));
                showNotification('Settings saved successfully.', 'success');
            });

            // Load settings
            document.getElementById('systemName').value = settings.systemName;
            document.getElementById('adminEmail').value = settings.adminEmail;
            document.getElementById('helpline').value = settings.helpline;

            // Chatbot functionality
            document.getElementById('chatbotToggle').addEventListener('click', function() {
                document.getElementById('chatbotWindow').style.display = 'flex';
            });

            document.getElementById('closeChatbot').addEventListener('click', function() {
                document.getElementById('chatbotWindow').style.display = 'none';
            });

            document.getElementById('sendMessage').addEventListener('click', sendMessage);
            document.getElementById('chatbotInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            // Quick reply buttons
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('quick-reply')) {
                    const query = e.target.getAttribute('data-query');
                    document.getElementById('chatbotInput').value = query;
                    sendMessage();
                }
            });

            // Login functionality
            document.getElementById('loginBtn').addEventListener('click', function() {
                if (currentUser) {
                    // Logout
                    currentUser = null;
                    localStorage.removeItem('currentUser');
                    this.innerHTML = '<i class="fas fa-sign-in-alt"></i> Login';
                    updateUIForUser();
                    showNotification('You have been logged out.', 'info');
                } else {
                    // Simple login for demo
                    const email = prompt('Enter your email:');
                    if (email) {
                        let user = users.find(u => u.email === email);
                        if (user) {
                            const password = prompt('Enter your password:');
                            if (password === user.password) {
                                currentUser = user;
                                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                                this.innerHTML = '<i class="fas fa-sign-out-alt"></i> Logout';
                                showNotification(`Welcome back, ${user.name}!`, 'success');
                                updateUIForUser();
                                updateUserApplicationsList();
                            } else {
                                showNotification('Invalid password.', 'error');
                            }
                        } else {
                            // Auto-register if user doesn't exist
                            const name = prompt('New user detected. Enter your full name:');
                            const phone = prompt('Enter your phone number:');
                            const password = prompt('Create a password:');
                            
                            if (name && phone && password) {
                                const newUser = {
                                    id: users.length + 1,
                                    name: name,
                                    email: email,
                                    phone: phone,
                                    password: password,
                                    status: 'active',
                                    role: 'user'
                                };
                                
                                users.push(newUser);
                                currentUser = newUser;
                                saveData();
                                
                                this.innerHTML = '<i class="fas fa-sign-out-alt"></i> Logout';
                                showNotification(`Registration successful! Welcome, ${name}.`, 'success');
                                updateUIForUser();
                            }
                        }
                    }
                }
            });

            // Initialize UI
            updateUIForUser();
            updateAdminStats();
            updateAdminApplicationsTable();
            updateAdminUsersTable();

            // Demo data for testing
            if (serviceApplications.length === 0) {
                // Add some demo applications
                serviceApplications.push({
                    id: applicationIdCounter++,
                    service: "Birth Certificate",
                    applicantName: "John Doe",
                    applicantEmail: "john@example.com",
                    applicantPhone: "1234567890",
                    date: new Date().toISOString().split('T')[0],
                    status: "pending",
                    amount: 50,
                    userId: 2
                });
                saveData();
            }
        });

        function openServiceModal(service) {
            if (!currentUser) {
                showNotification('Please login to apply for services.', 'error');
                document.getElementById('loginBtn').click();
                return;
            }

            const config = serviceConfigs[service];
            if (!config) return;

            document.getElementById('modalServiceTitle').textContent = `Apply for ${service}`;
            const formFields = document.getElementById('formFields');
            formFields.innerHTML = '';

            // Add service information
            const serviceInfo = document.createElement('div');
            serviceInfo.className = 'application-details';
            serviceInfo.innerHTML = `
                <h4><i class="fas fa-info-circle"></i> Service Information</h4>
                <p><strong>Processing Time:</strong> ${config.processingTime}</p>
                <p><strong>Fee:</strong> ₹${config.fee}</p>
                <p><strong>Required Documents:</strong></p>
                <ul class="document-list">
                    ${config.documents.map(doc => `<li><i class="fas fa-check"></i> ${doc}</li>`).join('')}
                </ul>
            `;
            formFields.appendChild(serviceInfo);

            // Add form fields
            config.fields.forEach(field => {
                const formGroup = document.createElement('div');
                formGroup.className = 'form-group';
                
                if (field.type === 'select') {
                    formGroup.innerHTML = `
                        <label for="${field.name}">${field.label}${field.required ? ' *' : ''}</label>
                        <select id="${field.name}" name="${field.name}" ${field.required ? 'required' : ''}>
                            <option value="">Select ${field.label}</option>
                            ${field.options.map(opt => `<option value="${opt}">${opt}</option>`).join('')}
                        </select>
                    `;
                } else if (field.type === 'textarea') {
                    formGroup.innerHTML = `
                        <label for="${field.name}">${field.label}${field.required ? ' *' : ''}</label>
                        <textarea id="${field.name}" name="${field.name}" placeholder="Enter ${field.label.toLowerCase()}" ${field.required ? 'required' : ''}></textarea>
                    `;
                } else {
                    formGroup.innerHTML = `
                        <label for="${field.name}">${field.label}${field.required ? ' *' : ''}</label>
                        <input type="${field.type}" id="${field.name}" name="${field.name}" placeholder="Enter ${field.label.toLowerCase()}" ${field.required ? 'required' : ''}>
                    `;
                }
                
                formFields.appendChild(formGroup);
            });

            // Show/hide payment section based on fee
            const paymentSection = document.getElementById('paymentSection');
            if (config.fee > 0) {
                paymentSection.style.display = 'block';
                document.getElementById('submitApplication').innerHTML = `<i class="fas fa-credit-card"></i> Pay ₹${config.fee} & Submit Application`;
            } else {
                paymentSection.style.display = 'none';
                document.getElementById('submitApplication').innerHTML = `<i class="fas fa-paper-plane"></i> Submit Application`;
            }

            // Clear uploaded files
            document.getElementById('uploadedFiles').innerHTML = '';
            
            document.getElementById('serviceModal').style.display = 'flex';
        }

        function handleFileUpload(files) {
            const uploadedFiles = document.getElementById('uploadedFiles');
            
            Array.from(files).forEach(file => {
                if (file.size > 5 * 1024 * 1024) {
                    showNotification('File size should be less than 5MB', 'error');
                    return;
                }

                const fileElement = document.createElement('div');
                fileElement.className = 'uploaded-file';
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    let preview = '';
                    if (file.type.startsWith('image/')) {
                        preview = `<img src="${e.target.result}" class="file-preview" alt="Preview">`;
                    } else {
                        preview = `<i class="fas fa-file-pdf file-preview" style="font-size: 2rem; color: #e74c3c;"></i>`;
                    }
                    
                    fileElement.innerHTML = `
                        <div class="file-info">
                            ${preview}
                            <div>
                                <div><strong>${file.name}</strong></div>
                                <div class="small">${(file.size / 1024 / 1024).toFixed(2)} MB</div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-danger btn-sm" onclick="this.parentElement.remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    `;
                };
                reader.readAsDataURL(file);
                
                uploadedFiles.appendChild(fileElement);
            });
        }

        function submitServiceApplication() {
            const service = document.getElementById('modalServiceTitle').textContent.replace('Apply for ', '');
            const config = serviceConfigs[service];
            
            // Collect form data
            const formData = {
                service: service,
                applicantName: currentUser.name,
                applicantEmail: currentUser.email,
                applicantPhone: currentUser.phone,
                date: new Date().toISOString().split('T')[0],
                status: 'pending',
                amount: config.fee,
                userId: currentUser.id,
                formData: {}
            };

            // Add form field values
            config.fields.forEach(field => {
                const element = document.getElementById(field.name);
                if (element) {
                    formData.formData[field.name] = element.value;
                }
            });

            const application = {
                id: applicationIdCounter++,
                ...formData
            };

            serviceApplications.push(application);
            saveData();

            document.getElementById('serviceModal').style.display = 'none';
            showNotification(`Application for ${service} submitted successfully! Application ID: ${application.id}`, 'success');
            
            // Reset form
            document.getElementById('serviceApplicationForm').reset();
            document.getElementById('uploadedFiles').innerHTML = '';

            // Update applications list
            updateUserApplicationsList();
            updateAdminApplicationsTable();
            updateAdminStats();
        }

        function updateUserApplicationsList() {
            const applicationsList = document.getElementById('userApplicationsList');
            applicationsList.innerHTML = '';

            if (!currentUser) {
                applicationsList.innerHTML = '<p>Please login to view your applications.</p>';
                return;
            }

            const userApplications = serviceApplications.filter(app => app.userId === currentUser.id);
            
            if (userApplications.length === 0) {
                applicationsList.innerHTML = '<p>No applications found. <a href="#" class="nav-link" data-section="home">Apply for a service</a></p>';
                return;
            }

            userApplications.forEach(app => {
                const appElement = document.createElement('div');
                appElement.className = 'complaint-item';
                appElement.innerHTML = `
                    <div class="complaint-info">
                        <h3>${app.service} (ID: ${app.id})</h3>
                        <p>Applied on: ${app.date}</p>
                        <div class="complaint-meta">
                            <span><i class="fas fa-calendar"></i> ${app.date}</span>
                            <span><i class="fas fa-rupee-sign"></i> ₹${app.amount}</span>
                            <span><i class="fas fa-user"></i> ${app.applicantName}</span>
                        </div>
                    </div>
                    <div class="complaint-status">
                        <span class="status status-${app.status}">${app.status}</span>
                    </div>
                `;
                applicationsList.appendChild(appElement);
            });
        }

        function updateAdminStats() {
            document.getElementById('admin-total-applications').textContent = serviceApplications.length;
            document.getElementById('admin-approved-applications').textContent = serviceApplications.filter(app => app.status === 'approved').length;
            document.getElementById('admin-pending-applications').textContent = serviceApplications.filter(app => app.status === 'pending').length;
            document.getElementById('admin-total-users').textContent = users.filter(u => u.role === 'user').length;
            
            const totalRevenue = serviceApplications.reduce((sum, app) => sum + app.amount, 0);
            document.getElementById('admin-total-revenue').textContent = `₹${totalRevenue}`;
            
            const approvalRate = serviceApplications.length > 0 ? 
                Math.round((serviceApplications.filter(app => app.status === 'approved').length / serviceApplications.length) * 100) : 0;
            document.getElementById('admin-approval-rate').textContent = `${approvalRate}%`;
        }

        function updateAdminApplicationsTable() {
            const tableBody = document.getElementById('adminApplicationsTable');
            tableBody.innerHTML = '';
            
            if (serviceApplications.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="7" style="text-align: center;">No applications found.</td></tr>';
                return;
            }
            
            serviceApplications.forEach(application => {
                const user = users.find(u => u.id === application.userId);
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${application.id}</td>
                    <td>${application.service}</td>
                    <td>${user ? user.name : 'N/A'}</td>
                    <td>${application.date}</td>
                    <td>₹${application.amount}</td>
                    <td><span class="status status-${application.status}">${application.status}</span></td>
                    <td class="action-buttons">
                        <button class="action-btn view-btn" data-id="${application.id}"><i class="fas fa-eye"></i></button>
                        <button class="action-btn resolve-btn" data-id="${application.id}"><i class="fas fa-check"></i></button>
                        <button class="action-btn delete-btn" data-id="${application.id}"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners for action buttons
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    viewApplication(id);
                });
            });
            
            document.querySelectorAll('.resolve-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    approveApplication(id);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    deleteApplication(id);
                });
            });
        }

        function updateAdminUsersTable() {
            const tableBody = document.getElementById('adminUsersTable');
            tableBody.innerHTML = '';
            
            const regularUsers = users.filter(u => u.role === 'user');
            
            regularUsers.forEach(user => {
                const userApplications = serviceApplications.filter(app => app.userId === user.id);
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${user.id}</td>
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td>${user.phone}</td>
                    <td>${userApplications.length}</td>
                    <td><span class="status status-${user.status}">${user.status}</span></td>
                    <td class="action-buttons">
                        <button class="action-btn view-btn" data-id="${user.id}"><i class="fas fa-eye"></i></button>
                        <button class="action-btn delete-btn" data-id="${user.id}"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        function viewApplication(id) {
            const application = serviceApplications.find(app => app.id === id);
            if (application) {
                showNotification(`Viewing application: ${application.service} (ID: ${application.id})`, 'info');
            }
        }

        function approveApplication(id) {
            const application = serviceApplications.find(app => app.id === id);
            if (application) {
                application.status = 'approved';
                saveData();
                updateAdminApplicationsTable();
                updateAdminStats();
                showNotification('Application approved successfully!', 'success');
            }
        }

        function deleteApplication(id) {
            if (confirm('Are you sure you want to delete this application?')) {
                serviceApplications = serviceApplications.filter(app => app.id !== id);
                saveData();
                updateAdminApplicationsTable();
                updateAdminStats();
                updateUserApplicationsList();
                showNotification('Application deleted successfully!', 'success');
            }
        }

        function updateUIForUser() {
            if (currentUser) {
                document.getElementById('loginBtn').innerHTML = '<i class="fas fa-sign-out-alt"></i> Logout';
                
                // Show admin panel only for admin users
                if (currentUser.role === 'admin') {
                    document.querySelector('[data-section="admin"]').style.display = 'list-item';
                } else {
                    document.querySelector('[data-section="admin"]').style.display = 'none';
                }
            } else {
                document.getElementById('loginBtn').innerHTML = '<i class="fas fa-sign-in-alt"></i> Login';
                document.querySelector('[data-section="admin"]').style.display = 'none';
            }
        }

        function sendMessage() {
            const input = document.getElementById('chatbotInput');
            const message = input.value.trim();
            
            if (message) {
                // Add user message
                addMessage(message, 'user');
                input.value = '';
                
                // Generate bot response
                setTimeout(() => {
                    const response = generateBotResponse(message);
                    addMessage(response, 'bot');
                }, 500);
            }
        }

        function addMessage(text, sender) {
            const messagesContainer = document.getElementById('chatbotMessages');
            const messageElement = document.createElement('div');
            messageElement.classList.add('message', `${sender}-message`);
            messageElement.textContent = text;
            messagesContainer.appendChild(messageElement);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function generateBotResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            // Check for specific service document queries
            for (const [key, response] of Object.entries(chatbotKnowledge)) {
                if (lowerMessage.includes(key)) {
                    return response;
                }
            }
            
            return chatbotKnowledge.default;
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        function saveData() {
            localStorage.setItem('serviceApplications', JSON.stringify(serviceApplications));
            localStorage.setItem('users', JSON.stringify(users));
            localStorage.setItem('applicationIdCounter', applicationIdCounter.toString());
            localStorage.setItem('settings', JSON.stringify(settings));
            if (currentUser) {
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
            }
        }
    </script>
</body>
</html>
