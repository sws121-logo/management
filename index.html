<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Municipality Services Portal</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            width:1800px;
            color: var(--dark);
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: var(--primary);
            color: white;
            width:1800px;
            padding: 20px 0;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo i {
            font-size: 2.5rem;
            color: var(--secondary);
        }
        
        .logo h1 {
            font-size: 1.8rem;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 5px;
            transition: background 0.3s;
        }
        
        nav a:hover, nav a.active {
            background: var(--secondary);
        }
        
        .user-actions {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: var(--accent);
            color: white;
        }
        
        .btn-secondary:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background: #27ae60;
            transform: translateY(-2px);
        }
        
        .btn-warning {
            background: var(--warning);
            color: white;
        }
        
        .btn-warning:hover {
            background: #e67e22;
            transform: translateY(-2px);
        }
        
        .section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            display: none;
        }
        
        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-title {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light);
            color: var(--primary);
        }
        
        .service-categories {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .category-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            border-left: 4px solid var(--secondary);
        }
        
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }
        
        .category-icon {
            font-size: 2.5rem;
            color: var(--secondary);
            margin-bottom: 15px;
        }
        
        .application-form {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        input, select, textarea {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .file-upload-container {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-upload-container:hover {
            border-color: var(--secondary);
            background-color: #f8f9fa;
        }
        
        .file-upload-container i {
            font-size: 2rem;
            color: var(--secondary);
            margin-bottom: 10px;
        }
        
        .file-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .file-preview-item {
            position: relative;
            width: 100px;
            height: 100px;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .file-preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .file-preview-item .remove-file {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0,0,0,0.5);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .application-list, .complaint-list {
            display: grid;
            gap: 15px;
        }
        
        .application-item, .complaint-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .application-info h3, .complaint-info h3 {
            margin-bottom: 5px;
        }
        
        .application-meta, .complaint-meta {
            display: flex;
            gap: 15px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-in-progress {
            background: #cce7ff;
            color: #004085;
        }
        
        .status-approved {
            background: #d4edda;
            color: #155724;
        }
        
        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status-resolved {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .status-open {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status-investigation {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-closed {
            background: #d4edda;
            color: #155724;
        }
        
        .chatbot-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .chatbot-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--secondary);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s;
        }
        
        .chatbot-toggle:hover {
            transform: scale(1.1);
        }
        
        .chatbot-window {
            position: absolute;
            bottom: 70px;
            right: 0;
            width: 350px;
            height: 450px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
            display: none;
            flex-direction: column;
            overflow: hidden;
        }
        
        .chatbot-header {
            background: var(--primary);
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chatbot-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .message {
            padding: 10px 15px;
            border-radius: 18px;
            max-width: 80%;
            line-height: 1.4;
        }
        
        .bot-message {
            background: #f1f1f1;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }
        
        .user-message {
            background: var(--secondary);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }
        
        .chatbot-input {
            display: flex;
            padding: 10px;
            border-top: 1px solid #eee;
        }
        
        .chatbot-input input {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 10px 15px;
            margin-right: 10px;
        }
        
        .chatbot-input button {
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
        }
        
        .admin-panel {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
        }
        
        .admin-sidebar {
            background: var(--primary);
            color: white;
            border-radius: 10px;
            padding: 20px;
        }
        
        .admin-sidebar ul {
            list-style: none;
        }
        
        .admin-sidebar li {
            margin-bottom: 10px;
        }
        
        .admin-sidebar a {
            color: white;
            text-decoration: none;
            display: block;
            padding: 10px;
            border-radius: 5px;
            transition: background 0.3s;
        }
        
        .admin-sidebar a:hover, .admin-sidebar a.active {
            background: var(--secondary);
        }
        
        .admin-content {
            background: white;
            border-radius: 10px;
            padding: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background: #f8f9fa;
            font-weight: 600;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        
        .action-btn {
            padding: 5px 10px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .edit-btn {
            background: var(--warning);
            color: white;
        }
        
        .delete-btn {
            background: var(--accent);
            color: white;
        }
        
        .view-btn {
            background: var(--secondary);
            color: white;
        }
        
        .canvas-container {
            width: 100%;
            height: 200px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            border-top: 4px solid var(--secondary);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .stat-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .documentation-info {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .documentation-info h3 {
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .documentation-info ul {
            padding-left: 20px;
        }
        
        .documentation-info li {
            margin-bottom: 8px;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            color: #7f8c8d;
            border-top: 1px solid #eee;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1001;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #7f8c8d;
        }
        
        .login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1002;
            align-items: center;
            justify-content: center;
        }
        
        .login-form {
            background: white;
            border-radius: 10px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .login-form h2 {
            margin-bottom: 20px;
            text-align: center;
            color: var(--primary);
        }
        
        .login-form .form-group {
            margin-bottom: 15px;
        }
        
        .admin-login-btn {
            background: var(--warning);
            color: white;
            margin-top: 10px;
        }
        
        .chatbot-quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .quick-action-btn {
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 5px 10px;
            font-size: 0.7rem;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .quick-action-btn:hover {
            background: #2980b9;
        }
        
        .service-steps {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 10px;
            margin: 10px 0;
        }
        
        .service-steps h4 {
            margin-bottom: 8px;
            color: var(--primary);
        }
        
        .service-steps ol {
            padding-left: 20px;
        }
        
        .service-steps li {
            margin-bottom: 5px;
        }
        
        .document-list {
            background: #fff3cd;
            border-radius: 5px;
            padding: 8px;
            margin: 5px 0;
        }
        
        .document-list ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .apply-now-btn {
            background: var(--success);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            margin-top: 5px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .chart-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .chart-title {
            margin-bottom: 15px;
            color: var(--primary);
            font-weight: 600;
        }
        
        .chart-wrapper {
            position: relative;
            height: 300px;
        }
        
        .admin-page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .back-button {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .complaint-categories {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .complaint-category {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-left: 4px solid var(--accent);
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .complaint-category:hover {
            transform: translateY(-5px);
        }
        
        .complaint-category h3 {
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .complaint-category p {
            color: #7f8c8d;
            margin-bottom: 15px;
        }
        
        .complaint-form-container {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .complaint-details {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid var(--warning);
        }
        
        .complaint-details h4 {
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .complaint-details p {
            margin-bottom: 8px;
        }
        
        .complaint-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        @media (max-width: 1024px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            nav ul {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .admin-panel {
                grid-template-columns: 1fr;
            }
            
            .admin-sidebar {
                order: 2;
            }
            
            .admin-content {
                order: 1;
            }
            
            .chart-row {
                grid-template-columns: 1fr;
            }
            
            .complaint-categories {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            nav ul {
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }
            
            .user-actions {
                width: 100%;
                justify-content: center;
            }
            
            .service-categories {
                grid-template-columns: 1fr;
            }
            
            .chatbot-window {
                width: 300px;
                right: -20px;
            }
            
            .modal-content {
                width: 95%;
            }
            
            .complaint-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-city"></i>
                    <h1>Municipality Services Portal</h1>
                </div>
                <nav>
                    <ul>
                        <li><a href="#" class="nav-link active" data-section="home">Home</a></li>
                        <li><a href="#" class="nav-link" data-section="services">Services</a></li>
                        <li><a href="#" class="nav-link" data-section="complaints">File Complaint</a></li>
                        <li><a href="#" class="nav-link" data-section="my-applications">My Applications</a></li>
                        <li><a href="#" class="nav-link" data-section="my-complaints">My Complaints</a></li>
                        <li><a href="#" class="nav-link" data-section="documentation">Documentation</a></li>
                        <li><a href="#" class="nav-link" data-section="admin">Admin Panel</a></li>
                    </ul>
                </nav>
                <div class="user-actions">
                    <button class="btn btn-primary" id="loginBtn">Login</button>
                    <button class="btn btn-secondary" id="registerBtn">Register</button>
                </div>
            </div>
        </header>

        <!-- Home Section -->
        <section id="home" class="section active">
            <h2 class="section-title">Welcome to Municipality Services Portal</h2>
            <div class="canvas-container" id="animation-container"></div>
            <div class="stats-cards">
                <div class="stat-card">
                    <i class="fas fa-file-alt stat-icon"></i>
                    <div class="stat-number" id="total-applications">0</div>
                    <div class="stat-label">Total Applications</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-check-circle stat-icon"></i>
                    <div class="stat-number" id="approved-applications">0</div>
                    <div class="stat-label">Approved Applications</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-users stat-icon"></i>
                    <div class="stat-number" id="active-users">0</div>
                    <div class="stat-label">Active Users</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-exclamation-triangle stat-icon"></i>
                    <div class="stat-number" id="total-complaints">0</div>
                    <div class="stat-label">Total Complaints</div>
                </div>
            </div>
            <div class="service-categories">
                <div class="category-card" data-service="license">
                    <i class="fas fa-id-card category-icon"></i>
                    <h3>License Application</h3>
                    <p>Apply for various licenses including business, trade, and professional licenses</p>
                </div>
                <div class="category-card" data-service="license-renewal">
                    <i class="fas fa-sync-alt category-icon"></i>
                    <h3>License Renewal</h3>
                    <p>Renew your existing licenses with updated information</p>
                </div>
                <div class="category-card" data-service="property-tax">
                    <i class="fas fa-home category-icon"></i>
                    <h3>Property Tax</h3>
                    <p>Pay property tax and related services</p>
                </div>
                <div class="category-card" data-service="vehicle-registration">
                    <i class="fas fa-car category-icon"></i>
                    <h3>Vehicle Registration</h3>
                    <p>Vehicle registration and related services</p>
                </div>
                <div class="category-card" data-service="trade-license">
                    <i class="fas fa-store category-icon"></i>
                    <h3>Trade License</h3>
                    <p>Apply for trade licenses for your business</p>
                </div>
                <div class="category-card" data-service="building-permit">
                    <i class="fas fa-hard-hat category-icon"></i>
                    <h3>Building Permit</h3>
                    <p>Apply for building permits and approvals</p>
                </div>
                <div class="category-card" data-service="birth-certificate">
                    <i class="fas fa-baby category-icon"></i>
                    <h3>Birth Certificate</h3>
                    <p>Apply for birth certificates</p>
                </div>
                <div class="category-card" data-service="death-certificate">
                    <i class="fas fa-cross category-icon"></i>
                    <h3>Death Certificate</h3>
                    <p>Apply for death certificates</p>
                </div>
            </div>
        </section>

        <!-- Services Section -->
        <section id="services" class="section">
            <h2 class="section-title">Municipality Services</h2>
            <div class="service-categories">
                <div class="category-card" data-service="license">
                    <i class="fas fa-id-card category-icon"></i>
                    <h3>License Application</h3>
                    <p>Apply for various licenses including business, trade, and professional licenses</p>
                </div>
                <div class="category-card" data-service="license-renewal">
                    <i class="fas fa-sync-alt category-icon"></i>
                    <h3>License Renewal</h3>
                    <p>Renew your existing licenses with updated information</p>
                </div>
                <div class="category-card" data-service="property-tax">
                    <i class="fas fa-home category-icon"></i>
                    <h3>Property Tax</h3>
                    <p>Pay property tax and related services</p>
                </div>
                <div class="category-card" data-service="vehicle-registration">
                    <i class="fas fa-car category-icon"></i>
                    <h3>Vehicle Registration</h3>
                    <p>Vehicle registration and related services</p>
                </div>
                <div class="category-card" data-service="trade-license">
                    <i class="fas fa-store category-icon"></i>
                    <h3>Trade License</h3>
                    <p>Apply for trade licenses for your business</p>
                </div>
                <div class="category-card" data-service="building-permit">
                    <i class="fas fa-hard-hat category-icon"></i>
                    <h3>Building Permit</h3>
                    <p>Apply for building permits and approvals</p>
                </div>
                <div class="category-card" data-service="birth-certificate">
                    <i class="fas fa-baby category-icon"></i>
                    <h3>Birth Certificate</h3>
                    <p>Apply for birth certificates</p>
                </div>
                <div class="category-card" data-service="death-certificate">
                    <i class="fas fa-cross category-icon"></i>
                    <h3>Death Certificate</h3>
                    <p>Apply for death certificates</p>
                </div>
            </div>
        </section>

        <!-- File Complaint Section -->
        <section id="complaints" class="section">
            <h2 class="section-title">File a Complaint</h2>
            <p>Report issues and problems in your area to the municipality</p>
            
            <div class="complaint-categories">
                <div class="complaint-category" data-complaint-type="sanitation">
                    <h3><i class="fas fa-trash"></i> Sanitation Issues</h3>
                    <p>Report garbage collection problems, overflowing bins, or unclean public areas</p>
                </div>
                <div class="complaint-category" data-complaint-type="roads">
                    <h3><i class="fas fa-road"></i> Road & Infrastructure</h3>
                    <p>Report potholes, damaged roads, street light issues, or traffic problems</p>
                </div>
                <div class="complaint-category" data-complaint-type="water">
                    <h3><i class="fas fa-tint"></i> Water Supply</h3>
                    <p>Report water supply issues, leakages, or water quality problems</p>
                </div>
                <div class="complaint-category" data-complaint-type="electricity">
                    <h3><i class="fas fa-bolt"></i> Electricity Issues</h3>
                    <p>Report power outages, electrical hazards, or street light malfunctions</p>
                </div>
                <div class="complaint-category" data-complaint-type="parks">
                    <h3><i class="fas fa-tree"></i> Parks & Public Spaces</h3>
                    <p>Report issues with public parks, playgrounds, or recreational facilities</p>
                </div>
                <div class="complaint-category" data-complaint-type="noise">
                    <h3><i class="fas fa-volume-up"></i> Noise Pollution</h3>
                    <p>Report excessive noise from construction, events, or commercial establishments</p>
                </div>
            </div>
            
            <div class="complaint-form-container" id="complaintFormContainer" style="display: none;">
                <h3 id="complaintFormTitle">File Complaint</h3>
                <form id="complaintForm" class="application-form">
                    <div class="form-group">
                        <label for="complaintTitle">Complaint Title</label>
                        <input type="text" id="complaintTitle" placeholder="Brief description of the issue" required>
                    </div>
                    <div class="form-group">
                        <label for="complaintDescription">Detailed Description</label>
                        <textarea id="complaintDescription" placeholder="Provide detailed information about the issue, location, and impact" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="complaintLocation">Location</label>
                        <input type="text" id="complaintLocation" placeholder="Exact location or address of the issue" required>
                    </div>
                    <div class="form-group">
                        <label for="complaintPriority">Priority Level</label>
                        <select id="complaintPriority" required>
                            <option value="">Select Priority</option>
                            <option value="low">Low - Minor inconvenience</option>
                            <option value="medium">Medium - Needs attention</option>
                            <option value="high">High - Urgent attention required</option>
                            <option value="critical">Critical - Safety hazard</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Upload Supporting Documents/Photos</label>
                        <div class="file-upload-container" id="complaintPhotoUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload photos or documents</p>
                            <input type="file" id="complaintPhoto" accept="image/*" style="display: none;" multiple>
                        </div>
                        <div class="file-preview" id="complaintFilePreview"></div>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit Complaint</button>
                </form>
            </div>
        </section>

        <!-- Service Application Forms -->
        <section id="service-forms" class="section">
            <!-- Forms will be dynamically loaded here based on service selection -->
        </section>

        <!-- My Applications Section -->
        <section id="my-applications" class="section">
            <h2 class="section-title">My Applications</h2>
            <div class="application-list" id="applicationList">
                <!-- Application items will be dynamically added here -->
            </div>
        </section>

        <!-- My Complaints Section -->
        <section id="my-complaints" class="section">
            <h2 class="section-title">My Complaints</h2>
            <div class="complaint-list" id="complaintList">
                <!-- Complaint items will be dynamically added here -->
            </div>
        </section>

        <!-- Documentation Section -->
        <section id="documentation" class="section">
            <h2 class="section-title">Documentation Requirements</h2>
            <div class="documentation-info">
                <h3>General Documents Required for All Services</h3>
                <ul>
                    <li>Proof of Identity (Aadhar Card, Passport, Voter ID, etc.)</li>
                    <li>Proof of Address (Aadhar Card, Utility Bill, Rental Agreement, etc.)</li>
                    <li>Passport-sized Photographs</li>
                    <li>Any existing relevant certificates or licenses</li>
                </ul>
            </div>
            <div class="service-categories">
                <div class="category-card" data-doc="license">
                    <i class="fas fa-id-card category-icon"></i>
                    <h3>License Application</h3>
                    <p>Documentation requirements for license applications</p>
                    <button class="apply-now-btn" data-service="license">Apply Now</button>
                </div>
                <div class="category-card" data-doc="property-tax">
                    <i class="fas fa-home category-icon"></i>
                    <h3>Property Tax</h3>
                    <p>Documentation requirements for property tax</p>
                    <button class="apply-now-btn" data-service="property-tax">Apply Now</button>
                </div>
                <div class="category-card" data-doc="vehicle-registration">
                    <i class="fas fa-car category-icon"></i>
                    <h3>Vehicle Registration</h3>
                    <p>Documentation requirements for vehicle registration</p>
                    <button class="apply-now-btn" data-service="vehicle-registration">Apply Now</button>
                </div>
                <div class="category-card" data-doc="trade-license">
                    <i class="fas fa-store category-icon"></i>
                    <h3>Trade License</h3>
                    <p>Documentation requirements for trade license</p>
                    <button class="apply-now-btn" data-service="trade-license">Apply Now</button>
                </div>
                <div class="category-card" data-doc="building-permit">
                    <i class="fas fa-hard-hat category-icon"></i>
                    <h3>Building Permit</h3>
                    <p>Documentation requirements for building permit</p>
                    <button class="apply-now-btn" data-service="building-permit">Apply Now</button>
                </div>
                <div class="category-card" data-doc="birth-certificate">
                    <i class="fas fa-baby category-icon"></i>
                    <h3>Birth Certificate</h3>
                    <p>Documentation requirements for birth certificate</p>
                    <button class="apply-now-btn" data-service="birth-certificate">Apply Now</button>
                </div>
                <div class="category-card" data-doc="death-certificate">
                    <i class="fas fa-cross category-icon"></i>
                    <h3>Death Certificate</h3>
                    <p>Documentation requirements for death certificate</p>
                    <button class="apply-now-btn" data-service="death-certificate">Apply Now</button>
                </div>
            </div>
        </section>

        <!-- Documentation Details Section -->
        <section id="documentation-details" class="section">
            <!-- Documentation details will be dynamically loaded here -->
        </section>

        <!-- Admin Panel Section -->
        <section id="admin" class="section">
            <h2 class="section-title">Admin Panel</h2>
            <div class="admin-panel">
                <div class="admin-sidebar">
                    <ul>
                        <li><a href="#" class="admin-nav active" data-tab="dashboard">Dashboard</a></li>
                        <li><a href="#" class="admin-nav" data-tab="applications-management">Applications Management</a></li>
                        <li><a href="#" class="admin-nav" data-tab="complaints-management">Complaints Management</a></li>
                        <li><a href="#" class="admin-nav" data-tab="user-management">User Management</a></li>
                        <li><a href="#" class="admin-nav" data-tab="reports">Reports & Analytics</a></li>
                        <li><a href="#" class="admin-nav" data-tab="settings">Settings</a></li>
                    </ul>
                </div>
                <div class="admin-content">
                    <div id="admin-dashboard" class="admin-tab active">
                        <h3>Admin Dashboard</h3>
                        <div class="stats-cards">
                            <div class="stat-card">
                                <i class="fas fa-file-alt stat-icon"></i>
                                <div class="stat-number" id="admin-total-applications">0</div>
                                <div class="stat-label">Total Applications</div>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-check-circle stat-icon"></i>
                                <div class="stat-number" id="admin-approved-applications">0</div>
                                <div class="stat-label">Approved Applications</div>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-exclamation-triangle stat-icon"></i>
                                <div class="stat-number" id="admin-total-complaints">0</div>
                                <div class="stat-label">Total Complaints</div>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-users stat-icon"></i>
                                <div class="stat-number" id="admin-total-users">0</div>
                                <div class="stat-label">Registered Users</div>
                            </div>
                        </div>
                        <div class="chart-row">
                            <div class="chart-container">
                                <h4 class="chart-title">Applications by Status</h4>
                                <div class="chart-wrapper">
                                    <canvas id="applicationsByStatusChart"></canvas>
                                </div>
                            </div>
                            <div class="chart-container">
                                <h4 class="chart-title">Complaints by Type</h4>
                                <div class="chart-wrapper">
                                    <canvas id="complaintsByTypeChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <h4 class="chart-title">Applications Over Time</h4>
                            <div class="chart-wrapper">
                                <canvas id="applicationsOverTimeChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div id="admin-applications-management" class="admin-tab">
                        <h3>Applications Management</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>Application ID</th>
                                    <th>User</th>
                                    <th>Service Type</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminApplicationsTable">
                                <!-- Applications will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                    <div id="admin-complaints-management" class="admin-tab">
                        <h3>Complaints Management</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>Complaint ID</th>
                                    <th>User</th>
                                    <th>Type</th>
                                    <th>Title</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminComplaintsTable">
                                <!-- Complaints will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                    <div id="admin-user-management" class="admin-tab">
                        <h3>User Management</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>User ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Applications</th>
                                    <th>Complaints</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminUsersTable">
                                <!-- Users will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                    <div id="admin-reports" class="admin-tab">
                        <h3>Reports & Analytics</h3>
                        <div class="chart-row">
                            <div class="chart-container">
                                <h4 class="chart-title">User Registration Trends</h4>
                                <div class="chart-wrapper">
                                    <canvas id="userRegistrationChart"></canvas>
                                </div>
                            </div>
                            <div class="chart-container">
                                <h4 class="chart-title">Processing Time Analysis</h4>
                                <div class="chart-wrapper">
                                    <canvas id="processingTimeChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <h4 class="chart-title">Service Performance Metrics</h4>
                            <div class="chart-wrapper">
                                <canvas id="servicePerformanceChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-container">
                            <h4 class="chart-title">Complaint Resolution Time</h4>
                            <div class="chart-wrapper">
                                <canvas id="complaintResolutionChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div id="admin-settings" class="admin-tab">
                        <h3>Settings</h3>
                        <div class="application-form">
                            <div class="form-group">
                                <label for="systemName">System Name</label>
                                <input type="text" id="systemName" value="Municipality Services Portal">
                            </div>
                            <div class="form-group">
                                <label for="adminEmail">Admin Email</label>
                                <input type="email" id="adminEmail" value="admin@municipality.gov">
                            </div>
                            <div class="form-group">
                                <label for="notificationSettings">Notification Settings</label>
                                <select id="notificationSettings">
                                    <option value="all">All Notifications</option>
                                    <option value="important">Important Only</option>
                                    <option value="none">No Notifications</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="autoApproval">Auto-Approval Threshold</label>
                                <input type="number" id="autoApproval" value="7" min="1" max="30">
                                <small>Days after which applications are auto-approved if no action taken</small>
                            </div>
                            <button class="btn btn-primary">Save Settings</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Chatbot -->
        <div class="chatbot-container">
            <div class="chatbot-toggle" id="chatbotToggle">
                <i class="fas fa-comments"></i>
            </div>
            <div class="chatbot-window" id="chatbotWindow">
                <div class="chatbot-header">
                    <h3>Municipality Assistant</h3>
                    <button id="closeChatbot"><i class="fas fa-times"></i></button>
                </div>
                <div class="chatbot-messages" id="chatbotMessages">
                    <div class="message bot-message">
                        Hello! I'm your municipality assistant. How can I help you today?
                    </div>
                </div>
                <div class="chatbot-input">
                    <input type="text" id="chatbotInput" placeholder="Type your message...">
                    <button id="sendMessage"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>

        <!-- Application Details Modal -->
        <div class="modal" id="applicationModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalTitle">Application Details</h3>
                    <button class="close-modal" id="closeModal">&times;</button>
                </div>
                <div id="modalContent">
                    <!-- Modal content will be dynamically loaded here -->
                </div>
            </div>
        </div>

        <!-- Complaint Details Modal -->
        <div class="modal" id="complaintModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="complaintModalTitle">Complaint Details</h3>
                    <button class="close-modal" id="closeComplaintModal">&times;</button>
                </div>
                <div id="complaintModalContent">
                    <!-- Complaint modal content will be dynamically loaded here -->
                </div>
            </div>
        </div>

        <!-- Login Modal -->
        <div class="login-modal" id="loginModal">
            <div class="login-form">
                <h2>User Login</h2>
                <form id="userLoginForm">
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Login</button>
                </form>
                <button class="btn admin-login-btn" id="adminLoginBtn" style="width: 100%; margin-top: 10px;">Admin Login</button>
                <button class="btn btn-secondary" id="closeLoginModal" style="width: 100%; margin-top: 10px;">Cancel</button>
            </div>
        </div>

        <!-- Admin Login Modal -->
        <div class="login-modal" id="adminLoginModal">
            <div class="login-form">
                <h2>Admin Login</h2>
                <form id="adminLoginForm">
                    <div class="form-group">
                        <label for="adminUsername">Username</label>
                        <input type="text" id="adminUsername" placeholder="Enter admin username" required>
                    </div>
                    <div class="form-group">
                        <label for="adminPassword">Password</label>
                        <input type="password" id="adminPassword" placeholder="Enter admin password" required>
                    </div>
                    <button type="submit" class="btn btn-warning" style="width: 100%;">Login as Admin</button>
                </form>
                <button class="btn btn-secondary" id="closeAdminLoginModal" style="width: 100%; margin-top: 10px;">Cancel</button>
            </div>
        </div>

        <footer>
            <p>&copy; 2023 Municipality Services Portal. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Sample data for the application
        let applications = JSON.parse(localStorage.getItem('applications')) || [];
        let complaints = JSON.parse(localStorage.getItem('complaints')) || [];
        let users = JSON.parse(localStorage.getItem('users')) || [
            { id: 1, name: "John Doe", email: "john@example.com", phone: "1234567890", status: "active", applications: 2, complaints: 1, registrationDate: "2023-01-15" },
            { id: 2, name: "Jane Smith", email: "jane@example.com", phone: "0987654321", status: "active", applications: 1, complaints: 0, registrationDate: "2023-02-20" },
            { id: 3, name: "Robert Johnson", email: "robert@example.com", phone: "1122334455", status: "active", applications: 3, complaints: 2, registrationDate: "2023-03-10" },
            { id: 4, name: "Emily Davis", email: "emily@example.com", phone: "5566778899", status: "inactive", applications: 0, complaints: 1, registrationDate: "2023-04-05" }
        ];
        let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
        let isAdmin = JSON.parse(localStorage.getItem('isAdmin')) || false;
        let applicationIdCounter = parseInt(localStorage.getItem('applicationIdCounter')) || 1001;
        let complaintIdCounter = parseInt(localStorage.getItem('complaintIdCounter')) || 2001;
        let userIdCounter = parseInt(localStorage.getItem('userIdCounter')) || 5;

        // Admin credentials
        const adminCredentials = {
            username: "admin",
            password: "admin123"
        };

        // Complaint types and categories
        const complaintCategories = {
            sanitation: {
                title: "Sanitation Issues",
                icon: "fas fa-trash",
                description: "Garbage collection problems, overflowing bins, or unclean public areas"
            },
            roads: {
                title: "Road & Infrastructure",
                icon: "fas fa-road",
                description: "Potholes, damaged roads, street light issues, or traffic problems"
            },
            water: {
                title: "Water Supply",
                icon: "fas fa-tint",
                description: "Water supply issues, leakages, or water quality problems"
            },
            electricity: {
                title: "Electricity Issues",
                icon: "fas fa-bolt",
                description: "Power outages, electrical hazards, or street light malfunctions"
            },
            parks: {
                title: "Parks & Public Spaces",
                icon: "fas fa-tree",
                description: "Issues with public parks, playgrounds, or recreational facilities"
            },
            noise: {
                title: "Noise Pollution",
                icon: "fas fa-volume-up",
                description: "Excessive noise from construction, events, or commercial establishments"
            }
        };

        // Service-specific documentation requirements
        const documentationRequirements = {
            license: {
                title: "License Application Documentation",
                requirements: [
                    "Completed application form",
                    "Proof of identity (Aadhar Card, Passport, etc.)",
                    "Proof of address (Aadhar Card, Utility Bill, etc.)",
                    "Passport-sized photographs (2 copies)",
                    "Educational qualification certificates (if applicable)",
                    "Experience certificates (if applicable)",
                    "No objection certificate from property owner (if applicable)",
                    "Payment receipt of application fee"
                ]
            },
            "license-renewal": {
                title: "License Renewal Documentation",
                requirements: [
                    "Completed renewal application form",
                    "Original license certificate",
                    "Proof of identity (Aadhar Card, Passport, etc.)",
                    "Proof of address (Aadhar Card, Utility Bill, etc.)",
                    "Passport-sized photographs (2 copies)",
                    "Payment receipt of renewal fee"
                ]
            },
            "property-tax": {
                title: "Property Tax Documentation",
                requirements: [
                    "Property tax payment form",
                    "Property ownership documents",
                    "Proof of identity (Aadhar Card, Passport, etc.)",
                    "Previous tax payment receipts (if any)",
                    "Property measurement details",
                    "Building plan approval (if applicable)"
                ]
            },
            "vehicle-registration": {
                title: "Vehicle Registration Documentation",
                requirements: [
                    "Vehicle registration application form",
                    "Proof of identity (Aadhar Card, Passport, etc.)",
                    "Proof of address (Aadhar Card, Utility Bill, etc.)",
                    "Vehicle purchase invoice",
                    "Vehicle insurance certificate",
                    "Pollution under control certificate",
                    "Road tax payment receipt",
                    "Vehicle fitness certificate (for commercial vehicles)"
                ]
            },
            "trade-license": {
                title: "Trade License Documentation",
                requirements: [
                    "Trade license application form",
                    "Proof of identity (Aadhar Card, Passport, etc.)",
                    "Proof of address (Aadhar Card, Utility Bill, etc.)",
                    "Business address proof",
                    "Partnership deed (if applicable)",
                    "Company incorporation certificate (if applicable)",
                    "No objection certificate from property owner",
                    "Site plan of business premises"
                ]
            },
            "building-permit": {
                title: "Building Permit Documentation",
                requirements: [
                    "Building permit application form",
                    "Proof of identity (Aadhar Card, Passport, etc.)",
                    "Proof of address (Aadhar Card, Utility Bill, etc.)",
                    "Land ownership documents",
                    "Site plan and building drawings",
                    "Structural stability certificate",
                    "No objection certificate from neighbors (if required)",
                    "Environmental clearance (if applicable)"
                ]
            },
            "birth-certificate": {
                title: "Birth Certificate Documentation",
                requirements: [
                    "Birth certificate application form",
                    "Proof of identity of parents (Aadhar Card, Passport, etc.)",
                    "Proof of address of parents (Aadhar Card, Utility Bill, etc.)",
                    "Hospital birth record or delivery slip",
                    "Marriage certificate of parents",
                    "Affidavit for delayed registration (if applicable)"
                ]
            },
            "death-certificate": {
                title: "Death Certificate Documentation",
                requirements: [
                    "Death certificate application form",
                    "Proof of identity of applicant (Aadhar Card, Passport, etc.)",
                    "Proof of address of applicant (Aadhar Card, Utility Bill, etc.)",
                    "Hospital death record or medical certificate",
                    "Proof of identity of deceased (Aadhar Card, Passport, etc.)",
                    "Affidavit for delayed registration (if applicable)"
                ]
            }
        };

        // Service-specific forms
        const serviceForms = {
            license: `
                <h2 class="section-title">License Application</h2>
                <form id="licenseForm" class="application-form">
                    <div class="form-group">
                        <label for="licenseType">License Type</label>
                        <select id="licenseType" required>
                            <option value="">Select License Type</option>
                            <option value="business">Business License</option>
                            <option value="professional">Professional License</option>
                            <option value="trade">Trade License</option>
                            <option value="vehicle">Vehicle License</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="fullName">Full Name</label>
                        <input type="text" id="fullName" placeholder="Enter your full name" required>
                    </div>
                    <div class="form-group">
                        <label for="dob">Date of Birth</label>
                        <input type="date" id="dob" required>
                    </div>
                    <div class="form-group">
                        <label for="address">Address</label>
                        <textarea id="address" placeholder="Enter your complete address" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="tel" id="phone" placeholder="Enter your phone number" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" placeholder="Enter your email address" required>
                    </div>
                    <div class="form-group">
                        <label>Upload Required Documents</label>
                        <div class="file-upload-container" id="aadharFrontUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Aadhar Card (Front)</p>
                            <input type="file" id="aadharFront" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-upload-container" id="aadharBackUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Aadhar Card (Back)</p>
                            <input type="file" id="aadharBack" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-upload-container" id="photoUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Passport Photo</p>
                            <input type="file" id="photo" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-preview" id="filePreview"></div>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit Application</button>
                </form>
            `,
            "license-renewal": `
                <h2 class="section-title">License Renewal</h2>
                <form id="licenseRenewalForm" class="application-form">
                    <div class="form-group">
                        <label for="existingLicenseNumber">Existing License Number</label>
                        <input type="text" id="existingLicenseNumber" placeholder="Enter your existing license number" required>
                    </div>
                    <div class="form-group">
                        <label for="renewalType">Renewal Type</label>
                        <select id="renewalType" required>
                            <option value="">Select Renewal Type</option>
                            <option value="annual">Annual Renewal</option>
                            <option value="biannual">Biannual Renewal</option>
                            <option value="lifetime">Lifetime Renewal</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="fullName">Full Name</label>
                        <input type="text" id="fullName" placeholder="Enter your full name" required>
                    </div>
                    <div class="form-group">
                        <label for="address">Address</label>
                        <textarea id="address" placeholder="Enter your complete address" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="tel" id="phone" placeholder="Enter your phone number" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" placeholder="Enter your email address" required>
                    </div>
                    <div class="form-group">
                        <label>Upload Required Documents</label>
                        <div class="file-upload-container" id="existingLicenseUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Existing License</p>
                            <input type="file" id="existingLicense" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-upload-container" id="aadharFrontUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Aadhar Card (Front)</p>
                            <input type="file" id="aadharFront" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-upload-container" id="aadharBackUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Aadhar Card (Back)</p>
                            <input type="file" id="aadharBack" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-preview" id="filePreview"></div>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit Renewal Application</button>
                </form>
            `,
            "property-tax": `
                <h2 class="section-title">Property Tax Payment</h2>
                <form id="propertyTaxForm" class="application-form">
                    <div class="form-group">
                        <label for="propertyId">Property ID</label>
                        <input type="text" id="propertyId" placeholder="Enter your property ID" required>
                    </div>
                    <div class="form-group">
                        <label for="propertyOwner">Property Owner Name</label>
                        <input type="text" id="propertyOwner" placeholder="Enter property owner name" required>
                    </div>
                    <div class="form-group">
                        <label for="propertyAddress">Property Address</label>
                        <textarea id="propertyAddress" placeholder="Enter property address" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="taxAmount">Tax Amount Due</label>
                        <input type="number" id="taxAmount" placeholder="Enter tax amount" required>
                    </div>
                    <div class="form-group">
                        <label for="paymentMethod">Payment Method</label>
                        <select id="paymentMethod" required>
                            <option value="">Select Payment Method</option>
                            <option value="credit">Credit Card</option>
                            <option value="debit">Debit Card</option>
                            <option value="upi">UPI</option>
                            <option value="netbanking">Net Banking</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Upload Property Documents</label>
                        <div class="file-upload-container" id="propertyDocUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Property Documents</p>
                            <input type="file" id="propertyDoc" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-preview" id="filePreview"></div>
                    </div>
                    <button type="submit" class="btn btn-primary">Pay Property Tax</button>
                </form>
            `,
            "vehicle-registration": `
                <h2 class="section-title">Vehicle Registration</h2>
                <form id="vehicleRegistrationForm" class="application-form">
                    <div class="form-group">
                        <label for="vehicleType">Vehicle Type</label>
                        <select id="vehicleType" required>
                            <option value="">Select Vehicle Type</option>
                            <option value="two-wheeler">Two Wheeler</option>
                            <option value="four-wheeler">Four Wheeler</option>
                            <option value="commercial">Commercial Vehicle</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="vehicleModel">Vehicle Model</label>
                        <input type="text" id="vehicleModel" placeholder="Enter vehicle model" required>
                    </div>
                    <div class="form-group">
                        <label for="manufactureYear">Manufacture Year</label>
                        <input type="number" id="manufactureYear" placeholder="Enter manufacture year" required>
                    </div>
                    <div class="form-group">
                        <label for="chassisNumber">Chassis Number</label>
                        <input type="text" id="chassisNumber" placeholder="Enter chassis number" required>
                    </div>
                    <div class="form-group">
                        <label for="engineNumber">Engine Number</label>
                        <input type="text" id="engineNumber" placeholder="Enter engine number" required>
                    </div>
                    <div class="form-group">
                        <label for="ownerName">Owner Name</label>
                        <input type="text" id="ownerName" placeholder="Enter owner name" required>
                    </div>
                    <div class="form-group">
                        <label for="ownerAddress">Owner Address</label>
                        <textarea id="ownerAddress" placeholder="Enter owner address" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Upload Required Documents</label>
                        <div class="file-upload-container" id="vehicleInvoiceUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Vehicle Invoice</p>
                            <input type="file" id="vehicleInvoice" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-upload-container" id="insuranceUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Insurance Certificate</p>
                            <input type="file" id="insurance" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-upload-container" id="aadharUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Aadhar Card</p>
                            <input type="file" id="aadhar" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-preview" id="filePreview"></div>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit Registration</button>
                </form>
            `,
            "trade-license": `
                <h2 class="section-title">Trade License Application</h2>
                <form id="tradeLicenseForm" class="application-form">
                    <div class="form-group">
                        <label for="businessName">Business Name</label>
                        <input type="text" id="businessName" placeholder="Enter business name" required>
                    </div>
                    <div class="form-group">
                        <label for="businessType">Business Type</label>
                        <select id="businessType" required>
                            <option value="">Select Business Type</option>
                            <option value="retail">Retail</option>
                            <option value="wholesale">Wholesale</option>
                            <option value="service">Service</option>
                            <option value="manufacturing">Manufacturing</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="businessAddress">Business Address</label>
                        <textarea id="businessAddress" placeholder="Enter business address" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="ownerName">Owner Name</label>
                        <input type="text" id="ownerName" placeholder="Enter owner name" required>
                    </div>
                    <div class="form-group">
                        <label for="ownerPhone">Owner Phone</label>
                        <input type="tel" id="ownerPhone" placeholder="Enter owner phone" required>
                    </div>
                    <div class="form-group">
                        <label for="ownerEmail">Owner Email</label>
                        <input type="email" id="ownerEmail" placeholder="Enter owner email" required>
                    </div>
                    <div class="form-group">
                        <label>Upload Required Documents</label>
                        <div class="file-upload-container" id="businessProofUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Business Proof</p>
                            <input type="file" id="businessProof" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-upload-container" id="aadharUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Aadhar Card</p>
                            <input type="file" id="aadhar" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-upload-container" id="nocUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload No Objection Certificate</p>
                            <input type="file" id="noc" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-preview" id="filePreview"></div>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit Application</button>
                </form>
            `,
            "building-permit": `
                <h2 class="section-title">Building Permit Application</h2>
                <form id="buildingPermitForm" class="application-form">
                    <div class="form-group">
                        <label for="propertyLocation">Property Location</label>
                        <input type="text" id="propertyLocation" placeholder="Enter property location" required>
                    </div>
                    <div class="form-group">
                        <label for="buildingType">Building Type</label>
                        <select id="buildingType" required>
                            <option value="">Select Building Type</option>
                            <option value="residential">Residential</option>
                            <option value="commercial">Commercial</option>
                            <option value="industrial">Industrial</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="buildingArea">Building Area (sq ft)</label>
                        <input type="number" id="buildingArea" placeholder="Enter building area" required>
                    </div>
                    <div class="form-group">
                        <label for="numberOfFloors">Number of Floors</label>
                        <input type="number" id="numberOfFloors" placeholder="Enter number of floors" required>
                    </div>
                    <div class="form-group">
                        <label for="ownerName">Owner Name</label>
                        <input type="text" id="ownerName" placeholder="Enter owner name" required>
                    </div>
                    <div class="form-group">
                        <label for="architectName">Architect Name</label>
                        <input type="text" id="architectName" placeholder="Enter architect name" required>
                    </div>
                    <div class="form-group">
                        <label>Upload Required Documents</label>
                        <div class="file-upload-container" id="sitePlanUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Site Plan</p>
                            <input type="file" id="sitePlan" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-upload-container" id="buildingDrawingUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Building Drawings</p>
                            <input type="file" id="buildingDrawing" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-upload-container" id="ownershipDocUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Ownership Documents</p>
                            <input type="file" id="ownershipDoc" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-preview" id="filePreview"></div>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit Application</button>
                </form>
            `,
            "birth-certificate": `
                <h2 class="section-title">Birth Certificate Application</h2>
                <form id="birthCertificateForm" class="application-form">
                    <div class="form-group">
                        <label for="childName">Child's Name</label>
                        <input type="text" id="childName" placeholder="Enter child's name" required>
                    </div>
                    <div class="form-group">
                        <label for="gender">Gender</label>
                        <select id="gender" required>
                            <option value="">Select Gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dateOfBirth">Date of Birth</label>
                        <input type="date" id="dateOfBirth" required>
                    </div>
                    <div class="form-group">
                        <label for="placeOfBirth">Place of Birth</label>
                        <input type="text" id="placeOfBirth" placeholder="Enter place of birth" required>
                    </div>
                    <div class="form-group">
                        <label for="fatherName">Father's Name</label>
                        <input type="text" id="fatherName" placeholder="Enter father's name" required>
                    </div>
                    <div class="form-group">
                        <label for="motherName">Mother's Name</label>
                        <input type="text" id="motherName" placeholder="Enter mother's name" required>
                    </div>
                    <div class="form-group">
                        <label>Upload Required Documents</label>
                        <div class="file-upload-container" id="birthRecordUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Hospital Birth Record</p>
                            <input type="file" id="birthRecord" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-upload-container" id="parentIdUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Parent's ID Proof</p>
                            <input type="file" id="parentId" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-upload-container" id="marriageCertUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Marriage Certificate</p>
                            <input type="file" id="marriageCert" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-preview" id="filePreview"></div>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit Application</button>
                </form>
            `,
            "death-certificate": `
                <h2 class="section-title">Death Certificate Application</h2>
                <form id="deathCertificateForm" class="application-form">
                    <div class="form-group">
                        <label for="deceasedName">Deceased Person's Name</label>
                        <input type="text" id="deceasedName" placeholder="Enter deceased person's name" required>
                    </div>
                    <div class="form-group">
                        <label for="dateOfDeath">Date of Death</label>
                        <input type="date" id="dateOfDeath" required>
                    </div>
                    <div class="form-group">
                        <label for="placeOfDeath">Place of Death</label>
                        <input type="text" id="placeOfDeath" placeholder="Enter place of death" required>
                    </div>
                    <div class="form-group">
                        <label for="causeOfDeath">Cause of Death</label>
                        <input type="text" id="causeOfDeath" placeholder="Enter cause of death" required>
                    </div>
                    <div class="form-group">
                        <label for="applicantName">Applicant Name</label>
                        <input type="text" id="applicantName" placeholder="Enter applicant name" required>
                    </div>
                    <div class="form-group">
                        <label for="relationship">Relationship to Deceased</label>
                        <input type="text" id="relationship" placeholder="Enter relationship" required>
                    </div>
                    <div class="form-group">
                        <label>Upload Required Documents</label>
                        <div class="file-upload-container" id="deathRecordUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Hospital Death Record</p>
                            <input type="file" id="deathRecord" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-upload-container" id="applicantIdUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Applicant's ID Proof</p>
                            <input type="file" id="applicantId" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-upload-container" id="deceasedIdUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload Deceased's ID Proof</p>
                            <input type="file" id="deceasedId" accept="image/*" style="display: none;">
                        </div>
                        <div class="file-preview" id="filePreview"></div>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit Application</button>
                </form>
            `
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    const sectionId = this.getAttribute('data-section');
                    document.getElementById(sectionId).classList.add('active');
                });
            });

            // Service category cards
            document.querySelectorAll('.category-card[data-service]').forEach(card => {
                card.addEventListener('click', function() {
                    const service = this.getAttribute('data-service');
                    
                    // Switch to service forms section
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    document.querySelector('[data-section="services"]').classList.add('active');
                    
                    document.querySelectorAll('.section').forEach(section => {
                        section.classList.remove('active');
                    });
                    document.getElementById('service-forms').classList.add('active');
                    
                    // Load the appropriate form
                    loadServiceForm(service);
                });
            });

            // Documentation "Apply Now" buttons
            document.querySelectorAll('.apply-now-btn').forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation(); // Prevent triggering the parent card click
                    const service = this.getAttribute('data-service');
                    
                    // Switch to service forms section
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    document.querySelector('[data-section="services"]').classList.add('active');
                    
                    document.querySelectorAll('.section').forEach(section => {
                        section.classList.remove('active');
                    });
                    document.getElementById('service-forms').classList.add('active');
                    
                    // Load the appropriate form
                    loadServiceForm(service);
                });
            });

            // Complaint category cards
            document.querySelectorAll('.complaint-category').forEach(card => {
                card.addEventListener('click', function() {
                    const complaintType = this.getAttribute('data-complaint-type');
                    loadComplaintForm(complaintType);
                });
            });

            // Documentation category cards
            document.querySelectorAll('.category-card[data-doc]').forEach(card => {
                card.addEventListener('click', function() {
                    const docType = this.getAttribute('data-doc');
                    
                    // Switch to documentation details section
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    document.querySelector('[data-section="documentation"]').classList.add('active');
                    
                    document.querySelectorAll('.section').forEach(section => {
                        section.classList.remove('active');
                    });
                    document.getElementById('documentation-details').classList.add('active');
                    
                    // Load the appropriate documentation
                    loadDocumentationDetails(docType);
                });
            });

            // Admin navigation
            document.querySelectorAll('.admin-nav').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('.admin-nav').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.admin-tab').forEach(tab => {
                        tab.classList.remove('active');
                    });
                    
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(`admin-${tabId}`).classList.add('active');
                });
            });

            // File upload functionality
            function setupFileUpload(uploadContainerId, fileInputId) {
                const uploadContainer = document.getElementById(uploadContainerId);
                const fileInput = document.getElementById(fileInputId);
                
                if (uploadContainer && fileInput) {
                    uploadContainer.addEventListener('click', function() {
                        fileInput.click();
                    });
                    
                    fileInput.addEventListener('change', function() {
                        if (this.files && this.files[0]) {
                            const previewContainer = document.getElementById('filePreview') || document.getElementById('complaintFilePreview');
                            for (let i = 0; i < this.files.length; i++) {
                                const file = this.files[i];
                                const reader = new FileReader();
                                
                                reader.onload = function(e) {
                                    const previewItem = document.createElement('div');
                                    previewItem.className = 'file-preview-item';
                                    
                                    const img = document.createElement('img');
                                    img.src = e.target.result;
                                    
                                    const removeBtn = document.createElement('button');
                                    removeBtn.className = 'remove-file';
                                    removeBtn.innerHTML = '&times;';
                                    removeBtn.addEventListener('click', function() {
                                        previewItem.remove();
                                    });
                                    
                                    previewItem.appendChild(img);
                                    previewItem.appendChild(removeBtn);
                                    previewContainer.appendChild(previewItem);
                                };
                                
                                reader.readAsDataURL(file);
                            }
                        }
                    });
                }
            }

            // Load service form
            function loadServiceForm(service) {
                const formsSection = document.getElementById('service-forms');
                formsSection.innerHTML = serviceForms[service] || '<p>Form not available for this service.</p>';
                
                // Set up file uploads for the loaded form
                // This will set up all file upload containers in the form
                const fileUploadContainers = formsSection.querySelectorAll('.file-upload-container');
                fileUploadContainers.forEach(container => {
                    const fileInputId = container.querySelector('input[type="file"]').id;
                    setupFileUpload(container.id, fileInputId);
                });
                
                // Set up form submission
                const form = document.getElementById(service + 'Form');
                if (form) {
                    form.addEventListener('submit', function(e) {
                        e.preventDefault();
                        submitApplication(service, this);
                    });
                }
            }

            // Load complaint form
            function loadComplaintForm(complaintType) {
                const complaintFormContainer = document.getElementById('complaintFormContainer');
                const complaintFormTitle = document.getElementById('complaintFormTitle');
                
                complaintFormTitle.textContent = `File ${complaintCategories[complaintType].title} Complaint`;
                complaintFormContainer.style.display = 'block';
                
                // Set up file upload for complaint photos
                setupFileUpload('complaintPhotoUpload', 'complaintPhoto');
                
                // Set up form submission
                const complaintForm = document.getElementById('complaintForm');
                complaintForm.onsubmit = function(e) {
                    e.preventDefault();
                    submitComplaint(complaintType, this);
                };
                
                // Scroll to form
                complaintFormContainer.scrollIntoView({ behavior: 'smooth' });
            }

            // Load documentation details
            function loadDocumentationDetails(docType) {
                const detailsSection = document.getElementById('documentation-details');
                const doc = documentationRequirements[docType];
                
                if (doc) {
                    let html = `<h2 class="section-title">${doc.title}</h2>`;
                    html += '<div class="documentation-info">';
                    html += '<h3>Required Documents:</h3>';
                    html += '<ul>';
                    
                    doc.requirements.forEach(req => {
                        html += `<li>${req}</li>`;
                    });
                    
                    html += '</ul>';
                    html += '</div>';
                    html += `<button class="btn btn-primary" onclick="applyForService('${docType}')">Apply Now</button>`;
                    
                    detailsSection.innerHTML = html;
                } else {
                    detailsSection.innerHTML = '<p>Documentation details not available for this service.</p>';
                }
            }

            // Apply for service from documentation
            window.applyForService = function(service) {
                // Switch to service forms section
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                document.querySelector('[data-section="services"]').classList.add('active');
                
                document.querySelectorAll('.section').forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById('service-forms').classList.add('active');
                
                // Load the appropriate form
                loadServiceForm(service);
            };

            // Submit application
            function submitApplication(serviceType, form) {
                if (!currentUser) {
                    alert('Please login to submit an application.');
                    return;
                }
                
                const formData = new FormData(form);
                const applicationData = {};
                
                for (let [key, value] of formData.entries()) {
                    applicationData[key] = value;
                }
                
                const application = {
                    id: applicationIdCounter++,
                    userId: currentUser.id,
                    serviceType: serviceType,
                    data: applicationData,
                    status: 'pending',
                    date: new Date().toISOString().split('T')[0],
                    userName: currentUser.name,
                    userEmail: currentUser.email,
                    userPhone: currentUser.phone
                };
                
                applications.push(application);
                saveData();
                
                // Update user application count
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex].applications = (users[userIndex].applications || 0) + 1;
                }
                
                alert(`Application submitted successfully! Your application ID is: ${application.id}`);
                form.reset();
                
                // Clear file previews
                const filePreview = document.getElementById('filePreview');
                if (filePreview) {
                    filePreview.innerHTML = '';
                }
                
                // Update application lists
                updateApplicationList();
                updateAdminApplicationsTable();
                updateStats();
            }

            // Submit complaint
            function submitComplaint(complaintType, form) {
                if (!currentUser) {
                    alert('Please login to submit a complaint.');
                    return;
                }
                
                const formData = new FormData(form);
                const complaintData = {};
                
                for (let [key, value] of formData.entries()) {
                    complaintData[key] = value;
                }
                
                const complaint = {
                    id: complaintIdCounter++,
                    userId: currentUser.id,
                    type: complaintType,
                    title: complaintData.complaintTitle,
                    description: complaintData.complaintDescription,
                    location: complaintData.complaintLocation,
                    priority: complaintData.complaintPriority,
                    status: 'open',
                    date: new Date().toISOString().split('T')[0],
                    userName: currentUser.name,
                    userEmail: currentUser.email,
                    userPhone: currentUser.phone,
                    adminNotes: '',
                    resolutionDate: null
                };
                
                complaints.push(complaint);
                saveData();
                
                // Update user complaint count
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex].complaints = (users[userIndex].complaints || 0) + 1;
                }
                
                alert(`Complaint submitted successfully! Your complaint ID is: ${complaint.id}`);
                form.reset();
                
                // Clear file previews
                const complaintFilePreview = document.getElementById('complaintFilePreview');
                if (complaintFilePreview) {
                    complaintFilePreview.innerHTML = '';
                }
                
                // Update complaint lists
                updateComplaintList();
                updateAdminComplaintsTable();
                updateStats();
            }

            // Enhanced chatbot functionality from code1
            document.getElementById('chatbotToggle').addEventListener('click', function() {
                document.getElementById('chatbotWindow').style.display = 'flex';
            });

            document.getElementById('closeChatbot').addEventListener('click', function() {
                document.getElementById('chatbotWindow').style.display = 'none';
            });

            document.getElementById('sendMessage').addEventListener('click', sendMessage);
            document.getElementById('chatbotInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            function sendMessage() {
                const input = document.getElementById('chatbotInput');
                const message = input.value.trim();
                
                if (message) {
                    // Add user message
                    addMessage(message, 'user');
                    input.value = '';
                    
                    // Generate bot response
                    setTimeout(() => {
                        const response = generateBotResponse(message);
                        addMessage(response.text, 'bot');
                        
                        // Add details if available
                        if (response.details) {
                            const detailsElement = document.createElement('div');
                            detailsElement.className = 'message bot-message';
                            detailsElement.innerHTML = response.details;
                            
                            // Add apply button if action is specified
                            if (response.action) {
                                const applyButton = document.createElement('button');
                                applyButton.className = 'apply-now-btn';
                                applyButton.textContent = 'Apply Now';
                                applyButton.onclick = function() {
                                    applyForService(response.action);
                                    document.getElementById('chatbotWindow').style.display = 'none';
                                };
                                detailsElement.appendChild(applyButton);
                            }
                            
                            document.getElementById('chatbotMessages').appendChild(detailsElement);
                        }
                        
                        // Add quick actions if available
                        if (response.quickActions) {
                            const quickActionsContainer = document.createElement('div');
                            quickActionsContainer.className = 'chatbot-quick-actions';
                            
                            response.quickActions.forEach(action => {
                                const actionButton = document.createElement('button');
                                actionButton.className = 'quick-action-btn';
                                actionButton.textContent = action;
                                actionButton.onclick = function() {
                                    document.getElementById('chatbotInput').value = action;
                                    sendMessage();
                                };
                                quickActionsContainer.appendChild(actionButton);
                            });
                            
                            document.getElementById('chatbotMessages').appendChild(quickActionsContainer);
                        }
                        
                        document.getElementById('chatbotMessages').scrollTop = document.getElementById('chatbotMessages').scrollHeight;
                    }, 500);
                }
            }

            function addMessage(text, sender) {
                const messagesContainer = document.getElementById('chatbotMessages');
                const messageElement = document.createElement('div');
                messageElement.classList.add('message', `${sender}-message`);
                messageElement.textContent = text;
                messagesContainer.appendChild(messageElement);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }

            function generateBotResponse(message) {
                const lowerMessage = message.toLowerCase();
                
                // Greeting responses
                if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
                    return {
                        text: "Hello! I'm your municipality assistant. I can help you with:",
                        quickActions: [
                            "License Application",
                            "Property Tax Payment", 
                            "Vehicle Registration",
                            "Trade License",
                            "Building Permit",
                            "Birth Certificate",
                            "Death Certificate",
                            "Document Requirements",
                            "File a Complaint"
                        ]
                    };
                }
                
                // License application information
                if (lowerMessage.includes('license') && lowerMessage.includes('apply')) {
                    return {
                        text: "For License Application, here's what you need to know:",
                        details: `
                            <div class="service-steps">
                                <h4>License Application Process:</h4>
                                <ol>
                                    <li>Fill out the license application form with personal details</li>
                                    <li>Select the type of license (Business, Professional, Trade, Vehicle)</li>
                                    <li>Upload required documents including Aadhar card front and back</li>
                                    <li>Submit the application for processing</li>
                                    <li>Track application status in 'My Applications' section</li>
                                </ol>
                            </div>
                            <div class="document-list">
                                <h4>Required Documents:</h4>
                                <ul>
                                    <li>Proof of Identity (Aadhar Card, Passport, etc.)</li>
                                    <li>Proof of Address (Aadhar Card, Utility Bill, etc.)</li>
                                    <li>Passport-sized Photographs (2 copies)</li>
                                    <li>Educational qualification certificates (if applicable)</li>
                                    <li>Experience certificates (if applicable)</li>
                                    <li>No objection certificate from property owner (if applicable)</li>
                                </ul>
                            </div>
                        `,
                        action: "license"
                    };
                }
                
                // License renewal information
                if (lowerMessage.includes('license') && lowerMessage.includes('renew')) {
                    return {
                        text: "For License Renewal, here's the process:",
                        details: `
                            <div class="service-steps">
                                <h4>License Renewal Process:</h4>
                                <ol>
                                    <li>Enter your existing license number</li>
                                    <li>Select renewal type (Annual, Biannual, Lifetime)</li>
                                    <li>Update any changed information</li>
                                    <li>Upload existing license copy and updated documents</li>
                                    <li>Pay renewal fee and submit application</li>
                                </ol>
                            </div>
                            <div class="document-list">
                                <h4>Required Documents:</h4>
                                <ul>
                                    <li>Existing license certificate</li>
                                    <li>Updated proof of identity</li>
                                    <li>Updated proof of address</li>
                                    <li>Recent passport-sized photographs</li>
                                    <li>Payment receipt of renewal fee</li>
                                </ul>
                            </div>
                        `,
                        action: "license-renewal"
                    };
                }
                
                // Property tax information
                if (lowerMessage.includes('property tax') || lowerMessage.includes('tax payment')) {
                    return {
                        text: "For Property Tax Payment, here's how it works:",
                        details: `
                            <div class="service-steps">
                                <h4>Property Tax Payment Process:</h4>
                                <ol>
                                    <li>Enter your Property ID</li>
                                    <li>Verify property owner details</li>
                                    <li>Check tax amount due</li>
                                    <li>Select payment method (Credit Card, Debit Card, UPI, Net Banking)</li>
                                    <li>Upload property documents for verification</li>
                                    <li>Make instant payment</li>
                                    <li>Receive payment confirmation</li>
                                </ol>
                            </div>
                            <div class="document-list">
                                <h4>Required Documents:</h4>
                                <ul>
                                    <li>Property ownership documents</li>
                                    <li>Previous tax payment receipts (if any)</li>
                                    <li>Proof of identity</li>
                                    <li>Property measurement details</li>
                                    <li>Building plan approval (if applicable)</li>
                                </ul>
                            </div>
                        `,
                        action: "property-tax"
                    };
                }
                
                // Vehicle registration information
                if (lowerMessage.includes('vehicle') || lowerMessage.includes('registration')) {
                    return {
                        text: "For Vehicle Registration, here's the complete process:",
                        details: `
                            <div class="service-steps">
                                <h4>Vehicle Registration Process:</h4>
                                <ol>
                                    <li>Select vehicle type (Two Wheeler, Four Wheeler, Commercial)</li>
                                    <li>Enter vehicle details (Model, Manufacture Year, Chassis No, Engine No)</li>
                                    <li>Provide owner information and address</li>
                                    <li>Upload required documents including vehicle invoice</li>
                                    <li>Submit application for processing</li>
                                    <li>Pay registration fees</li>
                                </ol>
                            </div>
                            <div class="document-list">
                                <h4>Required Documents:</h4>
                                <ul>
                                    <li>Vehicle purchase invoice</li>
                                    <li>Vehicle insurance certificate</li>
                                    <li>Pollution under control certificate</li>
                                    <li>Road tax payment receipt</li>
                                    <li>Proof of identity and address</li>
                                    <li>Vehicle fitness certificate (for commercial vehicles)</li>
                                </ul>
                            </div>
                        `,
                        action: "vehicle-registration"
                    };
                }
                
                // Trade license information
                if (lowerMessage.includes('trade license') || lowerMessage.includes('business license')) {
                    return {
                        text: "For Trade License Application, here's what you need:",
                        details: `
                            <div class="service-steps">
                                <h4>Trade License Process:</h4>
                                <ol>
                                    <li>Enter business name and type</li>
                                    <li>Provide business address details</li>
                                    <li>Enter owner information</li>
                                    <li>Upload business proof and identification documents</li>
                                    <li>Submit application for approval</li>
                                    <li>Track application status</li>
                                </ol>
                            </div>
                            <div class="document-list">
                                <h4>Required Documents:</h4>
                                <ul>
                                    <li>Business address proof</li>
                                    <li>Partnership deed (if applicable)</li>
                                    <li>Company incorporation certificate (if applicable)</li>
                                    <li>No objection certificate from property owner</li>
                                    <li>Site plan of business premises</li>
                                    <li>Proof of identity and address of owner</li>
                                </ul>
                            </div>
                        `,
                        action: "trade-license"
                    };
                }
                
                // Building permit information
                if (lowerMessage.includes('building permit') || lowerMessage.includes('construction')) {
                    return {
                        text: "For Building Permit Application, here's the procedure:",
                        details: `
                            <div class="service-steps">
                                <h4>Building Permit Process:</h4>
                                <ol>
                                    <li>Provide property location details</li>
                                    <li>Select building type (Residential, Commercial, Industrial)</li>
                                    <li>Enter building specifications (Area, Floors)</li>
                                    <li>Provide owner and architect details</li>
                                    <li>Upload site plan and building drawings</li>
                                    <li>Submit for municipal approval</li>
                                </ol>
                            </div>
                            <div class="document-list">
                                <h4>Required Documents:</h4>
                                <ul>
                                    <li>Land ownership documents</li>
                                    <li>Site plan and building drawings</li>
                                    <li>Structural stability certificate</li>
                                    <li>No objection certificate from neighbors (if required)</li>
                                    <li>Environmental clearance (if applicable)</li>
                                    <li>Proof of identity and address</li>
                                </ul>
                            </div>
                        `,
                        action: "building-permit"
                    };
                }
                
                // Birth certificate information
                if (lowerMessage.includes('birth certificate') || lowerMessage.includes('birth')) {
                    return {
                        text: "For Birth Certificate Application, here's the process:",
                        details: `
                            <div class="service-steps">
                                <h4>Birth Certificate Process:</h4>
                                <ol>
                                    <li>Enter child's details (Name, Gender, Date of Birth)</li>
                                    <li>Provide place of birth information</li>
                                    <li>Enter parents' details</li>
                                    <li>Upload hospital birth record and parent documents</li>
                                    <li>Submit application for certificate issuance</li>
                                </ol>
                            </div>
                            <div class="document-list">
                                <h4>Required Documents:</h4>
                                <ul>
                                    <li>Hospital birth record or delivery slip</li>
                                    <li>Proof of identity of parents</li>
                                    <li>Proof of address of parents</li>
                                    <li>Marriage certificate of parents</li>
                                    <li>Affidavit for delayed registration (if applicable)</li>
                                </ul>
                            </div>
                        `,
                        action: "birth-certificate"
                    };
                }
                
                // Death certificate information
                if (lowerMessage.includes('death certificate') || lowerMessage.includes('death')) {
                    return {
                        text: "For Death Certificate Application, here's what you need:",
                        details: `
                            <div class="service-steps">
                                <h4>Death Certificate Process:</h4>
                                <ol>
                                    <li>Enter deceased person's details</li>
                                    <li>Provide date and place of death information</li>
                                    <li>Enter cause of death</li>
                                    <li>Provide applicant details and relationship</li>
                                    <li>Upload hospital death record and identification</li>
                                    <li>Submit application for certificate</li>
                                </ol>
                            </div>
                            <div class="document-list">
                                <h4>Required Documents:</h4>
                                <ul>
                                    <li>Hospital death record or medical certificate</li>
                                    <li>Proof of identity of applicant</li>
                                    <li>Proof of address of applicant</li>
                                    <li>Proof of identity of deceased</li>
                                    <li>Affidavit for delayed registration (if applicable)</li>
                                </ul>
                            </div>
                        `,
                        action: "death-certificate"
                    };
                }
                
                // Complaint filing information
                if (lowerMessage.includes('complaint') || lowerMessage.includes('issue') || lowerMessage.includes('problem')) {
                    return {
                        text: "I can help you file a complaint about various municipal issues:",
                        details: `
                            <div class="service-steps">
                                <h4>Complaint Categories:</h4>
                                <ul>
                                    <li><strong>Sanitation Issues:</strong> Garbage collection, unclean areas</li>
                                    <li><strong>Road & Infrastructure:</strong> Potholes, street lights, traffic</li>
                                    <li><strong>Water Supply:</strong> Water issues, leakages, quality</li>
                                    <li><strong>Electricity Issues:</strong> Power outages, electrical hazards</li>
                                    <li><strong>Parks & Public Spaces:</strong> Park maintenance, facilities</li>
                                    <li><strong>Noise Pollution:</strong> Excessive noise complaints</li>
                                </ul>
                            </div>
                            <p>You can file a complaint by visiting the "File Complaint" section.</p>
                        `,
                        quickActions: [
                            "Sanitation Complaint",
                            "Road Issue",
                            "Water Problem",
                            "Electricity Issue"
                        ]
                    };
                }
                
                // Document upload information
                if (lowerMessage.includes('document') || lowerMessage.includes('upload') || lowerMessage.includes('aadhar')) {
                    return {
                        text: "For Document Upload, here's what you need to know:",
                        details: `
                            <div class="service-steps">
                                <h4>Document Upload Process:</h4>
                                <ol>
                                    <li>Click on the file upload area for each required document</li>
                                    <li>Select the file from your device</li>
                                    <li>Supported formats: JPG, PNG, PDF (Images are preferred for quick verification)</li>
                                    <li>For Aadhar Card: Upload both front and back sides clearly</li>
                                    <li>Ensure documents are clear and readable</li>
                                    <li>Maximum file size: 5MB per document</li>
                                    <li>You can preview uploaded documents before submission</li>
                                </ol>
                            </div>
                            <div class="document-list">
                                <h4>General Document Requirements:</h4>
                                <ul>
                                    <li><strong>Aadhar Card:</strong> Both front and back sides required</li>
                                    <li><strong>Passport Photo:</strong> Recent white background photo</li>
                                    <li><strong>Address Proof:</strong> Utility bill, rental agreement, etc.</li>
                                    <li><strong>Property Documents:</strong> Clear copies of ownership papers</li>
                                    <li><strong>Educational Certificates:</strong> If required for license</li>
                                </ul>
                            </div>
                        `
                    };
                }
                
                // Application status and tracking
                if (lowerMessage.includes('status') || lowerMessage.includes('track') || lowerMessage.includes('application status')) {
                    return {
                        text: "For Application Tracking, here's how it works:",
                        details: `
                            <div class="service-steps">
                                <h4>Application Tracking:</h4>
                                <ol>
                                    <li>Go to 'My Applications' section after login</li>
                                    <li>View all your submitted applications</li>
                                    <li>Check current status (Pending, In Progress, Approved, Rejected)</li>
                                    <li>Click 'View Details' for detailed information</li>
                                    <li>Admin notes will be visible if application is processed</li>
                                </ol>
                            </div>
                            <div class="document-list">
                                <h4>Status Meanings:</h4>
                                <ul>
                                    <li><strong>Pending:</strong> Application submitted, awaiting review</li>
                                    <li><strong>In Progress:</strong> Under processing by municipality</li>
                                    <li><strong>Approved:</strong> Application approved, certificate ready</li>
                                    <li><strong>Rejected:</strong> Application rejected with reasons provided</li>
                                </ul>
                            </div>
                        `
                    };
                }
                
                // Complaint status and tracking
                if (lowerMessage.includes('complaint status') || lowerMessage.includes('complaint track')) {
                    return {
                        text: "For Complaint Tracking, here's how it works:",
                        details: `
                            <div class="service-steps">
                                <h4>Complaint Tracking:</h4>
                                <ol>
                                    <li>Go to 'My Complaints' section after login</li>
                                    <li>View all your submitted complaints</li>
                                    <li>Check current status (Open, Investigation, Resolved, Closed)</li>
                                    <li>Click 'View Details' for detailed information</li>
                                    <li>Admin notes will be visible if complaint is processed</li>
                                </ol>
                            </div>
                            <div class="document-list">
                                <h4>Status Meanings:</h4>
                                <ul>
                                    <li><strong>Open:</strong> Complaint submitted, awaiting review</li>
                                    <li><strong>Investigation:</strong> Under investigation by municipality</li>
                                    <li><strong>Resolved:</strong> Complaint resolved, issue fixed</li>
                                    <li><strong>Closed:</strong> Complaint closed with resolution</li>
                                </ul>
                            </div>
                        `
                    };
                }
                
                // Admin panel information
                if (lowerMessage.includes('admin') || lowerMessage.includes('manage')) {
                    return {
                        text: "For Admin Panel Access, here's what you can do:",
                        details: `
                            <div class="service-steps">
                                <h4>Admin Panel Features:</h4>
                                <ol>
                                    <li><strong>Dashboard:</strong> View overall statistics and metrics</li>
                                    <li><strong>Applications Management:</strong> Review, approve, or reject applications</li>
                                    <li><strong>Complaints Management:</strong> Review and update complaint status</li>
                                    <li><strong>User Management:</strong> Manage registered users</li>
                                    <li><strong>Reports:</strong> Generate analytics and reports</li>
                                    <li><strong>Settings:</strong> Configure system settings</li>
                                </ol>
                            </div>
                            <div class="document-list">
                                <h4>Admin Login:</h4>
                                <ul>
                                    <li>Use admin credentials to access the panel</li>
                                    <li>Manage all user applications efficiently</li>
                                    <li>Update application and complaint status with notes</li>
                                    <li>Monitor system performance</li>
                                </ul>
                            </div>
                        `
                    };
                }
                
                // General documentation requirements
                if (lowerMessage.includes('document') || lowerMessage.includes('require') || lowerMessage.includes('need')) {
                    return {
                        text: "For general documentation requirements:",
                        details: `
                            <div class="document-list">
                                <h4>Common Documents Required for Most Services:</h4>
                                <ul>
                                    <li><strong>Proof of Identity:</strong> Aadhar Card, Passport, Voter ID, Driving License</li>
                                    <li><strong>Proof of Address:</strong> Aadhar Card, Utility Bill, Rental Agreement</li>
                                    <li><strong>Photographs:</strong> Recent passport-sized photos (2 copies)</li>
                                    <li><strong>Existing Certificates:</strong> Any relevant existing licenses or certificates</li>
                                    <li><strong>Payment Receipts:</strong> For applicable fees and charges</li>
                                </ul>
                            </div>
                            <p>For specific service requirements, ask about that particular service like "license documents" or "vehicle registration documents".</p>
                        `
                    };
                }
                
                // Help and support
                if (lowerMessage.includes('help') || lowerMessage.includes('support') || lowerMessage.includes('contact')) {
                    return {
                        text: "I'm here to help you with municipality services!",
                        details: `
                            <div class="service-steps">
                                <h4>How I can assist you:</h4>
                                <ol>
                                    <li>Provide information about all municipality services</li>
                                    <li>Explain documentation requirements</li>
                                    <li>Guide through application processes</li>
                                    <li>Help with document upload procedures</li>
                                    <li>Explain application and complaint tracking</li>
                                    <li>Provide admin panel information</li>
                                </ol>
                            </div>
                            <p>You can ask me about:</p>
                            <ul>
                                <li>License applications and renewals</li>
                                <li>Property tax payments</li>
                                <li>Vehicle registration</li>
                                <li>Trade licenses</li>
                                <li>Building permits</li>
                                <li>Birth and death certificates</li>
                                <li>Filing complaints</li>
                                <li>Document requirements</li>
                                <li>Application and complaint status</li>
                            </ul>
                        `
                    };
                }
                
                // Default response
                return {
                    text: "I'm here to help with municipality services. You can ask me about:",
                    details: `
                        <div class="service-steps">
                            <ul>
                                <li>License applications and renewals</li>
                                <li>Property tax payment process</li>
                                <li>Vehicle registration requirements</li>
                                <li>Trade license documentation</li>
                                <li>Building permit procedures</li>
                                <li>Birth and death certificate applications</li>
                                <li>Filing complaints about municipal issues</li>
                                <li>Document upload requirements</li>
                                <li>Application and complaint tracking</li>
                                <li>Admin panel features</li>
                            </ul>
                        </div>
                        <p>Or use the quick action buttons below for specific services!</p>
                    `,
                    quickActions: [
                        "License Application",
                        "Property Tax", 
                        "Vehicle Registration",
                        "Trade License",
                        "Building Permit",
                        "Birth Certificate",
                        "Death Certificate",
                        "File Complaint",
                        "Document Upload"
                    ]
                };
            }

            // Initialize chatbot with welcome message and quick actions
            function initializeChatbot() {
                const welcomeResponse = generateBotResponse('hello');
                addMessage(welcomeResponse.text, 'bot');
                
                if (welcomeResponse.quickActions) {
                    const quickActionsContainer = document.createElement('div');
                    quickActionsContainer.className = 'chatbot-quick-actions';
                    
                    welcomeResponse.quickActions.forEach(action => {
                        const actionButton = document.createElement('button');
                        actionButton.className = 'quick-action-btn';
                        actionButton.textContent = action;
                        actionButton.onclick = function() {
                            document.getElementById('chatbotInput').value = action;
                            sendMessage();
                        };
                        quickActionsContainer.appendChild(actionButton);
                    });
                    
                    document.getElementById('chatbotMessages').appendChild(quickActionsContainer);
                }
            }

            // Login/Register functionality
            document.getElementById('loginBtn').addEventListener('click', function() {
                document.getElementById('loginModal').style.display = 'flex';
            });

            document.getElementById('closeLoginModal').addEventListener('click', function() {
                document.getElementById('loginModal').style.display = 'none';
            });

            document.getElementById('adminLoginBtn').addEventListener('click', function() {
                document.getElementById('loginModal').style.display = 'none';
                document.getElementById('adminLoginModal').style.display = 'flex';
            });

            document.getElementById('closeAdminLoginModal').addEventListener('click', function() {
                document.getElementById('adminLoginModal').style.display = 'none';
            });

            document.getElementById('userLoginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                
                // Simple authentication - in a real app, this would be more secure
                let user = users.find(u => u.email === email);
                if (user) {
                    currentUser = user;
                    isAdmin = false;
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    localStorage.setItem('isAdmin', JSON.stringify(isAdmin));
                    document.getElementById('loginModal').style.display = 'none';
                    alert(`Welcome back, ${user.name}!`);
                    updateUIForUser();
                } else {
                    alert('User not found. Please register.');
                }
            });

            document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('adminUsername').value;
                const password = document.getElementById('adminPassword').value;
                
                if (username === adminCredentials.username && password === adminCredentials.password) {
                    isAdmin = true;
                    localStorage.setItem('isAdmin', JSON.stringify(isAdmin));
                    document.getElementById('adminLoginModal').style.display = 'none';
                    alert('Welcome, Admin!');
                    updateUIForUser();
                } else {
                    alert('Invalid admin credentials. Please try again.');
                }
            });

            document.getElementById('registerBtn').addEventListener('click', function() {
                const name = prompt('Enter your full name:');
                const email = prompt('Enter your email:');
                const phone = prompt('Enter your phone number:');
                
                if (name && email && phone) {
                    const newUser = {
                        id: userIdCounter++,
                        name: name,
                        email: email,
                        phone: phone,
                        status: 'active',
                        applications: 0,
                        complaints: 0
                    };
                    
                    users.push(newUser);
                    currentUser = newUser;
                    isAdmin = false;
                    saveData();
                    
                    alert(`Registration successful! Welcome, ${name}.`);
                    updateUIForUser();
                }
            });

            function updateUIForUser() {
                if (currentUser || isAdmin) {
                    document.getElementById('loginBtn').textContent = 'Logout';
                    document.getElementById('registerBtn').style.display = 'none';
                    
                    document.getElementById('loginBtn').onclick = function() {
                        currentUser = null;
                        isAdmin = false;
                        localStorage.removeItem('currentUser');
                        localStorage.removeItem('isAdmin');
                        alert('You have been logged out.');
                        location.reload();
                    };
                }
            }

            // Modal functionality
            document.getElementById('closeModal').addEventListener('click', function() {
                document.getElementById('applicationModal').style.display = 'none';
            });

            document.getElementById('closeComplaintModal').addEventListener('click', function() {
                document.getElementById('complaintModal').style.display = 'none';
            });

            window.closeModal = function() {
                document.getElementById('applicationModal').style.display = 'none';
            };

            window.closeComplaintModal = function() {
                document.getElementById('complaintModal').style.display = 'none';
            };

            // Initialize UI
            updateApplicationList();
            updateComplaintList();
            updateAdminApplicationsTable();
            updateAdminComplaintsTable();
            updateAdminUsersTable();
            updateStats();
            init3DAnimation();
            updateUIForUser();
            initializeChatbot();

            // Set up periodic updates for demo purposes
            setInterval(updateStats, 5000);
        });

        // Data management functions
        function saveData() {
            localStorage.setItem('applications', JSON.stringify(applications));
            localStorage.setItem('complaints', JSON.stringify(complaints));
            localStorage.setItem('users', JSON.stringify(users));
            localStorage.setItem('applicationIdCounter', applicationIdCounter.toString());
            localStorage.setItem('complaintIdCounter', complaintIdCounter.toString());
            localStorage.setItem('userIdCounter', userIdCounter.toString());
            if (currentUser) {
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
            }
            localStorage.setItem('isAdmin', JSON.stringify(isAdmin));
        }

        function updateApplicationList() {
            const applicationList = document.getElementById('applicationList');
            applicationList.innerHTML = '';
            
            let userApplications = applications;
            if (currentUser) {
                userApplications = applications.filter(a => a.userId === currentUser.id);
            }
            
            if (userApplications.length === 0) {
                applicationList.innerHTML = '<p>No applications found.</p>';
                return;
            }
            
            userApplications.forEach(application => {
                const applicationItem = document.createElement('div');
                applicationItem.className = 'application-item';
                
                const statusClass = `status-${application.status.replace(' ', '-')}`;
                
                applicationItem.innerHTML = `
                    <div class="application-info">
                        <h3>${getServiceDisplayName(application.serviceType)} (ID: ${application.id})</h3>
                        <p>Submitted on: ${application.date}</p>
                        <div class="application-meta">
                            <span><i class="fas fa-calendar"></i> ${application.date}</span>
                            <span><i class="fas fa-user"></i> ${application.userName}</span>
                        </div>
                    </div>
                    <div class="application-status">
                        <span class="status ${statusClass}">${application.status}</span>
                        <button class="btn btn-primary view-details" data-id="${application.id}" style="margin-top: 10px;">View Details</button>
                    </div>
                `;
                
                applicationList.appendChild(applicationItem);
            });
            
            // Add event listeners for view details buttons
            document.querySelectorAll('.view-details').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    viewApplicationDetails(id);
                });
            });
        }

        function updateComplaintList() {
            const complaintList = document.getElementById('complaintList');
            complaintList.innerHTML = '';
            
            let userComplaints = complaints;
            if (currentUser) {
                userComplaints = complaints.filter(c => c.userId === currentUser.id);
            }
            
            if (userComplaints.length === 0) {
                complaintList.innerHTML = '<p>No complaints found.</p>';
                return;
            }
            
            userComplaints.forEach(complaint => {
                const complaintItem = document.createElement('div');
                complaintItem.className = 'complaint-item';
                
                const statusClass = `status-${complaint.status}`;
                
                complaintItem.innerHTML = `
                    <div class="complaint-info">
                        <h3>${complaint.title} (ID: ${complaint.id})</h3>
                        <p>Type: ${complaintCategories[complaint.type].title}</p>
                        <div class="complaint-meta">
                            <span><i class="fas fa-calendar"></i> ${complaint.date}</span>
                            <span><i class="fas fa-map-marker-alt"></i> ${complaint.location}</span>
                            <span><i class="fas fa-exclamation-circle"></i> ${complaint.priority}</span>
                        </div>
                    </div>
                    <div class="complaint-status">
                        <span class="status ${statusClass}">${complaint.status}</span>
                        <button class="btn btn-primary view-complaint-details" data-id="${complaint.id}" style="margin-top: 10px;">View Details</button>
                    </div>
                `;
                
                complaintList.appendChild(complaintItem);
            });
            
            // Add event listeners for view details buttons
            document.querySelectorAll('.view-complaint-details').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    viewComplaintDetails(id);
                });
            });
        }

        function getServiceDisplayName(serviceType) {
            const displayNames = {
                'license': 'License Application',
                'license-renewal': 'License Renewal',
                'property-tax': 'Property Tax Payment',
                'vehicle-registration': 'Vehicle Registration',
                'trade-license': 'Trade License',
                'building-permit': 'Building Permit',
                'birth-certificate': 'Birth Certificate',
                'death-certificate': 'Death Certificate'
            };
            
            return displayNames[serviceType] || serviceType;
        }

        function viewApplicationDetails(id) {
            const application = applications.find(a => a.id === id);
            if (application) {
                const modal = document.getElementById('applicationModal');
                const modalTitle = document.getElementById('modalTitle');
                const modalContent = document.getElementById('modalContent');
                
                modalTitle.textContent = `${getServiceDisplayName(application.serviceType)} - Application Details`;
                
                let html = `<p><strong>Application ID:</strong> ${application.id}</p>`;
                html += `<p><strong>Service Type:</strong> ${getServiceDisplayName(application.serviceType)}</p>`;
                html += `<p><strong>Submitted Date:</strong> ${application.date}</p>`;
                html += `<p><strong>Status:</strong> <span class="status status-${application.status.replace(' ', '-')}">${application.status}</span></p>`;
                
                html += '<h4>Application Details:</h4>';
                html += '<table style="width: 100%; border-collapse: collapse; margin-top: 10px;">';
                
                for (const [key, value] of Object.entries(application.data)) {
                    if (key !== 'file') {
                        html += `<tr><td style="padding: 8px; border-bottom: 1px solid #eee;"><strong>${formatFieldName(key)}:</strong></td><td style="padding: 8px; border-bottom: 1px solid #eee;">${value}</td></tr>`;
                    }
                }
                
                html += '</table>';
                
                if (application.adminNotes) {
                    html += `<h4>Admin Notes:</h4><p>${application.adminNotes}</p>`;
                }
                
                modalContent.innerHTML = html;
                modal.style.display = 'flex';
            }
        }

        function viewComplaintDetails(id) {
            const complaint = complaints.find(c => c.id === id);
            if (complaint) {
                const modal = document.getElementById('complaintModal');
                const modalTitle = document.getElementById('complaintModalTitle');
                const modalContent = document.getElementById('complaintModalContent');
                
                modalTitle.textContent = `Complaint Details - ID: ${complaint.id}`;
                
                let html = `<p><strong>Complaint ID:</strong> ${complaint.id}</p>`;
                html += `<p><strong>Type:</strong> ${complaintCategories[complaint.type].title}</p>`;
                html += `<p><strong>Title:</strong> ${complaint.title}</p>`;
                html += `<p><strong>Submitted Date:</strong> ${complaint.date}</p>`;
                html += `<p><strong>Status:</strong> <span class="status status-${complaint.status}">${complaint.status}</span></p>`;
                html += `<p><strong>Priority:</strong> ${complaint.priority}</p>`;
                html += `<p><strong>Location:</strong> ${complaint.location}</p>`;
                
                html += '<h4>Description:</h4>';
                html += `<p>${complaint.description}</p>`;
                
                if (complaint.adminNotes) {
                    html += `<h4>Admin Notes:</h4><p>${complaint.adminNotes}</p>`;
                }
                
                if (complaint.resolutionDate) {
                    html += `<p><strong>Resolution Date:</strong> ${complaint.resolutionDate}</p>`;
                }
                
                modalContent.innerHTML = html;
                modal.style.display = 'flex';
            }
        }

        function formatFieldName(fieldName) {
            return fieldName
                .replace(/([A-Z])/g, ' $1')
                .replace(/^./, str => str.toUpperCase())
                .replace(/([A-Z])/g, ' $1')
                .replace(/([A-Z])/g, ' $1')
                .replace(/Id/g, 'ID')
                .replace(/Dob/g, 'Date of Birth')
                .replace(/Dod/g, 'Date of Death');
        }

        function updateAdminApplicationsTable() {
            const tableBody = document.getElementById('adminApplicationsTable');
            tableBody.innerHTML = '';
            
            if (applications.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="6" style="text-align: center;">No applications found.</td></tr>';
                return;
            }
            
            applications.forEach(application => {
                const row = document.createElement('tr');
                
                const statusClass = `status-${application.status.replace(' ', '-')}`;
                
                row.innerHTML = `
                    <td>${application.id}</td>
                    <td>${application.userName}</td>
                    <td>${getServiceDisplayName(application.serviceType)}</td>
                    <td>${application.date}</td>
                    <td><span class="status ${statusClass}">${application.status}</span></td>
                    <td class="action-buttons">
                        <button class="action-btn view-btn" data-id="${application.id}">View</button>
                        <button class="action-btn edit-btn" data-id="${application.id}">Edit</button>
                        <button class="action-btn delete-btn" data-id="${application.id}">Delete</button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners for action buttons
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    viewApplicationDetails(id);
                });
            });
            
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    editApplication(id);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    deleteApplication(id);
                });
            });
        }

        function updateAdminComplaintsTable() {
            const tableBody = document.getElementById('adminComplaintsTable');
            tableBody.innerHTML = '';
            
            if (complaints.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="7" style="text-align: center;">No complaints found.</td></tr>';
                return;
            }
            
            complaints.forEach(complaint => {
                const row = document.createElement('tr');
                
                const statusClass = `status-${complaint.status}`;
                
                row.innerHTML = `
                    <td>${complaint.id}</td>
                    <td>${complaint.userName}</td>
                    <td>${complaintCategories[complaint.type].title}</td>
                    <td>${complaint.title}</td>
                    <td>${complaint.date}</td>
                    <td><span class="status ${statusClass}">${complaint.status}</span></td>
                    <td class="action-buttons">
                        <button class="action-btn view-btn" data-id="${complaint.id}" data-type="complaint">View</button>
                        <button class="action-btn edit-btn" data-id="${complaint.id}" data-type="complaint">Edit</button>
                        <button class="action-btn delete-btn" data-id="${complaint.id}" data-type="complaint">Delete</button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners for action buttons
            document.querySelectorAll('.view-btn[data-type="complaint"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    viewComplaintDetails(id);
                });
            });
            
            document.querySelectorAll('.edit-btn[data-type="complaint"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    editComplaint(id);
                });
            });
            
            document.querySelectorAll('.delete-btn[data-type="complaint"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    deleteComplaint(id);
                });
            });
        }

        function updateAdminUsersTable() {
            const tableBody = document.getElementById('adminUsersTable');
            tableBody.innerHTML = '';
            
            users.forEach(user => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${user.id}</td>
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td>${user.phone}</td>
                    <td>${user.applications || 0}</td>
                    <td>${user.complaints || 0}</td>
                    <td><span class="status status-${user.status}">${user.status}</span></td>
                    <td class="action-buttons">
                        <button class="action-btn edit-btn" data-id="${user.id}">Edit</button>
                        <button class="action-btn delete-btn" data-id="${user.id}">Delete</button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners for action buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    editUser(id);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    deleteUser(id);
                });
            });
        }

        function updateStats() {
            // Update home stats
            document.getElementById('total-applications').textContent = applications.length;
            document.getElementById('approved-applications').textContent = applications.filter(a => a.status === 'approved').length;
            document.getElementById('active-users').textContent = users.filter(u => u.status === 'active').length;
            document.getElementById('total-complaints').textContent = complaints.length;
            
            // Update admin stats
            document.getElementById('admin-total-applications').textContent = applications.length;
            document.getElementById('admin-approved-applications').textContent = applications.filter(a => a.status === 'approved').length;
            document.getElementById('admin-total-complaints').textContent = complaints.length;
            document.getElementById('admin-total-users').textContent = users.length;
        }

        function editApplication(id) {
            const application = applications.find(a => a.id === id);
            if (application) {
                const newStatus = prompt('Enter new status (pending, in progress, approved, rejected):', application.status);
                if (newStatus && ['pending', 'in progress', 'approved', 'rejected'].includes(newStatus.toLowerCase())) {
                    application.status = newStatus.toLowerCase();
                    
                    if (newStatus.toLowerCase() === 'approved' || newStatus.toLowerCase() === 'rejected') {
                        const notes = prompt('Enter notes for the applicant:');
                        if (notes) {
                            application.adminNotes = notes;
                        }
                    }
                    
                    saveData();
                    updateApplicationList();
                    updateAdminApplicationsTable();
                    updateStats();
                    alert('Application status updated successfully!');
                }
            }
        }

        function editComplaint(id) {
            const complaint = complaints.find(c => c.id === id);
            if (complaint) {
                const newStatus = prompt('Enter new status (open, investigation, resolved, closed):', complaint.status);
                if (newStatus && ['open', 'investigation', 'resolved', 'closed'].includes(newStatus.toLowerCase())) {
                    complaint.status = newStatus.toLowerCase();
                    
                    const notes = prompt('Enter update notes for the complainant:');
                    if (notes) {
                        complaint.adminNotes = notes;
                    }
                    
                    if (newStatus.toLowerCase() === 'resolved' || newStatus.toLowerCase() === 'closed') {
                        complaint.resolutionDate = new Date().toISOString().split('T')[0];
                    }
                    
                    saveData();
                    updateComplaintList();
                    updateAdminComplaintsTable();
                    updateStats();
                    alert('Complaint status updated successfully!');
                }
            }
        }

        function deleteApplication(id) {
            if (confirm('Are you sure you want to delete this application?')) {
                applications = applications.filter(a => a.id !== id);
                saveData();
                updateApplicationList();
                updateAdminApplicationsTable();
                updateStats();
                alert('Application deleted successfully!');
            }
        }

        function deleteComplaint(id) {
            if (confirm('Are you sure you want to delete this complaint?')) {
                complaints = complaints.filter(c => c.id !== id);
                saveData();
                updateComplaintList();
                updateAdminComplaintsTable();
                updateStats();
                alert('Complaint deleted successfully!');
            }
        }

        function editUser(id) {
            const user = users.find(u => u.id === id);
            if (user) {
                const newStatus = prompt('Enter new status (active, inactive):', user.status);
                if (newStatus && ['active', 'inactive'].includes(newStatus.toLowerCase())) {
                    user.status = newStatus.toLowerCase();
                    saveData();
                    updateAdminUsersTable();
                    alert('User status updated successfully!');
                }
            }
        }

        function deleteUser(id) {
            if (confirm('Are you sure you want to delete this user?')) {
                users = users.filter(u => u.id !== id);
                saveData();
                updateAdminUsersTable();
                updateStats();
                alert('User deleted successfully!');
            }
        }

        // 3D Animation using Three.js
        function init3DAnimation() {
            const container = document.getElementById('animation-container');
            if (!container) return;
            
            // Create scene
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ alpha: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);
            
            // Add lights
            const ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(1, 1, 1);
            scene.add(directionalLight);
            
            // Create city buildings
            const buildings = [];
            const buildingColors = [0x3498db, 0x2ecc71, 0xe74c3c, 0xf39c12, 0x9b59b6];
            
            for (let i = 0; i < 15; i++) {
                const width = Math.random() * 2 + 1;
                const height = Math.random() * 3 + 2;
                const depth = Math.random() * 2 + 1;
                
                const geometry = new THREE.BoxGeometry(width, height, depth);
                const color = buildingColors[Math.floor(Math.random() * buildingColors.length)];
                const material = new THREE.MeshPhongMaterial({ color: color });
                const building = new THREE.Mesh(geometry, material);
                
                building.position.x = (Math.random() - 0.5) * 20;
                building.position.z = (Math.random() - 0.5) * 20;
                building.position.y = height / 2;
                
                scene.add(building);
                buildings.push(building);
            }
            
            // Add ground
            const groundGeometry = new THREE.PlaneGeometry(30, 30);
            const groundMaterial = new THREE.MeshPhongMaterial({ color: 0x95a5a6, side: THREE.DoubleSide });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = Math.PI / 2;
            ground.position.y = -1;
            scene.add(ground);
            
            // Position camera
            camera.position.z = 15;
            camera.position.y = 5;
            
            // Animation loop
            function animate() {
                requestAnimationFrame(animate);
                
                // Rotate buildings slightly
                buildings.forEach(building => {
                    building.rotation.y += 0.005;
                });
                
                // Rotate camera around the scene
                const time = Date.now() * 0.0005;
                camera.position.x = Math.sin(time) * 15;
                camera.position.z = Math.cos(time) * 15;
                camera.lookAt(0, 0, 0);
                
                renderer.render(scene, camera);
            }
            
            animate();
            
            // Handle window resize
            window.addEventListener('resize', function() {
                camera.aspect = container.clientWidth / container.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.clientWidth, container.clientHeight);
            });
        }
    </script>
</body>
</html>
