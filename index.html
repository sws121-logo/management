<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patna Municipality Infrastructure Portal</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: var(--dark);
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: var(--primary);
            color: white;
            width: 100%;
            padding: 15px 0;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            flex-wrap: wrap;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .logo i {
            font-size: 2.5rem;
            color: var(--secondary);
        }
        
        .logo h1 {
            font-size: 1.8rem;
        }
        
        nav {
            width: 100%;
            order: 3;
            margin-top: 15px;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 5px;
            transition: background 0.3s;
            font-size: 0.9rem;
        }
        
        nav a:hover, nav a.active {
            background: var(--secondary);
        }
        
        .user-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-primary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: var(--accent);
            color: white;
        }
        
        .btn-secondary:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }
        
        .section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            display: none;
        }
        
        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-title {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light);
            color: var(--primary);
        }
        
        .service-categories {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .category-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            border-left: 4px solid var(--secondary);
        }
        
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }
        
        .category-icon {
            font-size: 2.5rem;
            color: var(--secondary);
            margin-bottom: 15px;
        }
        
        .application-form {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        input, select, textarea {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .file-upload-container {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-upload-container:hover {
            border-color: var(--secondary);
            background-color: #f8f9fa;
        }
        
        .file-upload-container i {
            font-size: 2rem;
            color: var(--secondary);
            margin-bottom: 10px;
        }
        
        .file-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .file-preview-item {
            position: relative;
            width: 100px;
            height: 100px;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .file-preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .file-preview-item .remove-file {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0,0,0,0.5);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .application-list, .complaint-list {
            display: grid;
            gap: 15px;
        }
        
        .application-item, .complaint-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--secondary);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .application-info h3, .complaint-info h3 {
            margin-bottom: 5px;
        }
        
        .application-meta, .complaint-meta {
            display: flex;
            gap: 15px;
            color: #7f8c8d;
            font-size: 0.9rem;
            flex-wrap: wrap;
        }
        
        .status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-in-progress {
            background: #cce7ff;
            color: #004085;
        }
        
        .status-approved {
            background: #d4edda;
            color: #155724;
        }
        
        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status-resolved {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .status-open {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status-investigation {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-closed {
            background: #d4edda;
            color: #155724;
        }
        
        .chatbot-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .chatbot-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--secondary);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s;
        }
        
        .chatbot-toggle:hover {
            transform: scale(1.1);
        }
        
        .chatbot-window {
            position: absolute;
            bottom: 70px;
            right: 0;
            width: 350px;
            max-width: 90vw;
            height: 450px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
            display: none;
            flex-direction: column;
            overflow: hidden;
        }
        
        .chatbot-header {
            background: var(--primary);
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chatbot-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .message {
            padding: 10px 15px;
            border-radius: 18px;
            max-width: 80%;
            line-height: 1.4;
        }
        
        .bot-message {
            background: #f1f1f1;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }
        
        .user-message {
            background: var(--secondary);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }
        
        .chatbot-input {
            display: flex;
            padding: 10px;
            border-top: 1px solid #eee;
        }
        
        .chatbot-input input {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 10px 15px;
            margin-right: 10px;
        }
        
        .chatbot-input button {
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
        }
        
        /* FIXED ADMIN PANEL STYLES */
        .admin-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            overflow: hidden;
        }
        
        .admin-sidebar {
            background: var(--primary);
            color: white;
            border-radius: 10px;
            padding: 20px;
            width: 100%;
        }
        
        .admin-sidebar ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .admin-sidebar li {
            flex: 1;
            min-width: 150px;
        }
        
        .admin-sidebar a {
            color: white;
            text-decoration: none;
            display: block;
            padding: 10px;
            border-radius: 5px;
            transition: background 0.3s;
            text-align: center;
        }
        
        .admin-sidebar a:hover, .admin-sidebar a.active {
            background: var(--secondary);
        }
        
        .admin-content {
            background: white;
            border-radius: 10px;
            padding: 20px;
            width: 100%;
            overflow-x: auto;
        }
        
        .admin-tab {
            display: none;
            width: 100%;
        }
        
        .admin-tab.active {
            display: block;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background: #f8f9fa;
            font-weight: 600;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        
        .action-btn {
            padding: 5px 10px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .edit-btn {
            background: var(--warning);
            color: white;
        }
        
        .delete-btn {
            background: var(--accent);
            color: white;
        }
        
        .view-btn {
            background: var(--secondary);
            color: white;
        }
        
        .canvas-container {
            width: 100%;
            height: 200px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            border-top: 4px solid var(--secondary);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .stat-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .documentation-info {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .documentation-info h3 {
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .documentation-info ul {
            padding-left: 20px;
        }
        
        .documentation-info li {
            margin-bottom: 8px;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            width: 100%;
            margin-top: 40px;
            color: #7f8c8d;
            border-top: 1px solid #eee;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1001;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #7f8c8d;
        }
        
        .login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1002;
            align-items: center;
            justify-content: center;
        }
        
        .login-form {
            background: white;
            border-radius: 10px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .login-form h2 {
            margin-bottom: 20px;
            text-align: center;
            color: var(--primary);
        }
        
        .login-form .form-group {
            margin-bottom: 15px;
        }
        
        .admin-login-btn {
            background: var(--warning);
            color: white;
            margin-top: 10px;
        }
        
        .chatbot-quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .quick-action-btn {
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 5px 10px;
            font-size: 0.7rem;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .quick-action-btn:hover {
            background: #2980b9;
        }
        
        .service-steps {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 10px;
            margin: 10px 0;
        }
        
        .service-steps h4 {
            margin-bottom: 8px;
            color: var(--primary);
        }
        
        .service-steps ol {
            padding-left: 20px;
        }
        
        .service-steps li {
            margin-bottom: 5px;
        }
        
        .document-list {
            background: #fff3cd;
            border-radius: 5px;
            padding: 8px;
            margin: 5px 0;
        }
        
        .document-list ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .apply-now-btn {
            background: var(--success);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            margin-top: 5px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .chart-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .chart-title {
            margin-bottom: 15px;
            color: var(--primary);
            font-weight: 600;
        }
        
        .chart-wrapper {
            position: relative;
            height: 300px;
        }
        
        .admin-page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .back-button {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .complaint-categories {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .complaint-category {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-left: 4px solid var(--accent);
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .complaint-category:hover {
            transform: translateY(-5px);
        }
        
        .complaint-category h3 {
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .complaint-category p {
            color: #7f8c8d;
            margin-bottom: 15px;
        }
        
        .complaint-form-container {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .complaint-details {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid var(--warning);
        }
        
        .complaint-details h4 {
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .complaint-details p {
            margin-bottom: 8px;
        }
        
        .complaint-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        /* NEW STYLES FOR REGISTRATION FORM */
        .registration-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .form-full-width {
            grid-column: 1 / -1;
        }
        
        /* NEW STYLES FOR INFRASTRUCTURE MAPS */
        .infrastructure-section {
            margin-bottom: 30px;
        }
        
        .map-container {
            width: 100%;
            height: 400px;
            background-color: #f8f9fa;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            margin-bottom: 20px;
        }
        
        .map-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            color: var(--primary);
        }
        
        .map-placeholder i {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .map-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .map-legend {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }
        
        .water-level-indicator {
            background: #3498db;
            height: 10px;
            border-radius: 5px;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
        }
        
        .water-level-fill {
            background: #1e6ea7;
            height: 100%;
            width: 0%;
            transition: width 1s ease;
        }
        
        .water-level-marks {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.8rem;
            color: #7f8c8d;
        }
        
        .alert-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .alert-low {
            background: #d4edda;
            color: #155724;
        }
        
        .alert-medium {
            background: #fff3cd;
            color: #856404;
        }
        
        .alert-high {
            background: #f8d7da;
            color: #721c24;
        }
        
        /* Leaflet map styles */
        #patnaMap, #waterPipelineMap, #gasPipelineMap {
            height: 100%;
            width: 100%;
            border-radius: 10px;
        }
        
        .leaflet-popup-content {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .infrastructure-popup h3 {
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .infrastructure-popup p {
            margin-bottom: 5px;
        }
        
        .infrastructure-popup .status {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        /* Mobile-first responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .logo {
                justify-content: center;
                text-align: center;
            }
            
            .logo h1 {
                font-size: 1.5rem;
            }
            
            nav ul {
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }
            
            nav a {
                padding: 10px 15px;
                width: 100%;
                text-align: center;
            }
            
            .user-actions {
                width: 100%;
                justify-content: center;
            }
            
            .service-categories {
                grid-template-columns: 1fr;
            }
            
            .stats-cards {
                grid-template-columns: 1fr 1fr;
            }
            
            .admin-sidebar ul {
                flex-direction: column;
            }
            
            .admin-sidebar li {
                min-width: 100%;
            }
            
            .chart-row {
                grid-template-columns: 1fr;
            }
            
            .complaint-categories {
                grid-template-columns: 1fr;
            }
            
            .chatbot-window {
                width: 95vw;
                right: -10px;
            }
            
            .modal-content {
                width: 95%;
            }
            
            .complaint-actions {
                flex-direction: column;
            }
            
            .application-item, .complaint-item {
                flex-direction: column;
            }
            
            .application-status, .complaint-status {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-top: 10px;
            }
            
            .registration-form {
                grid-template-columns: 1fr;
            }
            
            .map-container {
                height: 300px;
            }
        }
        
        @media (min-width: 769px) {
            .header-content {
                flex-wrap: nowrap;
            }
            
            nav {
                width: auto;
                order: 2;
                margin-top: 0;
            }
            
            .user-actions {
                order: 3;
            }
            
            .admin-panel {
                flex-direction: row;
            }
            
            .admin-sidebar {
                width: 250px;
            }
            
            .admin-sidebar ul {
                flex-direction: column;
            }
            
            .admin-sidebar li {
                min-width: 100%;
            }
            
            .service-categories {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .map-container {
                height: 500px;
            }
        }
        
        @media (min-width: 1025px) {
            .service-categories {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .registration-form {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-city"></i>
                    <h1>Patna Municipality Infrastructure Portal</h1>
                </div>
                <nav>
                    <ul>
                        <li><a href="#" class="nav-link active" data-section="home">Home</a></li>
                        <li><a href="#" class="nav-link" data-section="services">Services</a></li>
                        <li><a href="#" class="nav-link" data-section="infrastructure">Infrastructure</a></li>
                        <li><a href="#" class="nav-link" data-section="complaints">File Complaint</a></li>
                        <li><a href="#" class="nav-link" data-section="my-applications">My Applications</a></li>
                        <li><a href="#" class="nav-link" data-section="my-complaints">My Complaints</a></li>
                        <li><a href="#" class="nav-link" data-section="documentation">Documentation</a></li>
                        <li><a href="#" class="nav-link" data-section="admin">Admin Panel</a></li>
                    </ul>
                </nav>
                <div class="user-actions">
                    <button class="btn btn-primary" id="loginBtn">Login</button>
                    <button class="btn btn-secondary" id="registerBtn">Register</button>
                </div>
            </div>
        </header>

        <!-- Home Section -->
        <section id="home" class="section active">
            <h2 class="section-title">Welcome to Patna Municipality Infrastructure Portal</h2>
            <div class="canvas-container" id="animation-container"></div>
            <div class="stats-cards">
                <div class="stat-card">
                    <i class="fas fa-file-alt stat-icon"></i>
                    <div class="stat-number" id="total-applications">0</div>
                    <div class="stat-label">Total Applications</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-check-circle stat-icon"></i>
                    <div class="stat-number" id="approved-applications">0</div>
                    <div class="stat-label">Approved Applications</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-users stat-icon"></i>
                    <div class="stat-number" id="active-users">0</div>
                    <div class="stat-label">Active Users</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-exclamation-triangle stat-icon"></i>
                    <div class="stat-number" id="total-complaints">0</div>
                    <div class="stat-label">Total Complaints</div>
                </div>
            </div>
            <div class="service-categories">
                <div class="category-card" data-service="license">
                    <i class="fas fa-id-card category-icon"></i>
                    <h3>License Application</h3>
                    <p>Apply for various licenses including business, trade, and professional licenses</p>
                </div>
                <div class="category-card" data-service="license-renewal">
                    <i class="fas fa-sync-alt category-icon"></i>
                    <h3>License Renewal</h3>
                    <p>Renew your existing licenses with updated information</p>
                </div>
                <div class="category-card" data-service="property-tax">
                    <i class="fas fa-home category-icon"></i>
                    <h3>Property Tax</h3>
                    <p>Pay property tax and related services</p>
                </div>
                <div class="category-card" data-service="vehicle-registration">
                    <i class="fas fa-car category-icon"></i>
                    <h3>Vehicle Registration</h3>
                    <p>Vehicle registration and related services</p>
                </div>
                <div class="category-card" data-service="trade-license">
                    <i class="fas fa-store category-icon"></i>
                    <h3>Trade License</h3>
                    <p>Apply for trade licenses for your business</p>
                </div>
                <div class="category-card" data-service="building-permit">
                    <i class="fas fa-hard-hat category-icon"></i>
                    <h3>Building Permit</h3>
                    <p>Apply for building permits and approvals</p>
                </div>
                <div class="category-card" data-service="birth-certificate">
                    <i class="fas fa-baby category-icon"></i>
                    <h3>Birth Certificate</h3>
                    <p>Apply for birth certificates</p>
                </div>
                <div class="category-card" data-service="death-certificate">
                    <i class="fas fa-cross category-icon"></i>
                    <h3>Death Certificate</h3>
                    <p>Apply for death certificates</p>
                </div>
                <!-- NEW SERVICES ADDED HERE -->
                <div class="category-card" data-service="marriage-registration">
                    <i class="fas fa-ring category-icon"></i>
                    <h3>Marriage Registration</h3>
                    <p>Register your marriage and obtain official certificate</p>
                </div>
                <div class="category-card" data-service="water-connection">
                    <i class="fas fa-faucet category-icon"></i>
                    <h3>Water Connection</h3>
                    <p>Apply for new water connection or modify existing</p>
                </div>
                <div class="category-card" data-service="electricity-connection">
                    <i class="fas fa-bolt category-icon"></i>
                    <h3>Electricity Connection</h3>
                    <p>Apply for new electricity connection or transfer</p>
                </div>
                <div class="category-card" data-service="grievance-redressal">
                    <i class="fas fa-comments category-icon"></i>
                    <h3>Grievance Redressal</h3>
                    <p>Submit grievances and track resolution status</p>
                </div>
                <div class="category-card" data-service="public-hall-booking">
                    <i class="fas fa-building category-icon"></i>
                    <h3>Public Hall Booking</h3>
                    <p>Book community halls for events and functions</p>
                </div>
                <div class="category-card" data-service="encumbrance-certificate">
                    <i class="fas fa-file-contract category-icon"></i>
                    <h3>Encumbrance Certificate</h3>
                    <p>Apply for property encumbrance certificate</p>
                </div>
                <div class="category-card" data-service="noc-certificate">
                    <i class="fas fa-stamp category-icon"></i>
                    <h3>NOC Certificate</h3>
                    <p>Apply for No Objection Certificate for various purposes</p>
                </div>
                <div class="category-card" data-service="pet-license">
                    <i class="fas fa-paw category-icon"></i>
                    <h3>Pet License</h3>
                    <p>Register and license your pets with the municipality</p>
                </div>
            </div>
        </section>

        <!-- Infrastructure Section -->
        <section id="infrastructure" class="section">
            <h2 class="section-title">Patna Infrastructure Monitoring</h2>
            
            <div class="infrastructure-section">
                <h3>River Water Level Monitoring</h3>
                <p>Track current water levels in Patna's rivers to monitor flood risks.</p>
                
                <div class="map-controls">
                    <button class="btn btn-primary" id="refreshWaterLevel">Refresh Data</button>
                    <select id="riverSelector">
                        <option value="ganga">Ganga River</option>
                        <option value="son">Son River</option>
                        <option value="punpun">Punpun River</option>
                    </select>
                </div>
                
                <div class="map-container">
                    <div id="patnaMap"></div>
                </div>
                
                <div class="water-level-info">
                    <h4>Current Water Level: <span id="currentWaterLevel">2.5</span> meters</h4>
                    <div class="water-level-indicator">
                        <div class="water-level-fill" id="waterLevelFill"></div>
                    </div>
                    <div class="water-level-marks">
                        <span>0m</span>
                        <span>2m (Normal)</span>
                        <span>4m (Warning)</span>
                        <span>6m (Danger)</span>
                    </div>
                    <div class="alert-indicator" id="waterAlert">
                        <i class="fas fa-check-circle"></i>
                        <span>Normal Water Level</span>
                    </div>
                </div>
            </div>
            
            <div class="infrastructure-section">
                <h3>Water Pipeline Network</h3>
                <p>View Patna's water pipeline infrastructure and maintenance status.</p>
                
                <div class="map-controls">
                    <button class="btn btn-primary" id="toggleWaterPipelines">Toggle Pipeline View</button>
                    <button class="btn btn-secondary" id="showMaintenance">Show Maintenance Areas</button>
                </div>
                
                <div class="map-container">
                    <div id="waterPipelineMap"></div>
                </div>
                
                <div class="map-legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #3498db;"></div>
                        <span>Main Water Lines</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #2980b9;"></div>
                        <span>Secondary Water Lines</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #e74c3c;"></div>
                        <span>Maintenance Required</span>
                    </div>
                </div>
            </div>
            
            <div class="infrastructure-section">
                <h3>Gas Pipeline Network</h3>
                <p>View Patna's gas pipeline infrastructure and safety information.</p>
                
                <div class="map-controls">
                    <button class="btn btn-primary" id="toggleGasPipelines">Toggle Pipeline View</button>
                    <button class="btn btn-secondary" id="showSafetyZones">Show Safety Zones</button>
                </div>
                
                <div class="map-container">
                    <div id="gasPipelineMap"></div>
                </div>
                
                <div class="map-legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #e67e22;"></div>
                        <span>Main Gas Lines</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #d35400;"></div>
                        <span>Secondary Gas Lines</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #f39c12;"></div>
                        <span>Safety Zones</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- File Complaint Section -->
        <section id="complaints" class="section">
            <h2 class="section-title">File a Complaint</h2>
            <p>Report issues and problems in your area to the municipality</p>
            
            <div class="complaint-categories">
                <div class="complaint-category" data-complaint-type="sanitation">
                    <h3><i class="fas fa-trash"></i> Sanitation Issues</h3>
                    <p>Report garbage collection problems, overflowing bins, or unclean public areas</p>
                </div>
                <div class="complaint-category" data-complaint-type="roads">
                    <h3><i class="fas fa-road"></i> Road & Infrastructure</h3>
                    <p>Report potholes, damaged roads, street light issues, or traffic problems</p>
                </div>
                <div class="complaint-category" data-complaint-type="water">
                    <h3><i class="fas fa-tint"></i> Water Supply</h3>
                    <p>Report water supply issues, leakages, or water quality problems</p>
                </div>
                <div class="complaint-category" data-complaint-type="electricity">
                    <h3><i class="fas fa-bolt"></i> Electricity Issues</h3>
                    <p>Report power outages, electrical hazards, or street light malfunctions</p>
                </div>
                <div class="complaint-category" data-complaint-type="parks">
                    <h3><i class="fas fa-tree"></i> Parks & Public Spaces</h3>
                    <p>Report issues with public parks, playgrounds, or recreational facilities</p>
                </div>
                <div class="complaint-category" data-complaint-type="noise">
                    <h3><i class="fas fa-volume-up"></i> Noise Pollution</h3>
                    <p>Report excessive noise from construction, events, or commercial establishments</p>
                </div>
            </div>
            
            <div class="complaint-form-container" id="complaintFormContainer" style="display: none;">
                <h3 id="complaintFormTitle">File Complaint</h3>
                <form id="complaintForm" class="application-form">
                    <div class="form-group">
                        <label for="complaintTitle">Complaint Title</label>
                        <input type="text" id="complaintTitle" placeholder="Brief description of the issue" required>
                    </div>
                    <div class="form-group">
                        <label for="complaintDescription">Detailed Description</label>
                        <textarea id="complaintDescription" placeholder="Provide detailed information about the issue, location, and impact" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="complaintLocation">Location</label>
                        <input type="text" id="complaintLocation" placeholder="Exact location or address of the issue" required>
                    </div>
                    <div class="form-group">
                        <label for="complaintPriority">Priority Level</label>
                        <select id="complaintPriority" required>
                            <option value="">Select Priority</option>
                            <option value="low">Low - Minor inconvenience</option>
                            <option value="medium">Medium - Needs attention</option>
                            <option value="high">High - Urgent attention required</option>
                            <option value="critical">Critical - Safety hazard</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Upload Supporting Documents/Photos</label>
                        <div class="file-upload-container" id="complaintPhotoUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload photos or documents</p>
                            <input type="file" id="complaintPhoto" accept="image/*" style="display: none;" multiple>
                        </div>
                        <div class="file-preview" id="complaintFilePreview"></div>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit Complaint</button>
                </form>
            </div>
        </section>

        <!-- Service Application Forms -->
        <section id="service-forms" class="section">
            <!-- Forms will be dynamically loaded here based on service selection -->
        </section>

        <!-- My Applications Section -->
        <section id="my-applications" class="section">
            <h2 class="section-title">My Applications</h2>
            <div class="application-list" id="applicationList">
                <!-- Application items will be dynamically added here -->
            </div>
        </section>

        <!-- My Complaints Section -->
        <section id="my-complaints" class="section">
            <h2 class="section-title">My Complaints</h2>
            <div class="complaint-list" id="complaintList">
                <!-- Complaint items will be dynamically added here -->
            </div>
        </section>

        <!-- Documentation Section -->
        <section id="documentation" class="section">
            <h2 class="section-title">Documentation Requirements</h2>
            <div class="documentation-info">
                <h3>General Documents Required for All Services</h3>
                <ul>
                    <li>Proof of Identity (Aadhar Card, Passport, Voter ID, etc.)</li>
                    <li>Proof of Address (Aadhar Card, Utility Bill, Rental Agreement, etc.)</li>
                    <li>Passport-sized Photographs</li>
                    <li>Any existing relevant certificates or licenses</li>
                </ul>
            </div>
            <div class="service-categories">
                <div class="category-card" data-doc="license">
                    <i class="fas fa-id-card category-icon"></i>
                    <h3>License Application</h3>
                    <p>Documentation requirements for license applications</p>
                    <button class="apply-now-btn" data-service="license">Apply Now</button>
                </div>
                <div class="category-card" data-doc="property-tax">
                    <i class="fas fa-home category-icon"></i>
                    <h3>Property Tax</h3>
                    <p>Documentation requirements for property tax</p>
                    <button class="apply-now-btn" data-service="property-tax">Apply Now</button>
                </div>
                <div class="category-card" data-doc="vehicle-registration">
                    <i class="fas fa-car category-icon"></i>
                    <h3>Vehicle Registration</h3>
                    <p>Documentation requirements for vehicle registration</p>
                    <button class="apply-now-btn" data-service="vehicle-registration">Apply Now</button>
                </div>
                <div class="category-card" data-doc="trade-license">
                    <i class="fas fa-store category-icon"></i>
                    <h3>Trade License</h3>
                    <p>Documentation requirements for trade license</p>
                    <button class="apply-now-btn" data-service="trade-license">Apply Now</button>
                </div>
                <div class="category-card" data-doc="building-permit">
                    <i class="fas fa-hard-hat category-icon"></i>
                    <h3>Building Permit</h3>
                    <p>Documentation requirements for building permit</p>
                    <button class="apply-now-btn" data-service="building-permit">Apply Now</button>
                </div>
                <div class="category-card" data-doc="birth-certificate">
                    <i class="fas fa-baby category-icon"></i>
                    <h3>Birth Certificate</h3>
                    <p>Documentation requirements for birth certificate</p>
                    <button class="apply-now-btn" data-service="birth-certificate">Apply Now</button>
                </div>
                <div class="category-card" data-doc="death-certificate">
                    <i class="fas fa-cross category-icon"></i>
                    <h3>Death Certificate</h3>
                    <p>Documentation requirements for death certificate</p>
                    <button class="apply-now-btn" data-service="death-certificate">Apply Now</button>
                </div>
                <!-- NEW SERVICES DOCUMENTATION -->
                <div class="category-card" data-doc="marriage-registration">
                    <i class="fas fa-ring category-icon"></i>
                    <h3>Marriage Registration</h3>
                    <p>Documentation requirements for marriage registration</p>
                    <button class="apply-now-btn" data-service="marriage-registration">Apply Now</button>
                </div>
                <div class="category-card" data-doc="water-connection">
                    <i class="fas fa-faucet category-icon"></i>
                    <h3>Water Connection</h3>
                    <p>Documentation requirements for water connection</p>
                    <button class="apply-now-btn" data-service="water-connection">Apply Now</button>
                </div>
                <div class="category-card" data-doc="electricity-connection">
                    <i class="fas fa-bolt category-icon"></i>
                    <h3>Electricity Connection</h3>
                    <p>Documentation requirements for electricity connection</p>
                    <button class="apply-now-btn" data-service="electricity-connection">Apply Now</button>
                </div>
                <div class="category-card" data-doc="grievance-redressal">
                    <i class="fas fa-comments category-icon"></i>
                    <h3>Grievance Redressal</h3>
                    <p>Documentation requirements for grievance redressal</p>
                    <button class="apply-now-btn" data-service="grievance-redressal">Apply Now</button>
                </div>
                <div class="category-card" data-doc="public-hall-booking">
                    <i class="fas fa-building category-icon"></i>
                    <h3>Public Hall Booking</h3>
                    <p>Documentation requirements for public hall booking</p>
                    <button class="apply-now-btn" data-service="public-hall-booking">Apply Now</button>
                </div>
                <div class="category-card" data-doc="encumbrance-certificate">
                    <i class="fas fa-file-contract category-icon"></i>
                    <h3>Encumbrance Certificate</h3>
                    <p>Documentation requirements for encumbrance certificate</p>
                    <button class="apply-now-btn" data-service="encumbrance-certificate">Apply Now</button>
                </div>
                <div class="category-card" data-doc="noc-certificate">
                    <i class="fas fa-stamp category-icon"></i>
                    <h3>NOC Certificate</h3>
                    <p>Documentation requirements for NOC certificate</p>
                    <button class="apply-now-btn" data-service="noc-certificate">Apply Now</button>
                </div>
                <div class="category-card" data-doc="pet-license">
                    <i class="fas fa-paw category-icon"></i>
                    <h3>Pet License</h3>
                    <p>Documentation requirements for pet license</p>
                    <button class="apply-now-btn" data-service="pet-license">Apply Now</button>
                </div>
            </div>
        </section>

        <!-- Documentation Details Section -->
        <section id="documentation-details" class="section">
            <!-- Documentation details will be dynamically loaded here -->
        </section>

        <!-- Admin Panel Section -->
        <section id="admin" class="section">
            <h2 class="section-title">Admin Panel</h2>
            <div class="admin-panel">
                <div class="admin-sidebar">
                    <ul>
                        <li><a href="#" class="admin-nav active" data-tab="dashboard">Dashboard</a></li>
                        <li><a href="#" class="admin-nav" data-tab="applications-management">Applications Management</a></li>
                        <li><a href="#" class="admin-nav" data-tab="complaints-management">Complaints Management</a></li>
                        <li><a href="#" class="admin-nav" data-tab="user-management">User Management</a></li>
                        <li><a href="#" class="admin-nav" data-tab="infrastructure-management">Infrastructure Management</a></li>
                        <li><a href="#" class="admin-nav" data-tab="reports">Reports & Analytics</a></li>
                        <li><a href="#" class="admin-nav" data-tab="settings">Settings</a></li>
                    </ul>
                </div>
                <div class="admin-content">
                    <div id="admin-dashboard" class="admin-tab active">
                        <h3>Admin Dashboard</h3>
                        <div class="stats-cards">
                            <div class="stat-card">
                                <i class="fas fa-file-alt stat-icon"></i>
                                <div class="stat-number" id="admin-total-applications">0</div>
                                <div class="stat-label">Total Applications</div>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-check-circle stat-icon"></i>
                                <div class="stat-number" id="admin-approved-applications">0</div>
                                <div class="stat-label">Approved Applications</div>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-exclamation-triangle stat-icon"></i>
                                <div class="stat-number" id="admin-total-complaints">0</div>
                                <div class="stat-label">Total Complaints</div>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-users stat-icon"></i>
                                <div class="stat-number" id="admin-total-users">0</div>
                                <div class="stat-label">Registered Users</div>
                            </div>
                        </div>
                        <div class="chart-row">
                            <div class="chart-container">
                                <h4 class="chart-title">Applications by Status</h4>
                                <div class="chart-wrapper">
                                    <canvas id="applicationsByStatusChart"></canvas>
                                </div>
                            </div>
                            <div class="chart-container">
                                <h4 class="chart-title">Complaints by Type</h4>
                                <div class="chart-wrapper">
                                    <canvas id="complaintsByTypeChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <h4 class="chart-title">Applications Over Time</h4>
                            <div class="chart-wrapper">
                                <canvas id="applicationsOverTimeChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div id="admin-applications-management" class="admin-tab">
                        <h3>Applications Management</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>Application ID</th>
                                    <th>User</th>
                                    <th>Service Type</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminApplicationsTable">
                                <!-- Applications will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                    <div id="admin-complaints-management" class="admin-tab">
                        <h3>Complaints Management</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>Complaint ID</th>
                                    <th>User</th>
                                    <th>Type</th>
                                    <th>Title</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminComplaintsTable">
                                <!-- Complaints will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                    <div id="admin-user-management" class="admin-tab">
                        <h3>User Management</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>User ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Applications</th>
                                    <th>Complaints</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminUsersTable">
                                <!-- Users will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                    <div id="admin-infrastructure-management" class="admin-tab">
                        <h3>Infrastructure Management</h3>
                        <div class="application-form">
                            <div class="form-group">
                                <label for="waterLevelThreshold">Water Level Warning Threshold (meters)</label>
                                <input type="number" id="waterLevelThreshold" value="4.0" step="0.1" min="0" max="10">
                            </div>
                            <div class="form-group">
                                <label for="waterLevelDanger">Water Level Danger Threshold (meters)</label>
                                <input type="number" id="waterLevelDanger" value="6.0" step="0.1" min="0" max="10">
                            </div>
                            <div class="form-group">
                                <label for="pipelineInspection">Pipeline Inspection Frequency (days)</label>
                                <input type="number" id="pipelineInspection" value="90" min="30" max="365">
                            </div>
                            <div class="form-group">
                                <label for="gasSafetyCheck">Gas Pipeline Safety Check Frequency (days)</label>
                                <input type="number" id="gasSafetyCheck" value="180" min="60" max="365">
                            </div>
                            <button class="btn btn-primary" id="saveInfrastructureSettings">Save Infrastructure Settings</button>
                        </div>
                        
                        <h4 style="margin-top: 30px;">Infrastructure Alerts</h4>
                        <div class="application-list" id="infrastructureAlerts">
                            <!-- Infrastructure alerts will be dynamically added here -->
                        </div>
                    </div>
                    <div id="admin-reports" class="admin-tab">
                        <h3>Reports & Analytics</h3>
                        <div class="chart-row">
                            <div class="chart-container">
                                <h4 class="chart-title">User Registration Trends</h4>
                                <div class="chart-wrapper">
                                    <canvas id="userRegistrationChart"></canvas>
                                </div>
                            </div>
                            <div class="chart-container">
                                <h4 class="chart-title">Processing Time Analysis</h4>
                                <div class="chart-wrapper">
                                    <canvas id="processingTimeChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <h4 class="chart-title">Service Performance Metrics</h4>
                            <div class="chart-wrapper">
                                <canvas id="servicePerformanceChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-container">
                            <h4 class="chart-title">Complaint Resolution Time</h4>
                            <div class="chart-wrapper">
                                <canvas id="complaintResolutionChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div id="admin-settings" class="admin-tab">
                        <h3>Settings</h3>
                        <div class="application-form">
                            <div class="form-group">
                                <label for="systemName">System Name</label>
                                <input type="text" id="systemName" value="Patna Municipality Infrastructure Portal">
                            </div>
                            <div class="form-group">
                                <label for="adminEmail">Admin Email</label>
                                <input type="email" id="adminEmail" value="admin@patnamunicipality.gov">
                            </div>
                            <div class="form-group">
                                <label for="notificationSettings">Notification Settings</label>
                                <select id="notificationSettings">
                                    <option value="all">All Notifications</option>
                                    <option value="important">Important Only</option>
                                    <option value="none">No Notifications</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="autoApproval">Auto-Approval Threshold</label>
                                <input type="number" id="autoApproval" value="7" min="1" max="30">
                                <small>Days after which applications are auto-approved if no action taken</small>
                            </div>
                            <button class="btn btn-primary" id="saveSettings">Save Settings</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Chatbot -->
        <div class="chatbot-container">
            <div class="chatbot-toggle" id="chatbotToggle">
                <i class="fas fa-comments"></i>
            </div>
            <div class="chatbot-window" id="chatbotWindow">
                <div class="chatbot-header">
                    <h3>Municipality Assistant</h3>
                    <button id="closeChatbot"><i class="fas fa-times"></i></button>
                </div>
                <div class="chatbot-messages" id="chatbotMessages">
                    <div class="message bot-message">
                        Hello! I'm your municipality assistant. How can I help you today?
                    </div>
                </div>
                <div class="chatbot-input">
                    <input type="text" id="chatbotInput" placeholder="Type your message...">
                    <button id="sendMessage"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>

        <!-- Application Details Modal -->
        <div class="modal" id="applicationModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalTitle">Application Details</h3>
                    <button class="close-modal" id="closeModal">&times;</button>
                </div>
                <div id="modalContent">
                    <!-- Modal content will be dynamically loaded here -->
                </div>
            </div>
        </div>

        <!-- Complaint Details Modal -->
        <div class="modal" id="complaintModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="complaintModalTitle">Complaint Details</h3>
                    <button class="close-modal" id="closeComplaintModal">&times;</button>
                </div>
                <div id="complaintModalContent">
                    <!-- Complaint modal content will be dynamically loaded here -->
                </div>
            </div>
        </div>

        <!-- Login Modal -->
        <div class="login-modal" id="loginModal">
            <div class="login-form">
                <h2>User Login</h2>
                <form id="userLoginForm">
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Login</button>
                </form>
                <button class="btn admin-login-btn" id="adminLoginBtn" style="width: 100%; margin-top: 10px;">Admin Login</button>
                <button class="btn btn-secondary" id="closeLoginModal" style="width: 100%; margin-top: 10px;">Cancel</button>
            </div>
        </div>

        <!-- Registration Modal -->
        <div class="login-modal" id="registrationModal">
            <div class="login-form">
                <h2>User Registration</h2>
                <form id="userRegistrationForm" class="registration-form">
                    <div class="form-group">
                        <label for="regFullName">Full Name</label>
                        <input type="text" id="regFullName" placeholder="Enter your full name" required>
                    </div>
                    <div class="form-group">
                        <label for="regEmail">Email Address</label>
                        <input type="email" id="regEmail" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="regPhone">Phone Number</label>
                        <input type="tel" id="regPhone" placeholder="Enter your phone number" required>
                    </div>
                    <div class="form-group form-full-width">
                        <label for="regAddress">Full Address</label>
                        <textarea id="regAddress" placeholder="Enter your complete address with pincode" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="regPassword">Password</label>
                        <input type="password" id="regPassword" placeholder="Create a password" required>
                    </div>
                    <div class="form-group">
                        <label for="regConfirmPassword">Confirm Password</label>
                        <input type="password" id="regConfirmPassword" placeholder="Confirm your password" required>
                    </div>
                    <button type="submit" class="btn btn-primary form-full-width">Register</button>
                </form>
                <button class="btn btn-secondary" id="closeRegistrationModal" style="width: 100%; margin-top: 10px;">Cancel</button>
            </div>
        </div>

        <!-- Admin Login Modal -->
        <div class="login-modal" id="adminLoginModal">
            <div class="login-form">
                <h2>Admin Login</h2>
                <form id="adminLoginForm">
                    <div class="form-group">
                        <label for="adminUsername">Username</label>
                        <input type="text" id="adminUsername" placeholder="Enter admin username" required>
                    </div>
                    <div class="form-group">
                        <label for="adminPassword">Password</label>
                        <input type="password" id="adminPassword" placeholder="Enter admin password" required>
                    </div>
                    <button type="submit" class="btn btn-warning" style="width: 100%;">Login as Admin</button>
                </form>
                <button class="btn btn-secondary" id="closeAdminLoginModal" style="width: 100%; margin-top: 10px;">Cancel</button>
            </div>
        </div>

        <footer>
            <p>&copy; 2023 Patna Municipality Infrastructure Portal. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Sample data for the application
        let applications = JSON.parse(localStorage.getItem('applications')) || [];
        let complaints = JSON.parse(localStorage.getItem('complaints')) || [];
        let users = JSON.parse(localStorage.getItem('users')) || [
            { id: 1, name: "John Doe", email: "john@example.com", phone: "1234567890", address: "123 Main St, Patna, Bihar 800001", status: "active", applications: 2, complaints: 1, registrationDate: "2023-01-15" },
            { id: 2, name: "Jane Smith", email: "jane@example.com", phone: "0987654321", address: "456 Oak Ave, Patna, Bihar 800002", status: "active", applications: 1, complaints: 0, registrationDate: "2023-02-20" },
            { id: 3, name: "Robert Johnson", email: "robert@example.com", phone: "1122334455", address: "789 Pine Rd, Patna, Bihar 800003", status: "active", applications: 3, complaints: 2, registrationDate: "2023-03-10" },
            { id: 4, name: "Emily Davis", email: "emily@example.com", phone: "5566778899", address: "321 Elm St, Patna, Bihar 800004", status: "inactive", applications: 0, complaints: 1, registrationDate: "2023-04-05" }
        ];
        let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
        let isAdmin = JSON.parse(localStorage.getItem('isAdmin')) || false;
        let applicationIdCounter = parseInt(localStorage.getItem('applicationIdCounter')) || 1001;
        let complaintIdCounter = parseInt(localStorage.getItem('complaintIdCounter')) || 2001;
        let userIdCounter = parseInt(localStorage.getItem('userIdCounter')) || 5;

        // Admin credentials
        const adminCredentials = {
            username: "admin",
            password: "admin123"
        };

        // Infrastructure data
        let riverWaterLevels = {
            ganga: 2.5, // Ganga River
            son: 1.8,   // Son River
            punpun: 3.2 // Punpun River
        };

        // Infrastructure settings
        let infrastructureSettings = JSON.parse(localStorage.getItem('infrastructureSettings')) || {
            waterLevelWarningThreshold: 4.0,
            waterLevelDangerThreshold: 6.0,
            pipelineInspectionFrequency: 90,
            gasSafetyCheckFrequency: 180
        };

        // Infrastructure alerts
        let infrastructureAlerts = JSON.parse(localStorage.getItem('infrastructureAlerts')) || [
            {
                id: 1,
                type: "water_level",
                title: "Ganga River Water Level Alert",
                description: "Water level approaching warning threshold. Current level: 3.8m",
                location: "Ganga River",
                severity: "warning",
                timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(),
                status: "pending"
            },
            {
                id: 2,
                type: "pipeline_maintenance",
                title: "Water Pipeline Maintenance Required",
                description: "Pipeline inspection overdue in Kankarbagh area. Last inspection: 95 days ago",
                location: "Kankarbagh, Sector 5",
                severity: "medium",
                timestamp: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString(),
                status: "scheduled"
            }
        ];

        // Patna map data
        const patnaCoordinates = [25.5941, 85.1376]; // Patna coordinates

        // Water pipeline data for Patna
        const waterPipelines = [
            {
                id: 1,
                name: "Main Water Line - East Patna",
                coordinates: [[25.5941, 85.1376], [25.6000, 85.1500], [25.6100, 85.1600]],
                type: "main",
                status: "operational",
                lastInspection: "2023-09-15",
                nextInspection: "2023-12-15"
            },
            {
                id: 2,
                name: "Secondary Water Line - Kankarbagh",
                coordinates: [[25.5941, 85.1376], [25.5900, 85.1200], [25.5800, 85.1100]],
                type: "secondary",
                status: "maintenance",
                lastInspection: "2023-08-20",
                nextInspection: "2023-11-20"
            },
            {
                id: 3,
                name: "Main Water Line - West Patna",
                coordinates: [[25.5941, 85.1376], [25.5800, 85.1300], [25.5700, 85.1200]],
                type: "main",
                status: "operational",
                lastInspection: "2023-10-05",
                nextInspection: "2024-01-05"
            }
        ];

        // Gas pipeline data for Patna
        const gasPipelines = [
            {
                id: 1,
                name: "Main Gas Line - Central Patna",
                coordinates: [[25.5941, 85.1376], [25.6000, 85.1400], [25.6100, 85.1450]],
                type: "main",
                status: "operational",
                lastInspection: "2023-08-10",
                nextInspection: "2024-02-10"
            },
            {
                id: 2,
                name: "Secondary Gas Line - Rajendra Nagar",
                coordinates: [[25.5941, 85.1376], [25.5900, 85.1350], [25.5850, 85.1300]],
                type: "secondary",
                status: "operational",
                lastInspection: "2023-09-25",
                nextInspection: "2024-03-25"
            },
            {
                id: 3,
                name: "Safety Zone - Gandhi Maidan",
                coordinates: [[25.6100, 85.1450], [25.6150, 85.1500], [25.6200, 85.1550]],
                type: "safety",
                status: "monitoring",
                lastInspection: "2023-10-01",
                nextInspection: "2023-12-01"
            }
        ];

        // River monitoring stations
        const riverStations = [
            {
                id: 1,
                name: "Ganga River - Gandhi Ghat",
                coordinates: [25.6100, 85.1800],
                river: "ganga",
                currentLevel: 2.5,
                normalLevel: 2.0,
                warningLevel: 4.0,
                dangerLevel: 6.0
            },
            {
                id: 2,
                name: "Son River - Koilwar",
                coordinates: [25.5800, 84.8000],
                river: "son",
                currentLevel: 1.8,
                normalLevel: 1.5,
                warningLevel: 3.5,
                dangerLevel: 5.0
            },
            {
                id: 3,
                name: "Punpun River - Fatuha",
                coordinates: [25.5200, 85.3000],
                river: "punpun",
                currentLevel: 3.2,
                normalLevel: 2.5,
                warningLevel: 4.5,
                dangerLevel: 6.5
            }
        ];

        // Complaint types and categories
        const complaintCategories = {
            sanitation: {
                title: "Sanitation Issues",
                icon: "fas fa-trash",
                description: "Garbage collection problems, overflowing bins, or unclean public areas"
            },
            roads: {
                title: "Road & Infrastructure",
                icon: "fas fa-road",
                description: "Potholes, damaged roads, street light issues, or traffic problems"
            },
            water: {
                title: "Water Supply",
                icon: "fas fa-tint",
                description: "Water supply issues, leakages, or water quality problems"
            },
            electricity: {
                title: "Electricity Issues",
                icon: "fas fa-bolt",
                description: "Power outages, electrical hazards, or street light malfunctions"
            },
            parks: {
                title: "Parks & Public Spaces",
                icon: "fas fa-tree",
                description: "Issues with public parks, playgrounds, or recreational facilities"
            },
            noise: {
                title: "Noise Pollution",
                icon: "fas fa-volume-up",
                description: "Excessive noise from construction, events, or commercial establishments"
            }
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    const sectionId = this.getAttribute('data-section');
                    document.getElementById(sectionId).classList.add('active');
                    
                    // Update admin panel data when admin section is opened
                    if (sectionId === 'admin') {
                        updateAdminApplicationsTable();
                        updateAdminComplaintsTable();
                        updateAdminUsersTable();
                        updateAdminStats();
                        initAdminCharts();
                        updateInfrastructureAlerts();
                    }
                    
                    // Update infrastructure data when infrastructure section is opened
                    if (sectionId === 'infrastructure') {
                        updateWaterLevelDisplay();
                        initPatnaMap();
                        initWaterPipelineMap();
                        initGasPipelineMap();
                    }
                });
            });

            // Initialize infrastructure maps
            function initPatnaMap() {
                const map = L.map('patnaMap').setView(patnaCoordinates, 11);
                
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                }).addTo(map);
                
                // Add river monitoring stations
                riverStations.forEach(station => {
                    const level = station.currentLevel;
                    let status, iconColor;
                    
                    if (level < station.warningLevel) {
                        status = "Normal";
                        iconColor = "green";
                    } else if (level < station.dangerLevel) {
                        status = "Warning";
                        iconColor = "orange";
                    } else {
                        status = "Danger";
                        iconColor = "red";
                    }
                    
                    const marker = L.marker(station.coordinates).addTo(map);
                    marker.bindPopup(`
                        <div class="infrastructure-popup">
                            <h3>${station.name}</h3>
                            <p><strong>Current Level:</strong> ${level} meters</p>
                            <p><strong>Status:</strong> <span class="status" style="background-color: ${iconColor}">${status}</span></p>
                            <p><strong>Normal Level:</strong> ${station.normalLevel} meters</p>
                            <p><strong>Warning Level:</strong> ${station.warningLevel} meters</p>
                            <p><strong>Danger Level:</strong> ${station.dangerLevel} meters</p>
                        </div>
                    `);
                });
            }
            
            function initWaterPipelineMap() {
                const map = L.map('waterPipelineMap').setView(patnaCoordinates, 12);
                
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                }).addTo(map);
                
                // Add water pipelines
                waterPipelines.forEach(pipeline => {
                    let color, statusClass;
                    
                    if (pipeline.type === "main") {
                        color = "#3498db";
                    } else if (pipeline.type === "secondary") {
                        color = "#2980b9";
                    }
                    
                    if (pipeline.status === "maintenance") {
                        color = "#e74c3c";
                        statusClass = "status-pending";
                    } else {
                        statusClass = "status-approved";
                    }
                    
                    const polyline = L.polyline(pipeline.coordinates, {color: color, weight: 5}).addTo(map);
                    
                    polyline.bindPopup(`
                        <div class="infrastructure-popup">
                            <h3>${pipeline.name}</h3>
                            <p><strong>Type:</strong> ${pipeline.type === "main" ? "Main Water Line" : "Secondary Water Line"}</p>
                            <p><strong>Status:</strong> <span class="status ${statusClass}">${pipeline.status}</span></p>
                            <p><strong>Last Inspection:</strong> ${pipeline.lastInspection}</p>
                            <p><strong>Next Inspection:</strong> ${pipeline.nextInspection}</p>
                        </div>
                    `);
                });
            }
            
            function initGasPipelineMap() {
                const map = L.map('gasPipelineMap').setView(patnaCoordinates, 12);
                
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                }).addTo(map);
                
                // Add gas pipelines
                gasPipelines.forEach(pipeline => {
                    let color, statusClass;
                    
                    if (pipeline.type === "main") {
                        color = "#e67e22";
                    } else if (pipeline.type === "secondary") {
                        color = "#d35400";
                    } else if (pipeline.type === "safety") {
                        color = "#f39c12";
                    }
                    
                    if (pipeline.status === "monitoring") {
                        statusClass = "status-in-progress";
                    } else {
                        statusClass = "status-approved";
                    }
                    
                    const polyline = L.polyline(pipeline.coordinates, {color: color, weight: 5}).addTo(map);
                    
                    polyline.bindPopup(`
                        <div class="infrastructure-popup">
                            <h3>${pipeline.name}</h3>
                            <p><strong>Type:</strong> ${pipeline.type === "main" ? "Main Gas Line" : pipeline.type === "secondary" ? "Secondary Gas Line" : "Safety Zone"}</p>
                            <p><strong>Status:</strong> <span class="status ${statusClass}">${pipeline.status}</span></p>
                            <p><strong>Last Inspection:</strong> ${pipeline.lastInspection}</p>
                            <p><strong>Next Inspection:</strong> ${pipeline.nextInspection}</p>
                        </div>
                    `);
                });
            }

            // Infrastructure controls
            document.getElementById('refreshWaterLevel').addEventListener('click', function() {
                // Simulate fetching new water level data
                const river = document.getElementById('riverSelector').value;
                const newLevel = riverWaterLevels[river] + (Math.random() * 0.5 - 0.25); // Small random change
                riverWaterLevels[river] = Math.max(0, Math.min(8, newLevel)); // Keep between 0 and 8 meters
                updateWaterLevelDisplay();
                
                // Update river stations data
                riverStations.forEach(station => {
                    if (station.river === river) {
                        station.currentLevel = riverWaterLevels[river];
                    }
                });
                
                // Check for alerts
                checkWaterLevelAlerts();
            });

            document.getElementById('riverSelector').addEventListener('change', function() {
                updateWaterLevelDisplay();
            });

            // Update water level display
            function updateWaterLevelDisplay() {
                const river = document.getElementById('riverSelector').value;
                const waterLevel = riverWaterLevels[river];
                
                document.getElementById('currentWaterLevel').textContent = waterLevel.toFixed(1);
                
                // Update water level indicator
                const waterLevelFill = document.getElementById('waterLevelFill');
                const percentage = Math.min(100, (waterLevel / 8) * 100);
                waterLevelFill.style.width = `${percentage}%`;
                
                // Update alert indicator
                const waterAlert = document.getElementById('waterAlert');
                if (waterLevel < infrastructureSettings.waterLevelWarningThreshold) {
                    waterAlert.className = 'alert-indicator alert-low';
                    waterAlert.innerHTML = '<i class="fas fa-check-circle"></i><span>Normal Water Level</span>';
                } else if (waterLevel < infrastructureSettings.waterLevelDangerThreshold) {
                    waterAlert.className = 'alert-indicator alert-medium';
                    waterAlert.innerHTML = '<i class="fas fa-exclamation-triangle"></i><span>Warning: High Water Level</span>';
                } else {
                    waterAlert.className = 'alert-indicator alert-high';
                    waterAlert.innerHTML = '<i class="fas fa-exclamation-circle"></i><span>Danger: Flood Risk</span>';
                }
            }

            // Check for water level alerts
            function checkWaterLevelAlerts() {
                riverStations.forEach(station => {
                    if (station.currentLevel >= infrastructureSettings.waterLevelWarningThreshold) {
                        // Check if alert already exists
                        const existingAlert = infrastructureAlerts.find(alert => 
                            alert.type === "water_level" && alert.location === station.name
                        );
                        
                        if (!existingAlert) {
                            const severity = station.currentLevel >= infrastructureSettings.waterLevelDangerThreshold ? "high" : "warning";
                            
                            infrastructureAlerts.push({
                                id: infrastructureAlerts.length + 1,
                                type: "water_level",
                                title: `${station.name} Water Level Alert`,
                                description: `Water level approaching ${severity === "high" ? "danger" : "warning"} threshold. Current level: ${station.currentLevel.toFixed(1)}m`,
                                location: station.name,
                                severity: severity,
                                timestamp: new Date().toISOString(),
                                status: "pending"
                            });
                            
                            saveInfrastructureData();
                            updateInfrastructureAlerts();
                        }
                    }
                });
            }

            // Save infrastructure settings
            document.getElementById('saveInfrastructureSettings').addEventListener('click', function() {
                infrastructureSettings.waterLevelWarningThreshold = parseFloat(document.getElementById('waterLevelThreshold').value);
                infrastructureSettings.waterLevelDangerThreshold = parseFloat(document.getElementById('waterLevelDanger').value);
                infrastructureSettings.pipelineInspectionFrequency = parseInt(document.getElementById('pipelineInspection').value);
                infrastructureSettings.gasSafetyCheckFrequency = parseInt(document.getElementById('gasSafetyCheck').value);
                
                saveInfrastructureData();
                alert('Infrastructure settings saved successfully!');
            });

            // Update infrastructure alerts in admin panel
            function updateInfrastructureAlerts() {
                const alertsContainer = document.getElementById('infrastructureAlerts');
                alertsContainer.innerHTML = '';
                
                if (infrastructureAlerts.length === 0) {
                    alertsContainer.innerHTML = '<p>No infrastructure alerts at this time.</p>';
                    return;
                }
                
                infrastructureAlerts.forEach(alert => {
                    const alertItem = document.createElement('div');
                    alertItem.className = 'application-item';
                    
                    let statusClass = 'status-pending';
                    if (alert.status === 'scheduled') {
                        statusClass = 'status-in-progress';
                    } else if (alert.status === 'resolved') {
                        statusClass = 'status-resolved';
                    }
                    
                    alertItem.innerHTML = `
                        <div class="application-info">
                            <h3>${alert.title}</h3>
                            <p>${alert.description}</p>
                            <div class="application-meta">
                                <span><i class="fas fa-clock"></i> ${formatTimeAgo(alert.timestamp)}</span>
                                <span><i class="fas fa-map-marker-alt"></i> ${alert.location}</span>
                            </div>
                        </div>
                        <div class="application-status">
                            <span class="status ${statusClass}">${alert.status}</span>
                            <button class="btn btn-primary acknowledge-alert" data-id="${alert.id}" style="margin-top: 10px;">Acknowledge</button>
                        </div>
                    `;
                    
                    alertsContainer.appendChild(alertItem);
                });
                
                // Add event listeners for acknowledge buttons
                document.querySelectorAll('.acknowledge-alert').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.getAttribute('data-id'));
                        acknowledgeAlert(id);
                    });
                });
            }

            // Acknowledge infrastructure alert
            function acknowledgeAlert(id) {
                const alertIndex = infrastructureAlerts.findIndex(alert => alert.id === id);
                if (alertIndex !== -1) {
                    infrastructureAlerts[alertIndex].status = "resolved";
                    saveInfrastructureData();
                    updateInfrastructureAlerts();
                    alert('Alert acknowledged successfully!');
                }
            }

            // Format time ago
            function formatTimeAgo(timestamp) {
                const now = new Date();
                const time = new Date(timestamp);
                const diffMs = now - time;
                const diffMins = Math.floor(diffMs / 60000);
                const diffHours = Math.floor(diffMs / 3600000);
                const diffDays = Math.floor(diffMs / 86400000);
                
                if (diffMins < 1) return 'Just now';
                if (diffMins < 60) return `${diffMins} minutes ago`;
                if (diffHours < 24) return `${diffHours} hours ago`;
                return `${diffDays} days ago`;
            }

            // Save infrastructure data to localStorage
            function saveInfrastructureData() {
                localStorage.setItem('infrastructureSettings', JSON.stringify(infrastructureSettings));
                localStorage.setItem('infrastructureAlerts', JSON.stringify(infrastructureAlerts));
            }

            // Initialize infrastructure settings in admin panel
            document.getElementById('waterLevelThreshold').value = infrastructureSettings.waterLevelWarningThreshold;
            document.getElementById('waterLevelDanger').value = infrastructureSettings.waterLevelDangerThreshold;
            document.getElementById('pipelineInspection').value = infrastructureSettings.pipelineInspectionFrequency;
            document.getElementById('gasSafetyCheck').value = infrastructureSettings.gasSafetyCheckFrequency;

            // Initialize infrastructure alerts
            updateInfrastructureAlerts();

            // Initialize 3D animation
            init3DAnimation();

            // Update stats
            updateStats();
            updateAdminStats();

            // Initialize maps
            initPatnaMap();
            initWaterPipelineMap();
            initGasPipelineMap();
        });

        // 3D Animation using Three.js
        function init3DAnimation() {
            const container = document.getElementById('animation-container');
            if (!container) return;
            
            // Create scene
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ alpha: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);
            
            // Add lights
            const ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(1, 1, 1);
            scene.add(directionalLight);
            
            // Create city buildings
            const buildings = [];
            const buildingColors = [0x3498db, 0x2ecc71, 0xe74c3c, 0xf39c12, 0x9b59b6];
            
            for (let i = 0; i < 15; i++) {
                const width = Math.random() * 2 + 1;
                const height = Math.random() * 3 + 2;
                const depth = Math.random() * 2 + 1;
                
                const geometry = new THREE.BoxGeometry(width, height, depth);
                const color = buildingColors[Math.floor(Math.random() * buildingColors.length)];
                const material = new THREE.MeshPhongMaterial({ color: color });
                const building = new THREE.Mesh(geometry, material);
                
                building.position.x = (Math.random() - 0.5) * 20;
                building.position.z = (Math.random() - 0.5) * 20;
                building.position.y = height / 2;
                
                scene.add(building);
                buildings.push(building);
            }
            
            // Add ground
            const groundGeometry = new THREE.PlaneGeometry(30, 30);
            const groundMaterial = new THREE.MeshPhongMaterial({ color: 0x95a5a6, side: THREE.DoubleSide });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = Math.PI / 2;
            ground.position.y = -1;
            scene.add(ground);
            
            // Position camera
            camera.position.z = 15;
            camera.position.y = 5;
            
            // Animation loop
            function animate() {
                requestAnimationFrame(animate);
                
                // Rotate buildings slightly
                buildings.forEach(building => {
                    building.rotation.y += 0.005;
                });
                
                // Rotate camera around the scene
                const time = Date.now() * 0.0005;
                camera.position.x = Math.sin(time) * 15;
                camera.position.z = Math.cos(time) * 15;
                camera.lookAt(0, 0, 0);
                
                renderer.render(scene, camera);
            }
            
            animate();
            
            // Handle window resize
            window.addEventListener('resize', function() {
                camera.aspect = container.clientWidth / container.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.clientWidth, container.clientHeight);
            });
        }

        // Update stats
        function updateStats() {
            document.getElementById('total-applications').textContent = applications.length;
            document.getElementById('approved-applications').textContent = applications.filter(a => a.status === 'approved').length;
            document.getElementById('active-users').textContent = users.filter(u => u.status === 'active').length;
            document.getElementById('total-complaints').textContent = complaints.length;
        }

        function updateAdminStats() {
            document.getElementById('admin-total-applications').textContent = applications.length;
            document.getElementById('admin-approved-applications').textContent = applications.filter(a => a.status === 'approved').length;
            document.getElementById('admin-total-complaints').textContent = complaints.length;
            document.getElementById('admin-total-users').textContent = users.length;
        }
    </script>
</body>
</html>
